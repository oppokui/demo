<DataPipeModel description="ADF Anomaly Model Template for Signal Onboarding" name="VIAOps - Anomaly Template" editBy="flow" is_init="false" useStreaming="auto" durableStreaming="false" streamingAutoStart="false" useHive="auto" batchDuration="P1M" runAsService="false" checkpoint="" batchSampling="true" sparkMasterHost="">
  <HiveConfig>
    <Properties>
      <Property name="hive.warehouse.hdfs.source" value=""/>
      <Property name="hive.metastore.data.source" value=""/>
      <Property name="hive.server2.thrift.port" value=""/>
      <Property name="hive.db.schema" value=""/>
    </Properties>
  </HiveConfig>
  <ModelInfo validated="true">
    <Pipes>
      <Pipe index="1000" uuid="" name="(main)">
      </Pipe>
    </Pipes>
    <Flows>
      <Flow index="1000" uuid="Main" isNested="false" revision="528" name="Main" showFooter="true">
        <Node index="1001" uuid="bb5ab448-037b-4547-8a32-9de419a928a1" type="subflow" label="Baseline Anomaly Detection" x="1040" y="40" width="185" height="95">
            <Source name="AggrMetrics" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
              <DataSource category="#OUTPUT" id="undefined" name="baseline" nodeId="727dd54e-99ce-4e82-89d2-51646aa97d55">
                <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="RawAnomaly" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
              <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm_name" label="algorithm_name" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_median" label="baseline_median" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev" label="baseline_stdev" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad" label="baseline_mad" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_avg" label="baseline_avg" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stats" label="baseline_stats" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="zscore" label="zscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="mzscore" label="mzscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="cscore" label="cscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="deviation" label="deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="upper_score" label="upper_score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="lower_score" label="lower_score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="conf_id" label="conf_id" type="integer" clazz="" isArray="false" isOptional="true"/>
              <Field name="trigger" label="trigger" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="new_metric" label="new_metric" type="boolean" clazz="" isArray="false" isOptional="true"/>
              <Field name="severity" label="severity" type="integer" clazz="" isArray="false" isOptional="false"/>
              <Field name="is_anomaly" label="is_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="batch_tm" label="batch_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Output name="DroppedMetrics" uid="1" outputType="DStream" dataType="class:viaops.anomaly.Dropped_Metrics">
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.anomaly/Baseline Anomaly Detection","ServiceName":"${adm_name_m}","BaselineDataSource":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/viaops_config_db","databaseURL":"jdbc:mysql://master:3306/viaops_config_db?useSSL=false","userName":"root","password":"&lt;KrVMNhzOjE@fA4SCfy63CCqUM5KEia&gt;","driverType":"com.mysql.jdbc.Driver"},"DailyBaselineTable":"${baseline_table_name}","OverrideBaselineTable":"${override_baseline_table_name}","PercentileTable":"${percentile}","StatisticTable":"${statistic}","BaselinePollRate":"${pull_r}","PollRate":"1","DailyCheckTime":"23:50","BaselineStartDate":"","KeepDays":"","BaselineUpdateInterval":"0","Baseline_Seasonality":" "}
</Properties>
              <__subflow__>
              <Flow index="1001" uuid="Baseline Anomaly Detection" isNested="true" revision="5258" acceptedSourceTypes="DStream" referenceURI="remote:///viaops.anomaly/Baseline Anomaly Detection" name="Baseline Anomaly Detection" showFooter="true">
                <Node index="1001_1" uuid="cd6b3007-9e4c-4fa9-8e5d-e0faecb6d708" type="Adhoc" label="Baseline Load Source" x="31" y="160" width="137" height="75">
                    <Output name="Baseline" uid="0" outputType="DStream" dataType="class:InternalBaseline" referenceType="InternalBaseline">
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="median" label="median" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="avg" label="avg" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="usage" label="usage" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[
  import org.apache.spark.streaming.dstream.{ VtBaselineInputDStream, VtBaselineSetting, ConnectionSetting }
  import org.apache.spark.sql.{ Row }
  import com.vitria.viaops.DatetimeUtil._
  import com.vitria.viaops.DFUtil._
  val globalConf = com.vitria.viaops.ad.SolGlobalConf.getGlobalConfList("${ServiceName}", "${BaselineDataSource}", vtContext)
  val timezone = globalConf.timezone
  val daylightsaving = true
  def getInt(str: String, default: Int) = if (str == null || str.size == 0) default else str.toInt
  val connection = ConnectionSetting(
"${BaselineDataSource}",
ADFObject.vtContext.getProperty("vitria.domain.provider.url", ""),
ADFObject.vtContext.getProperty("vitria.domain.naming.user", ""),
ADFObject.vtContext.getProperty("vitria.domain.naming.password", ""))

  val baselineSetting = new VtBaselineSetting
  baselineSetting.setServiceNameList(com.vitria.viaops.ADMUtils.splitAdms("${ServiceName}"))
.setBaselineMetaDataConnectionSetting(connection)
.setBaselineMetaDataTable("viaops_anomaly_baseline_meta_store")
.setCheckOverrideBaseline((time: Time) => true)
.setDailyBaselineTable("${DailyBaselineTable}")
.setDaylightSaving(daylightsaving)
.setSeasonality("${Baseline_Seasonality}")
.setGetDailyBaseline((time: Time) =>
  getRange(time, "${DailyCheckTime}", timezone, daylightsaving))
.setOverrideBaselineTable("${OverrideBaselineTable}")
.setInitialStartDate("${BaselineStartDate}")
.setKeepDays(getInt("${KeepDays}", 0))
.setInitialBaselineInterval(getInt("${BaselineUpdateInterval}", 0))
.setTimezone(timezone)

  def converter(row: Row): InternalBaseline = {
InternalBaseline(
  row.getString(0), //dow
  row.getInt(1), //seconds_of_day
  row.getString(2), //metric_id
  row.getDouble(3), //median
  row.getDouble(4), //median_baseline
  row.getDouble(5), //mean_baseline
  row.getDouble(6), //avg
  row.getDouble(7), //stdev
  row.getDouble(8), //mad
  row.getInt(9), //usages
  row.getLong(10)) //generated_tm
  }

  val retval = new VtBaselineInputDStream[InternalBaseline](
ssc,
() => hiveContext.sparkSession,
baselineSetting,
converter)]]></Script>
                    </Model>
                </Node>
                <Node index="1001_2" uuid="84143669-19ec-47bd-80b5-ba1ab6f4c67f" type="inPort" label="AggrMetrics" x="0" y="80" width="94.015625" height="40">
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics" referenceType="viaops.anomaly.Aggr_Metrics">
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.anomaly.Aggr_Metrics","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1001_3" uuid="cc75431a-e2ae-4ca1-847f-a055637ae10b" type="Join" label="Enrich current window" x="334" y="60" width="138" height="95">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:EnrichMetrics">
                      <DataSource category="#OUTPUT" id="undefined" name="EnrichMetrics" nodeId="347b676a-6948-4d66-8b03-2d4cce4cdab8">
                        <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="currentdow" label="currentdow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="currentoffset" label="currentoffset" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="nextdow" label="nextdow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="nextoffset" label="nextoffset" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Source name="source2" uid="1" outputType="DStream" dataType="class:InternalBaseline">
                      <DataSource category="#OUTPUT" id="undefined" name="All" nodeId="f085d957-efde-45b5-8add-bbe0d738c384">
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seconds_of_day" label="seconds_of_day" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="median" label="median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="avg" label="avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="usage" label="usage" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:metric_baseline1">
                      <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_size" label="window_size" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="currentoffset" label="currentoffset" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="nextdow" label="nextdow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="nextoffset" label="nextoffset" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="median" label="median" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg" label="avg" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="true"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model joinType="LeftOuterJoin" _caseClass="metric_baseline1" isClassRef="false" joinAlgorithms="shuffle">
                      <Predicates sleText="source1.currentdow=source2.dow and source1.currentoffset=source2.seconds_of_day and source1.metrics.metric_id=source2.metric_id"/>
                      <ProjectionsEditor>
                        <ProjectionInfo source="source1.metrics" name="metrics" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.currentdow" name="currentdow" level="1" exclude="true"/>
                        <ProjectionInfo source="source1.currentoffset" name="currentoffset" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.nextdow" name="nextdow" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.nextoffset" name="nextoffset" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.dow" name="dow" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.seconds_of_day" name="seconds_of_day" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.median" name="median" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.median_baseline" name="median_baseline" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.mean_baseline" name="mean_baseline" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.avg" name="avg" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.stdev" name="stdev" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.mad" name="mad" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.usage" name="usage" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.generated_tm" name="generated_tm" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.metric_id" name="metric_id" level="1" exclude="true"/>
                      </ProjectionsEditor>
                      <Projections>
                        <Projection source="source1.metrics" name="metrics" label="metrics"/>
                        <Projection source="source1.currentoffset" name="currentoffset" label="currentoffset"/>
                        <Projection source="source1.nextdow" name="nextdow" label="nextdow"/>
                        <Projection source="source1.nextoffset" name="nextoffset" label="nextoffset"/>
                        <Projection source="source2.median" name="median" label="median"/>
                        <Projection source="source2.median_baseline" name="median_baseline" label="median_baseline"/>
                        <Projection source="source2.mean_baseline" name="mean_baseline" label="mean_baseline"/>
                        <Projection source="source2.avg" name="avg" label="avg"/>
                        <Projection source="source2.stdev" name="stdev" label="stdev"/>
                        <Projection source="source2.mad" name="mad" label="mad"/>
                      </Projections>
                    </Model>
                </Node>
                <Node index="1001_4" uuid="f0dc99da-3c62-4457-8d99-5cc29c8f261a" type="Adhoc" label="Enrich next window" x="400" y="180" width="130" height="95">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:metric_baseline1">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="cc75431a-e2ae-4ca1-847f-a055637ae10b">
                        <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="currentoffset" label="currentoffset" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="nextdow" label="nextdow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="nextoffset" label="nextoffset" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="median" label="median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg" label="avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      </DataSource>
                    </Source>
                    <Source name="source2" uid="1" outputType="DStream" dataType="class:InternalBaseline">
                      <DataSource category="#OUTPUT" id="undefined" name="All" nodeId="f085d957-efde-45b5-8add-bbe0d738c384">
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seconds_of_day" label="seconds_of_day" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="median" label="median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="avg" label="avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="usage" label="usage" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:metric_baseline2" referenceType="metric_baseline2">
                      <Field name="currentoffset" label="currentoffset" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_size" label="window_size" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="median" label="median" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg" label="avg" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_2" label="median_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline_2" label="median_baseline_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline_2" label="mean_baseline_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg_2" label="avg_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev_2" label="stdev_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad_2" label="mad_2" type="double" clazz="" isArray="false" isOptional="true"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model isDynamicSchema="false">
                      <Script><![CDATA[val globalConf = com.vitria.viaops.ad.SolGlobalConf.getGlobalConfList("${ServiceName}", "${BaselineDataSource}", vtContext)
val windowSize = globalConf.window_size
val windowStep = globalConf.anomaly_step_size
val retval = if (windowSize == windowStep) {
    source1.map(r => metric_baseline2(r.currentoffset, r.metrics, r.median, r.median_baseline, r.mean_baseline, r.avg, r.stdev, r.mad, r.median, r.median_baseline, r.mean_baseline, r.avg, r.stdev, r.mad))
} else {
  val g1source1 = source1.map(r => ((r.nextdow, r.nextoffset, r.metrics.metric_id), r))
  val g1r12 = g1source1.vtLeftOuterJoin(source2.map(v => ((v.dow, v.seconds_of_day, v.metric_id),v))).map(r => r._2)
  g1r12.map(r => metric_baseline2(r._1.currentoffset, r._1.metrics, r._1.median, r._1.median_baseline, r._1.mean_baseline, r._1.avg, r._1.stdev, r._1.mad, r._2.map(_.median), r._2.map(_.median_baseline), r._2.map(_.mean_baseline), r._2.map(_.avg), r._2.map(_.stdev), r._2.map(_.mad)))
}
]]></Script>
                    </Model>
                </Node>
                <Node index="1001_5" uuid="347b676a-6948-4d66-8b03-2d4cce4cdab8" type="Adhoc" label="Enrich dow and sod" x="134" y="60" width="160" height="75">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="84143669-19ec-47bd-80b5-ba1ab6f4c67f">
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="EnrichMetrics" uid="0" outputType="DStream" dataType="class:EnrichMetrics" referenceType="EnrichMetrics">
                      <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_size" label="window_size" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="currentdow" label="currentdow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="currentoffset" label="currentoffset" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="nextdow" label="nextdow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="nextoffset" label="nextoffset" type="integer" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[ import com.vitria.viaops.DatetimeUtil
  val globalConf = com.vitria.viaops.ad.SolGlobalConf.getGlobalConfList("${ServiceName}","${BaselineDataSource}", vtContext)
  val timezone = globalConf.timezone
  val daylightsaving = true
  val windowsize = globalConf.window_size
  val retval = source1.map(m => {
val baselinets = m.start_tm / windowsize * windowsize 
val seasonality = if ("${Baseline_Seasonality}".trim().length == 0) m.seasonality.getOrElse("") else "${Baseline_Seasonality}"
val currentwindow = DatetimeUtil.getSecondOfDay(baselinets, seasonality, timezone, daylightsaving)
val nextwindow = DatetimeUtil.getSecondOfDay(baselinets + windowsize, seasonality, timezone, daylightsaving)
EnrichMetrics(m, currentwindow._1, currentwindow._2, nextwindow._1, nextwindow._2)
  })]]></Script>
                    </Model>
                </Node>
                <Node index="1001_6" uuid="f085d957-efde-45b5-8add-bbe0d738c384" type="Window" label="Baseline" x="220" y="160" width="83" height="135">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:InternalBaseline">
                      <DataSource category="#OUTPUT" id="undefined" name="Baseline" nodeId="cd6b3007-9e4c-4fa9-8e5d-e0faecb6d708">
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seconds_of_day" label="seconds_of_day" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="median" label="median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="avg" label="avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="usage" label="usage" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="All" uid="0" outputType="DStream" dataType="class:InternalBaseline">
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="median" label="median" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="avg" label="avg" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="usage" label="usage" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Changes" uid="1" outputType="DStream" dataType="class:InternalBaseline">
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="median" label="median" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="avg" label="avg" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="usage" label="usage" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Expired" uid="2" outputType="DStream" dataType="class:InternalBaseline">
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="median" label="median" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="avg" label="avg" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="usage" label="usage" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Deleted" uid="3" outputType="DStream" dataType="class:InternalBaseline">
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="median" label="median" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="avg" label="avg" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="usage" label="usage" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model windowPolicy="attribute" partition="" checkpointInterval="/S" restoreState="false">
                      <Time mode="system">
                      </Time>
                      <GroupKeys policy="latest" numPerGroup="1">
                        <GroupKey field="dow"/>
                        <GroupKey field="seconds_of_day"/>
                        <GroupKey field="metric_id"/>
                      </GroupKeys>
                      <OrderFields>
                        <OrderField field="usage"/>
                        <OrderField field="generated_tm"/>
                      </OrderFields>
                      <Expirations duration="2880/N" baseline="lastevent">
                      </Expirations>
                    </Model>
                </Node>
                <Node index="1001_7" uuid="2cf8837b-f824-42d6-8816-0e1984156748" type="outPort" label="RawAnomaly" x="1313" y="172" width="100.703125" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
                      <DataSource category="#OUTPUT" id="undefined" name="Anomaly" nodeId="a951dd55-592b-4eeb-8c56-31182a345a1e">
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm_name" label="algorithm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_median" label="baseline_median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev" label="baseline_stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad" label="baseline_mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_avg" label="baseline_avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stats" label="baseline_stats" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="zscore" label="zscore" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mzscore" label="mzscore" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="cscore" label="cscore" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="deviation" label="deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_score" label="upper_score" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_score" label="lower_score" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="conf_id" label="conf_id" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="trigger" label="trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="new_metric" label="new_metric" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="severity" label="severity" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="is_anomaly" label="is_anomaly" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="batch_tm" label="batch_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{"type":{"name":"viaops.anomaly.Raw_Anomaly","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1001_8" uuid="1e6dc70e-248d-4ad1-89fb-2ae6f23dff3e" type="outPort" label="DroppedMetrics" x="1300" y="260" width="114.703125" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Dropped_Metrics">
                      <DataSource category="#OUTPUT" id="undefined" name="Dropped" nodeId="a951dd55-592b-4eeb-8c56-31182a345a1e">
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{"type":{"name":"viaops.anomaly.Dropped_Metrics","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1001_9" uuid="a951dd55-592b-4eeb-8c56-31182a345a1e" type="Adhoc" label="Calculate Anomaly" x="1134" y="180" width="120" height="95">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:Enrich_All">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="a009bbd9-8f53-4847-8cd4-8287192a21f5">
                        <Field name="currentoffset" label="currentoffset" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="median" label="median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline_2" label="mean_baseline_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg" label="avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_2" label="median_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline_2" label="median_baseline_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg_2" label="avg_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev_2" label="stdev_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad_2" label="mad_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="bid" label="bid" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stat_seasonality" label="stat_seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_scale" label="lower_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_scale" label="upper_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_pct" label="upper_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="middle_pct" label="middle_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_pct" label="lower_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev_none" label="stdev_none" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad_none" label="mad_none" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev_hourly" label="stdev_hourly" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad_hourly" label="mad_hourly" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev_week_hourly" label="stdev_week_hourly" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad_week_hourly" label="mad_week_hourly" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      </DataSource>
                    </Source>
                    <Output name="Anomaly" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly" referenceType="viaops.anomaly.Raw_Anomaly">
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm_name" label="algorithm_name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_median" label="baseline_median" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev" label="baseline_stdev" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad" label="baseline_mad" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_avg" label="baseline_avg" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stats" label="baseline_stats" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="zscore" label="zscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mzscore" label="mzscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="cscore" label="cscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="deviation" label="deviation" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_score" label="upper_score" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_score" label="lower_score" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="conf_id" label="conf_id" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="trigger" label="trigger" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="new_metric" label="new_metric" type="boolean" clazz="" isArray="false" isOptional="true"/>
                      <Field name="severity" label="severity" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="is_anomaly" label="is_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="batch_tm" label="batch_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Dropped" uid="1" outputType="DStream" dataType="class:viaops.anomaly.Dropped_Metrics" referenceType="viaops.anomaly.Dropped_Metrics">
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[
  import com.vitria.viaops.AnomalyUtil
  import com.vitria.spark.api.scala.OperatorUtils._

  def isNewMetric(metric: Enrich_All) = if (metric.avg.isEmpty || metric.avg_2.isEmpty) true else false

  def checkDropped(metric: Enrich_All) = {
val newMetric = isNewMetric(metric)
Seq(
    // take off the percentile and statistic check fo now.
    //if (!newMetric) (if (!metric.upper_pct.isEmpty) null else "Percentile") else null,
    //if (!newMetric) {
    //   if (!metric.stat_seasonality.isEmpty) metric.stat_seasonality.get match {
    //      case "none"        => if (!metric.stdev_none.isEmpty) null else "Statistic-None"
    //      case "hourly"      => if (!metric.stdev_hourly.isEmpty) null else "Statistic-Hourly"
    //      case "week-hourly" => if (!metric.stdev_week_hourly.isEmpty) null else "Statistic-Week-Hourly"
    //      case _             => null
    //    }
    //    else "Statistic"
    // } else null,
       if (!metric.lower_scale.isEmpty) null else "BaselineMetricConf"
    ).filter(_ != null).mkString(",")
  }

  source1.cache()
  val globalConf = com.vitria.viaops.ad.SolGlobalConf.getGlobalConfList("${ServiceName}", "${BaselineDataSource}", vtContext)
  val windowSize = globalConf.window_size

  val enrichDropReason = source1.map(m => (m, checkDropped(m)))

  val anomaly = enrichDropReason.filter(_._2.size == 0).mapPartitions(partition => {

partition.map((metric => {
  // 1. baseline interpolation
  val baseline_avg = AnomalyUtil.interpolation(metric._1.avg, metric._1.avg_2, windowSize, metric._1.metrics.start_tm)
  //val baseline_aggr_sum = AnomalyUtil.interpolation(metric._1.aggr_sum, metric._1.aggr_sum_2, windowSize, metric._1.metrics.start_tm)
  //val baseline_parent_aggr_sum = AnomalyUtil.interpolation(metric._1.parent_aggr_sum, metric._1.parent_aggr_sum_2, windowSize, metric._1.metrics.start_tm)
  val baseline_mad = AnomalyUtil.interpolation(metric._1.mad, metric._1.mad_2, windowSize, metric._1.metrics.start_tm)
  val baseline_stdev = AnomalyUtil.interpolation(metric._1.stdev, metric._1.stdev_2, windowSize, metric._1.metrics.start_tm)
  val baseline_median = AnomalyUtil.interpolation(metric._1.median, metric._1.median_2, windowSize, metric._1.metrics.start_tm)
  val baseline_median_baseline = AnomalyUtil.interpolation(metric._1.median_baseline, metric._1.median_baseline_2, windowSize, metric._1.metrics.start_tm)
  val baseline_mean_baseline = AnomalyUtil.interpolation(metric._1.mean_baseline, metric._1.mean_baseline_2, windowSize, metric._1.metrics.start_tm)

  // Calculate the proportion against parent
  val deviation = Option(metric._1.metrics.aggr_metric) SUB baseline_median
  //val event_proportion = AnomalyUtil.devide(metric._1.metrics.aggr_sum, metric._1.metrics.aggr_parent_sum)
  //val baseline_proportion = AnomalyUtil.devide2(baseline_aggr_sum, baseline_parent_aggr_sum)
  //val deviation_proportion = AnomalyUtil.devide2(deviation, Option(metric._1.metrics.aggr_parent_sum) SUB baseline_parent_aggr_sum)

  // Scale the percentile according the scale value in baseline metric conf
  val new_upper_pct = metric._1.upper_scale MUL (metric._1.upper_pct SUB metric._1.middle_pct) ADD baseline_median
  val new_lower_pct = metric._1.lower_scale MUL (metric._1.lower_pct SUB metric._1.middle_pct) ADD baseline_median

  val stdev_mad = metric._1.stat_seasonality.get match {
case "none"        => (metric._1.stdev_none, metric._1.mad_none)
case "hourly"      => (metric._1.stdev_hourly, metric._1.mad_hourly)
case "week-hourly" => (metric._1.stdev_week_hourly, metric._1.stdev_week_hourly)
case "weekly"      => (baseline_stdev, baseline_mad)
case _             => (None, None)
  }

  // Compute ccore and anomaly.
  val anomaly = com.vitria.viaops.Anomaly(
new_upper_pct,
metric._1.middle_pct,
new_lower_pct,
metric._1.metrics.aggr_metric,
baseline_median,
baseline_median_baseline,
stdev_mad._1,
stdev_mad._2)

  val anomaly_result = AnomalyUtil.anomaly(anomaly, metric._1.score_method.get, metric._1.anomaly_trigger.get, "threshold")

  val row = viaops.anomaly.Raw_Anomaly(
metric._1.adm_name.get,
metric._1.name,
metric._1.metrics.window_size,
metric._1.metrics.window_step,
metric._1.metrics.start_tm,
metric._1.metrics.end_tm,
System.currentTimeMillis()/1000,
metric._1.metrics.metric_id,
metric._1.metrics.dow,
metric._1.metrics.algorithm,
metric._1.metrics.aggr_metric,
metric._1.metrics.last_interval_metric,
baseline_median,
metric._1.stdev_none,
metric._1.mad_none,
metric._1.stdev_hourly,
metric._1.mad_hourly,
baseline_stdev,
baseline_mad,
metric._1.stdev_week_hourly,
metric._1.mad_week_hourly,
baseline_avg,
baseline_median_baseline,
baseline_mean_baseline,
metric._1.stat_seasonality,
metric._1.score_method,
anomaly_result._1,
anomaly_result._2,
anomaly_result._3,
deviation,
anomaly_result._4,
anomaly_result._5,
None,
None,
metric._1.bid.map(_.toInt),
metric._1.anomaly_trigger,
Option(isNewMetric(metric._1)),
anomaly_result._6,
if (anomaly_result._6 == 0) true else false,
globalConf.formatDateKey(metric._1.adm_name.get, metric._1.metrics.start_tm),
metric._1.metrics.base_metric_id,
metric._1.metrics.dim_keys,
metric._1.metrics.dim_values,
Option(metric._1.metrics.generated_tm)
)
  row
}))
  }, true)

  val dropped = enrichDropReason.filter(_._2.size > 0).map(metric => {
val drop = viaops.anomaly.Dropped_Metrics(
  metric._1.metrics.window_size,
  metric._1.metrics.window_step,
  metric._1.metrics.start_tm,
  metric._1.metrics.end_tm,
  metric._1.metrics.generated_tm,
  metric._1.metrics.metric_id,
  metric._1.metrics.dow,
  metric._1.metrics.algorithm,
  metric._1.metrics.seasonality,
  metric._1.metrics.aggr_metric,
  metric._1.metrics.last_interval_metric,
  metric._2,
  metric._1.metrics.base_metric_id,
  metric._1.metrics.dim_keys,
  metric._1.metrics.dim_values,
  metric._1.metrics.model_metric_id
  )
drop
  })

  val retval = (anomaly, dropped)]]></Script>
                    </Model>
                </Node>
                <Node index="1001_10" uuid="18e43a0b-6266-46a7-8956-44c1b81e7d66" type="JDBCStream" label="MeticConf" x="40" y="253" width="130" height="75">
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.anomaly.baseline.conf.Baseline_Conf">
                      <Field name="bid" label="bid" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="stat_seasonality" label="stat_seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="lower_scale" label="lower_scale" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="upper_scale" label="upper_scale" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="jdbcStream" sourceType="jdbc" caseClass="viaops.anomaly.baseline.conf.Baseline_Conf" isClassRef="true" dataSpeed="" dataVolume="" dataSource="/vitria/m3o/datasource/DefaultDomain/viaops_config_db">
                      <__binding__><![CDATA[{"dataSource":"BaselineDataSource"}]]></__binding__>
                      <Schema>
                        <Field name="bid" label="bid" type="long" clazz="" isArray="false" isOptional="false" wrapName="bid"/>
                        <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false" wrapName="adm_name"/>
                        <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true" wrapName="name"/>
                        <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false" wrapName="metric_id"/>
                        <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true" wrapName="score_method"/>
                        <Field name="stat_seasonality" label="stat_seasonality" type="string" clazz="" isArray="false" isOptional="true" wrapName="stat_seasonality"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="true" wrapName="anomaly_trigger"/>
                        <Field name="lower_scale" label="lower_scale" type="double" clazz="" isArray="false" isOptional="true" wrapName="lower_scale"/>
                        <Field name="upper_scale" label="upper_scale" type="double" clazz="" isArray="false" isOptional="true" wrapName="upper_scale"/>
                        <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="true" wrapName="enabled"/>
                        <Field name="modified_ts" label="modified_ts" type="datetime" clazz="" isArray="false" isOptional="true" wrapName="modified_ts"/>
                      </Schema>
                      <datasource name="/vitria/m3o/datasource/DefaultDomain/viaops_config_db"></datasource>
                      <query>
                      <table schema='viaops_config_db' defaultSchema='viaops_config_db' info='{"catalog":"viaops_config_db","name":"viaops_anomaly_baseline_score","type":"VIEW"}'>viaops_anomaly_baseline_score</table>
                      <columns>
                        <column>bid</column>
                        <column>adm_name</column>
                        <column>name</column>
                        <column>metric_id</column>
                        <column>score_method</column>
                        <column>stat_seasonality</column>
                        <column>anomaly_trigger</column>
                        <column>lower_scale</column>
                        <column>upper_scale</column>
                        <column>enabled</column>
                      </columns>
                      <growColumns>
                      </growColumns>
                      <filter>enabled</filter>
                      <incremental>false</incremental>
                      </query>
                      <pollRate every='${BaselinePollRate}/m' value='NaN'/>
                    </Model>
                </Node>
                <Node index="1001_11" uuid="72ea5c3f-0366-4456-879c-df4c8e9bdcb4" type="Window" label="Metric Conf" x="389" y="300" width="83" height="135">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.baseline.conf.Baseline_Conf">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="ec696960-2456-43b0-8288-6b754c508a35">
                        <Field name="bid" label="bid" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="stat_seasonality" label="stat_seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="lower_scale" label="lower_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="upper_scale" label="upper_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="All" uid="0" outputType="DStream" dataType="class:viaops.anomaly.baseline.conf.Baseline_Conf">
                      <Field name="bid" label="bid" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="stat_seasonality" label="stat_seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="lower_scale" label="lower_scale" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="upper_scale" label="upper_scale" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Changes" uid="1" outputType="DStream" dataType="class:viaops.anomaly.baseline.conf.Baseline_Conf">
                      <Field name="bid" label="bid" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="stat_seasonality" label="stat_seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="lower_scale" label="lower_scale" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="upper_scale" label="upper_scale" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Expired" uid="2" outputType="DStream" dataType="class:viaops.anomaly.baseline.conf.Baseline_Conf">
                      <Field name="bid" label="bid" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="stat_seasonality" label="stat_seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="lower_scale" label="lower_scale" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="upper_scale" label="upper_scale" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Deleted" uid="3" outputType="DStream" dataType="class:viaops.anomaly.baseline.conf.Baseline_Conf">
                      <Field name="bid" label="bid" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="stat_seasonality" label="stat_seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="lower_scale" label="lower_scale" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="upper_scale" label="upper_scale" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model windowPolicy="attribute" partition="" checkpointInterval="/S" restoreState="false">
                      <Time mode="system">
                      </Time>
                      <GroupKeys policy="latest" numPerGroup="1">
                        <GroupKey field="metric_id"/>
                      </GroupKeys>
                      <Expirations duration="/S" baseline="lastevent">
                      </Expirations>
                    </Model>
                </Node>
                <Node index="1001_12" uuid="b65d127d-c8c3-4619-8d8c-16868c2dc6f2" type="Join" label="Enrich Metric Conf" x="580" y="60" width="119" height="95">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:metric_baseline2">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="f0dc99da-3c62-4457-8d99-5cc29c8f261a">
                        <Field name="currentoffset" label="currentoffset" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="median" label="median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg" label="avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_2" label="median_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline_2" label="median_baseline_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline_2" label="mean_baseline_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg_2" label="avg_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev_2" label="stdev_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad_2" label="mad_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      </DataSource>
                    </Source>
                    <Source name="source2" uid="1" outputType="DStream" dataType="class:viaops.anomaly.baseline.conf.Baseline_Conf">
                      <DataSource category="#OUTPUT" id="undefined" name="All" nodeId="72ea5c3f-0366-4456-879c-df4c8e9bdcb4">
                        <Field name="bid" label="bid" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="stat_seasonality" label="stat_seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="lower_scale" label="lower_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="upper_scale" label="upper_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Metric_Baseline_Conf">
                      <Field name="currentoffset" label="currentoffset" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_size" label="window_size" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="median" label="median" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline_2" label="mean_baseline_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg" label="avg" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_2" label="median_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline_2" label="median_baseline_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg_2" label="avg_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev_2" label="stdev_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad_2" label="mad_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="bid" label="bid" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stat_seasonality" label="stat_seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_scale" label="lower_scale" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_scale" label="upper_scale" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="true"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model joinType="LeftOuterJoin" _caseClass="Metric_Baseline_Conf" isClassRef="false" joinAlgorithms="broadcast">
                      <Predicates sleText="source1.metrics.model_metric_id= source2.metric_id"/>
                      <ProjectionsEditor>
                        <ProjectionInfo source="source1.currentoffset" name="currentoffset" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.metrics" name="metrics" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median" name="median" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_baseline" name="median_baseline" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mean_baseline_2" name="mean_baseline_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.avg" name="avg" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev" name="stdev" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad" name="mad" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_2" name="median_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_baseline_2" name="median_baseline_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mean_baseline" name="mean_baseline" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.avg_2" name="avg_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev_2" name="stdev_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad_2" name="mad_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.bid" name="bid" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.adm_name" name="adm_name" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.name" name="name" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.metric_id" name="metric_id" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.score_method" name="score_method" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.stat_seasonality" name="stat_seasonality" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.anomaly_trigger" name="anomaly_trigger" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.lower_scale" name="lower_scale" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.upper_scale" name="upper_scale" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.enabled" name="enabled" level="1" exclude="false"/>
                      </ProjectionsEditor>
                      <Projections>
                        <Projection source="source1.currentoffset" name="currentoffset" label="currentoffset"/>
                        <Projection source="source1.metrics" name="metrics" label="metrics"/>
                        <Projection source="source1.median" name="median" label="median"/>
                        <Projection source="source1.median_baseline" name="median_baseline" label="median_baseline"/>
                        <Projection source="source1.mean_baseline_2" name="mean_baseline_2" label="mean_baseline_2"/>
                        <Projection source="source1.avg" name="avg" label="avg"/>
                        <Projection source="source1.stdev" name="stdev" label="stdev"/>
                        <Projection source="source1.mad" name="mad" label="mad"/>
                        <Projection source="source1.median_2" name="median_2" label="median_2"/>
                        <Projection source="source1.median_baseline_2" name="median_baseline_2" label="median_baseline_2"/>
                        <Projection source="source1.mean_baseline" name="mean_baseline" label="mean_baseline"/>
                        <Projection source="source1.avg_2" name="avg_2" label="avg_2"/>
                        <Projection source="source1.stdev_2" name="stdev_2" label="stdev_2"/>
                        <Projection source="source1.mad_2" name="mad_2" label="mad_2"/>
                        <Projection source="source2.bid" name="bid" label="bid"/>
                        <Projection source="source2.adm_name" name="adm_name" label="adm_name"/>
                        <Projection source="source2.name" name="name" label="name"/>
                        <Projection source="source2.metric_id" name="metric_id" label="metric_id"/>
                        <Projection source="source2.score_method" name="score_method" label="score_method"/>
                        <Projection source="source2.stat_seasonality" name="stat_seasonality" label="stat_seasonality"/>
                        <Projection source="source2.anomaly_trigger" name="anomaly_trigger" label="anomaly_trigger"/>
                        <Projection source="source2.lower_scale" name="lower_scale" label="lower_scale"/>
                        <Projection source="source2.upper_scale" name="upper_scale" label="upper_scale"/>
                        <Projection source="source2.enabled" name="enabled" label="enabled"/>
                      </Projections>
                    </Model>
                </Node>
                <Node index="1001_13" uuid="d77c33ad-ca41-4c14-82d5-ae3f1a43b5a5" type="Adhoc" label="Load Percentile " x="40" y="340" width="130" height="75">
                    <Output name="Percentile " uid="0" outputType="DStream" dataType="class:InternalPercentile" referenceType="InternalPercentile">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="upper_pct" label="upper_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="middle_pct" label="middle_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="lower_pct" label="lower_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[ import org.apache.spark.streaming.dstream.{ VtFullTableInputDStream, VtFullTableSetting }
 import org.apache.spark.sql.{ Row }
 import com.vitria.viaops.DFUtil._
 val fullTableSetting = new VtFullTableSetting
 fullTableSetting.setServiceNameList(com.vitria.viaops.ADMUtils.splitAdms("${ServiceName}"))
 .setFullTableName("${PercentileTable}")
 .setPollRate("${PollRate}".toInt)
 .setSelectColumns("metric_id, upper_pct, middle_pct, lower_pct")
 .setTsColumn("generated_tm")
 
   def converter(row: Row): InternalPercentile = {
     InternalPercentile(
       row.getString(0), //metric_id
       row.getDouble(1), //upper_pct
       row.getDouble(2), //middle_pct
       row.getDouble(3)) //lower_pct
    }
                         
 val retval = new VtFullTableInputDStream[InternalPercentile](
  ssc,
  () => hiveContext.sparkSession,
  fullTableSetting,
  converter)
          ]]></Script>
                    </Model>
                </Node>
                <Node index="1001_14" uuid="41347c67-2790-4ac3-877a-0c6349227a73" type="Window" label="Percentile" x="500" y="351" width="83" height="135">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:InternalPercentile">
                      <DataSource category="#OUTPUT" id="undefined" name="Percentile " nodeId="d77c33ad-ca41-4c14-82d5-ae3f1a43b5a5">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="upper_pct" label="upper_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="middle_pct" label="middle_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="lower_pct" label="lower_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="All" uid="0" outputType="DStream" dataType="class:InternalPercentile">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="upper_pct" label="upper_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="middle_pct" label="middle_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="lower_pct" label="lower_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Changes" uid="1" outputType="DStream" dataType="class:InternalPercentile">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="upper_pct" label="upper_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="middle_pct" label="middle_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="lower_pct" label="lower_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Expired" uid="2" outputType="DStream" dataType="class:InternalPercentile">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="upper_pct" label="upper_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="middle_pct" label="middle_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="lower_pct" label="lower_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Deleted" uid="3" outputType="DStream" dataType="class:InternalPercentile">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="upper_pct" label="upper_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="middle_pct" label="middle_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="lower_pct" label="lower_pct" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model windowPolicy="attribute" partition="" checkpointInterval="/S" restoreState="false">
                      <Time mode="system">
                      </Time>
                      <GroupKeys policy="latest" numPerGroup="1">
                        <GroupKey field="metric_id"/>
                      </GroupKeys>
                      <Expirations duration="/S" baseline="lastevent">
                      </Expirations>
                    </Model>
                </Node>
                <Node index="1001_15" uuid="a3c731eb-1dda-4be1-8f09-30a252c14d40" type="Join" label="Enrich Percentile" x="600" y="180" width="111" height="95">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:Metric_Baseline_Conf">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="b65d127d-c8c3-4619-8d8c-16868c2dc6f2">
                        <Field name="currentoffset" label="currentoffset" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="median" label="median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline_2" label="mean_baseline_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg" label="avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_2" label="median_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline_2" label="median_baseline_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg_2" label="avg_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev_2" label="stdev_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad_2" label="mad_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="bid" label="bid" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stat_seasonality" label="stat_seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_scale" label="lower_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_scale" label="upper_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      </DataSource>
                    </Source>
                    <Source name="source2" uid="1" outputType="DStream" dataType="class:InternalPercentile">
                      <DataSource category="#OUTPUT" id="undefined" name="All" nodeId="41347c67-2790-4ac3-877a-0c6349227a73">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="upper_pct" label="upper_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="middle_pct" label="middle_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="lower_pct" label="lower_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Metric_Baseline_Conf_Percentile">
                      <Field name="currentoffset" label="currentoffset" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_size" label="window_size" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="median" label="median" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline_2" label="mean_baseline_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg" label="avg" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_2" label="median_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline_2" label="median_baseline_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg_2" label="avg_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev_2" label="stdev_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad_2" label="mad_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="bid" label="bid" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stat_seasonality" label="stat_seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_scale" label="lower_scale" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_scale" label="upper_scale" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_pct" label="upper_pct" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="middle_pct" label="middle_pct" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_pct" label="lower_pct" type="double" clazz="" isArray="false" isOptional="true"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model joinType="LeftOuterJoin" _caseClass="Metric_Baseline_Conf_Percentile" isClassRef="false" joinAlgorithms="broadcast">
                      <Predicates sleText="source1.metrics.metric_id = source2.metric_id"/>
                      <ProjectionsEditor>
                        <ProjectionInfo source="source1.currentoffset" name="currentoffset" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.metrics" name="metrics" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median" name="median" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_baseline" name="median_baseline" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mean_baseline_2" name="mean_baseline_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.avg" name="avg" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev" name="stdev" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad" name="mad" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_2" name="median_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_baseline_2" name="median_baseline_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mean_baseline" name="mean_baseline" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.avg_2" name="avg_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev_2" name="stdev_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad_2" name="mad_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.bid" name="bid" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.adm_name" name="adm_name" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.name" name="name" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.metric_id" name="metric_id" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.score_method" name="score_method" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stat_seasonality" name="stat_seasonality" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.anomaly_trigger" name="anomaly_trigger" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.lower_scale" name="lower_scale" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.upper_scale" name="upper_scale" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.enabled" name="enabled" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.upper_pct" name="upper_pct" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.middle_pct" name="middle_pct" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.lower_pct" name="lower_pct" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.metric_id" name="metric_id_3" level="1" exclude="true"/>
                      </ProjectionsEditor>
                      <Projections>
                        <Projection source="source1.currentoffset" name="currentoffset" label="currentoffset"/>
                        <Projection source="source1.metrics" name="metrics" label="metrics"/>
                        <Projection source="source1.median" name="median" label="median"/>
                        <Projection source="source1.median_baseline" name="median_baseline" label="median_baseline"/>
                        <Projection source="source1.mean_baseline_2" name="mean_baseline_2" label="mean_baseline_2"/>
                        <Projection source="source1.avg" name="avg" label="avg"/>
                        <Projection source="source1.stdev" name="stdev" label="stdev"/>
                        <Projection source="source1.mad" name="mad" label="mad"/>
                        <Projection source="source1.median_2" name="median_2" label="median_2"/>
                        <Projection source="source1.median_baseline_2" name="median_baseline_2" label="median_baseline_2"/>
                        <Projection source="source1.mean_baseline" name="mean_baseline" label="mean_baseline"/>
                        <Projection source="source1.avg_2" name="avg_2" label="avg_2"/>
                        <Projection source="source1.stdev_2" name="stdev_2" label="stdev_2"/>
                        <Projection source="source1.mad_2" name="mad_2" label="mad_2"/>
                        <Projection source="source1.bid" name="bid" label="bid"/>
                        <Projection source="source1.adm_name" name="adm_name" label="adm_name"/>
                        <Projection source="source1.name" name="name" label="name"/>
                        <Projection source="source1.metric_id" name="metric_id" label="metric_id"/>
                        <Projection source="source1.score_method" name="score_method" label="score_method"/>
                        <Projection source="source1.stat_seasonality" name="stat_seasonality" label="stat_seasonality"/>
                        <Projection source="source1.anomaly_trigger" name="anomaly_trigger" label="anomaly_trigger"/>
                        <Projection source="source1.lower_scale" name="lower_scale" label="lower_scale"/>
                        <Projection source="source1.upper_scale" name="upper_scale" label="upper_scale"/>
                        <Projection source="source1.enabled" name="enabled" label="enabled"/>
                        <Projection source="source2.upper_pct" name="upper_pct" label="upper_pct"/>
                        <Projection source="source2.middle_pct" name="middle_pct" label="middle_pct"/>
                        <Projection source="source2.lower_pct" name="lower_pct" label="lower_pct"/>
                      </Projections>
                    </Model>
                </Node>
                <Node index="1001_16" uuid="53842b7e-0f44-425e-8a09-e82dc28918bf" type="Adhoc" label="Load Statistic" x="40" y="426" width="130" height="75">
                    <Output name="Percentile " uid="0" outputType="DStream" dataType="class:InternalStatistic" referenceType="InternalStatistic">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[ import org.apache.spark.streaming.dstream.{ VtStatisticTableInputDStream, VtFullTableSetting }
 import org.apache.spark.sql.{ Row }
 import com.vitria.viaops.DFUtil._
 val fullTableSetting = new VtFullTableSetting
 fullTableSetting.setServiceNameList(com.vitria.viaops.ADMUtils.splitAdms("${ServiceName}"))
 .setFullTableName("${StatisticTable}")
 .setPollRate("${PollRate}".toInt)
 .setSelectColumns("metric_id, seasonality, dow, seconds_of_day, stdev, mad")
 .setTsColumn("generated_tm")
 
  def converter(row: Row): InternalStatistic = {
    InternalStatistic(
     row.getString(0), //metric_id
     row.getString(1), //seasonality
     getOptionString(row, 2), //dow
     getOptionInt(row, 3), //seconds_of_day
     row.getDouble(4), //stdev
     row.getDouble(5)) //mad
   }
 
 val retval = new VtStatisticTableInputDStream[InternalStatistic](
   ssc,
   () => hiveContext.sparkSession,
   fullTableSetting,
   converter)
   ]]></Script>
                    </Model>
                </Node>
                <Node index="1001_17" uuid="7e6e5186-3b4d-46b5-813f-e7080906d1e6" type="Window" label="Statistic" x="620" y="392" width="83" height="135">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:InternalStatistic">
                      <DataSource category="#OUTPUT" id="undefined" name="Percentile " nodeId="53842b7e-0f44-425e-8a09-e82dc28918bf">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="seconds_of_day" label="seconds_of_day" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="All" uid="0" outputType="DStream" dataType="class:InternalStatistic">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Changes" uid="1" outputType="DStream" dataType="class:InternalStatistic">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Expired" uid="2" outputType="DStream" dataType="class:InternalStatistic">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Deleted" uid="3" outputType="DStream" dataType="class:InternalStatistic">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model windowPolicy="attribute" partition="" checkpointInterval="/S" restoreState="false">
                      <Time mode="system">
                      </Time>
                      <GroupKeys policy="latest" numPerGroup="1">
                        <GroupKey field="metric_id"/>
                        <GroupKey field="seasonality"/>
                        <GroupKey field="dow"/>
                        <GroupKey field="seconds_of_day"/>
                      </GroupKeys>
                      <Expirations duration="/S" baseline="lastevent">
                      </Expirations>
                    </Model>
                </Node>
                <Node index="1001_18" uuid="68e47939-a871-414d-892d-fa91827d8126" type="Router" label="Router" x="760" y="220" width="120" height="135">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:InternalStatistic">
                      <DataSource category="#OUTPUT" id="undefined" name="All" nodeId="7e6e5186-3b4d-46b5-813f-e7080906d1e6">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="seconds_of_day" label="seconds_of_day" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="None" uid="0" outputType="DStream" dataType="class:InternalStatistic">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Hourly" uid="2" outputType="DStream" dataType="class:InternalStatistic">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Week-hourly" uid="5" outputType="DStream" dataType="class:InternalStatistic">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Week" uid="3" outputType="DStream" dataType="class:InternalStatistic">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="seconds_of_day" label="seconds_of_day" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"sleExpressions":[{"_id":"cc1a1b6b-5fdc-49f9-83c8-ec2075d2c953","sleExpression":{"text":"seasonality =\"none\"","type":"boolean","option":false},"label":"None"},{"_id":"3af28f06-2b5b-4575-8e07-80fff26ea16e","sleExpression":{"text":"seasonality =\"hourly\"","type":"boolean","option":false},"label":"Hourly"},{"_id":"749f761a-49a8-4243-8bad-1fcd5941e596","sleExpression":{"text":"seasonality =\"week-hourly\"","type":"boolean","option":false},"label":"Week-hourly"},{"_id":"2f0ae96d-01de-4b3f-8a9c-ade8b5768adc","sleExpression":{"text":"seasonality =\"week\"","type":"boolean","option":false},"label":"Week"}]}
</Properties>
                    </Model>
                </Node>
                <Node index="1001_19" uuid="74ddd949-7370-4ee5-8b9d-d6f8f78ef7fe" type="Join" label="Enrich None Sta" x="768" y="60" width="130" height="95">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:Metric_Baseline_Conf_Percentile">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="a3c731eb-1dda-4be1-8f09-30a252c14d40">
                        <Field name="currentoffset" label="currentoffset" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="median" label="median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline_2" label="mean_baseline_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg" label="avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_2" label="median_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline_2" label="median_baseline_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg_2" label="avg_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev_2" label="stdev_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad_2" label="mad_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="bid" label="bid" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stat_seasonality" label="stat_seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_scale" label="lower_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_scale" label="upper_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_pct" label="upper_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="middle_pct" label="middle_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_pct" label="lower_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      </DataSource>
                    </Source>
                    <Source name="source2" uid="1" outputType="DStream" dataType="class:InternalStatistic">
                      <DataSource category="#OUTPUT" id="undefined" name="None" nodeId="68e47939-a871-414d-892d-fa91827d8126">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="seconds_of_day" label="seconds_of_day" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Statistic_None">
                      <Field name="currentoffset" label="currentoffset" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_size" label="window_size" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="median" label="median" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline_2" label="mean_baseline_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg" label="avg" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_2" label="median_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline_2" label="median_baseline_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg_2" label="avg_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev_2" label="stdev_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad_2" label="mad_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="bid" label="bid" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stat_seasonality" label="stat_seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_scale" label="lower_scale" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_scale" label="upper_scale" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_pct" label="upper_pct" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="middle_pct" label="middle_pct" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_pct" label="lower_pct" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev_none" label="stdev_none" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad_none" label="mad_none" type="double" clazz="" isArray="false" isOptional="true"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model joinType="LeftOuterJoin" _caseClass="Statistic_None" isClassRef="false" joinAlgorithms="shuffle">
                      <Predicates sleText="source1.metrics.metric_id = source2.metric_id"/>
                      <ProjectionsEditor>
                        <ProjectionInfo source="source1.currentoffset" name="currentoffset" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.metrics" name="metrics" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median" name="median" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_baseline" name="median_baseline" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mean_baseline_2" name="mean_baseline_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.avg" name="avg" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev" name="stdev" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad" name="mad" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_2" name="median_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_baseline_2" name="median_baseline_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mean_baseline" name="mean_baseline" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.avg_2" name="avg_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev_2" name="stdev_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad_2" name="mad_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.bid" name="bid" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.adm_name" name="adm_name" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.name" name="name" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.metric_id" name="metric_id" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.score_method" name="score_method" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stat_seasonality" name="stat_seasonality" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.anomaly_trigger" name="anomaly_trigger" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.lower_scale" name="lower_scale" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.upper_scale" name="upper_scale" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.enabled" name="enabled" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.upper_pct" name="upper_pct" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.middle_pct" name="middle_pct" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.lower_pct" name="lower_pct" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.seasonality" name="seasonality" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.dow" name="dow" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.seconds_of_day" name="seconds_of_day" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.stdev" name="stdev_none" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.mad" name="mad_none" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.metric_id" name="metric_id_4" level="1" exclude="true"/>
                      </ProjectionsEditor>
                      <Projections>
                        <Projection source="source1.currentoffset" name="currentoffset" label="currentoffset"/>
                        <Projection source="source1.metrics" name="metrics" label="metrics"/>
                        <Projection source="source1.median" name="median" label="median"/>
                        <Projection source="source1.median_baseline" name="median_baseline" label="median_baseline"/>
                        <Projection source="source1.mean_baseline_2" name="mean_baseline_2" label="mean_baseline_2"/>
                        <Projection source="source1.avg" name="avg" label="avg"/>
                        <Projection source="source1.stdev" name="stdev" label="stdev"/>
                        <Projection source="source1.mad" name="mad" label="mad"/>
                        <Projection source="source1.median_2" name="median_2" label="median_2"/>
                        <Projection source="source1.median_baseline_2" name="median_baseline_2" label="median_baseline_2"/>
                        <Projection source="source1.mean_baseline" name="mean_baseline" label="mean_baseline"/>
                        <Projection source="source1.avg_2" name="avg_2" label="avg_2"/>
                        <Projection source="source1.stdev_2" name="stdev_2" label="stdev_2"/>
                        <Projection source="source1.mad_2" name="mad_2" label="mad_2"/>
                        <Projection source="source1.bid" name="bid" label="bid"/>
                        <Projection source="source1.adm_name" name="adm_name" label="adm_name"/>
                        <Projection source="source1.name" name="name" label="name"/>
                        <Projection source="source1.metric_id" name="metric_id" label="metric_id"/>
                        <Projection source="source1.score_method" name="score_method" label="score_method"/>
                        <Projection source="source1.stat_seasonality" name="stat_seasonality" label="stat_seasonality"/>
                        <Projection source="source1.anomaly_trigger" name="anomaly_trigger" label="anomaly_trigger"/>
                        <Projection source="source1.lower_scale" name="lower_scale" label="lower_scale"/>
                        <Projection source="source1.upper_scale" name="upper_scale" label="upper_scale"/>
                        <Projection source="source1.enabled" name="enabled" label="enabled"/>
                        <Projection source="source1.upper_pct" name="upper_pct" label="upper_pct"/>
                        <Projection source="source1.middle_pct" name="middle_pct" label="middle_pct"/>
                        <Projection source="source1.lower_pct" name="lower_pct" label="lower_pct"/>
                        <Projection source="source2.stdev" name="stdev_none" label="stdev_none"/>
                        <Projection source="source2.mad" name="mad_none" label="mad_none"/>
                      </Projections>
                    </Model>
                </Node>
                <Node index="1001_20" uuid="f1ff997c-6f3b-4657-8f70-70c304dc2d29" type="Join" label="Enrich Hourly sta" x="950" y="60" width="130" height="95">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:Statistic_None">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="74ddd949-7370-4ee5-8b9d-d6f8f78ef7fe">
                        <Field name="currentoffset" label="currentoffset" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="median" label="median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline_2" label="mean_baseline_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg" label="avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_2" label="median_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline_2" label="median_baseline_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg_2" label="avg_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev_2" label="stdev_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad_2" label="mad_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="bid" label="bid" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stat_seasonality" label="stat_seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_scale" label="lower_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_scale" label="upper_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_pct" label="upper_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="middle_pct" label="middle_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_pct" label="lower_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev_none" label="stdev_none" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad_none" label="mad_none" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      </DataSource>
                    </Source>
                    <Source name="source2" uid="1" outputType="DStream" dataType="class:InternalStatistic">
                      <DataSource category="#OUTPUT" id="undefined" name="Hourly" nodeId="68e47939-a871-414d-892d-fa91827d8126">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="seconds_of_day" label="seconds_of_day" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Statistic_Hourly">
                      <Field name="currentoffset" label="currentoffset" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_size" label="window_size" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="median" label="median" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline_2" label="mean_baseline_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg" label="avg" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_2" label="median_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline_2" label="median_baseline_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg_2" label="avg_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev_2" label="stdev_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad_2" label="mad_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="bid" label="bid" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stat_seasonality" label="stat_seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_scale" label="lower_scale" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_scale" label="upper_scale" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_pct" label="upper_pct" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="middle_pct" label="middle_pct" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_pct" label="lower_pct" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev_none" label="stdev_none" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad_none" label="mad_none" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev_hourly" label="stdev_hourly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad_hourly" label="mad_hourly" type="double" clazz="" isArray="false" isOptional="true"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model joinType="LeftOuterJoin" _caseClass="Statistic_Hourly" isClassRef="false" joinAlgorithms="shuffle">
                      <Predicates sleText="source1.metrics.metric_id = source2.metric_id and source1.currentoffset = source2.seconds_of_day"/>
                      <ProjectionsEditor>
                        <ProjectionInfo source="source1.currentoffset" name="currentoffset" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.metrics" name="metrics" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median" name="median" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_baseline" name="median_baseline" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mean_baseline_2" name="mean_baseline_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.avg" name="avg" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev" name="stdev" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad" name="mad" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_2" name="median_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_baseline_2" name="median_baseline_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mean_baseline" name="mean_baseline" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.avg_2" name="avg_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev_2" name="stdev_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad_2" name="mad_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.bid" name="bid" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.adm_name" name="adm_name" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.name" name="name" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.metric_id" name="metric_id" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.score_method" name="score_method" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stat_seasonality" name="stat_seasonality" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.anomaly_trigger" name="anomaly_trigger" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.lower_scale" name="lower_scale" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.upper_scale" name="upper_scale" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.enabled" name="enabled" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.upper_pct" name="upper_pct" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.middle_pct" name="middle_pct" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.lower_pct" name="lower_pct" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev_none" name="stdev_none" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad_none" name="mad_none" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.seasonality" name="seasonality" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.dow" name="dow" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.seconds_of_day" name="seconds_of_day" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.stdev" name="stdev_hourly" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.mad" name="mad_hourly" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.metric_id" name="metric_id_5" level="1" exclude="true"/>
                      </ProjectionsEditor>
                      <Projections>
                        <Projection source="source1.currentoffset" name="currentoffset" label="currentoffset"/>
                        <Projection source="source1.metrics" name="metrics" label="metrics"/>
                        <Projection source="source1.median" name="median" label="median"/>
                        <Projection source="source1.median_baseline" name="median_baseline" label="median_baseline"/>
                        <Projection source="source1.mean_baseline_2" name="mean_baseline_2" label="mean_baseline_2"/>
                        <Projection source="source1.avg" name="avg" label="avg"/>
                        <Projection source="source1.stdev" name="stdev" label="stdev"/>
                        <Projection source="source1.mad" name="mad" label="mad"/>
                        <Projection source="source1.median_2" name="median_2" label="median_2"/>
                        <Projection source="source1.median_baseline_2" name="median_baseline_2" label="median_baseline_2"/>
                        <Projection source="source1.mean_baseline" name="mean_baseline" label="mean_baseline"/>
                        <Projection source="source1.avg_2" name="avg_2" label="avg_2"/>
                        <Projection source="source1.stdev_2" name="stdev_2" label="stdev_2"/>
                        <Projection source="source1.mad_2" name="mad_2" label="mad_2"/>
                        <Projection source="source1.bid" name="bid" label="bid"/>
                        <Projection source="source1.adm_name" name="adm_name" label="adm_name"/>
                        <Projection source="source1.name" name="name" label="name"/>
                        <Projection source="source1.metric_id" name="metric_id" label="metric_id"/>
                        <Projection source="source1.score_method" name="score_method" label="score_method"/>
                        <Projection source="source1.stat_seasonality" name="stat_seasonality" label="stat_seasonality"/>
                        <Projection source="source1.anomaly_trigger" name="anomaly_trigger" label="anomaly_trigger"/>
                        <Projection source="source1.lower_scale" name="lower_scale" label="lower_scale"/>
                        <Projection source="source1.upper_scale" name="upper_scale" label="upper_scale"/>
                        <Projection source="source1.enabled" name="enabled" label="enabled"/>
                        <Projection source="source1.upper_pct" name="upper_pct" label="upper_pct"/>
                        <Projection source="source1.middle_pct" name="middle_pct" label="middle_pct"/>
                        <Projection source="source1.lower_pct" name="lower_pct" label="lower_pct"/>
                        <Projection source="source1.stdev_none" name="stdev_none" label="stdev_none"/>
                        <Projection source="source1.mad_none" name="mad_none" label="mad_none"/>
                        <Projection source="source2.stdev" name="stdev_hourly" label="stdev_hourly"/>
                        <Projection source="source2.mad" name="mad_hourly" label="mad_hourly"/>
                      </Projections>
                    </Model>
                </Node>
                <Node index="1001_21" uuid="a009bbd9-8f53-4847-8cd4-8287192a21f5" type="Join" label="Enrich Weekly Hourly" x="956" y="185" width="130" height="95">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:Statistic_Hourly">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="f1ff997c-6f3b-4657-8f70-70c304dc2d29">
                        <Field name="currentoffset" label="currentoffset" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                        <Field name="median" label="median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline_2" label="mean_baseline_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg" label="avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_2" label="median_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline_2" label="median_baseline_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="avg_2" label="avg_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev_2" label="stdev_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad_2" label="mad_2" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="bid" label="bid" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stat_seasonality" label="stat_seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_scale" label="lower_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_scale" label="upper_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_pct" label="upper_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="middle_pct" label="middle_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_pct" label="lower_pct" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev_none" label="stdev_none" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad_none" label="mad_none" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev_hourly" label="stdev_hourly" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mad_hourly" label="mad_hourly" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      </DataSource>
                    </Source>
                    <Source name="source2" uid="1" outputType="DStream" dataType="class:InternalStatistic">
                      <DataSource category="#OUTPUT" id="undefined" name="Week-hourly" nodeId="68e47939-a871-414d-892d-fa91827d8126">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="seconds_of_day" label="seconds_of_day" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="stdev" label="stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="mad" label="mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Enrich_All">
                      <Field name="currentoffset" label="currentoffset" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metrics" label="metrics" type="viaops.anomaly.Aggr_Metrics" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_size" label="window_size" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="viaops.anomaly.Aggr_Metrics" isArray="false" isOptional="false"/>
                      <Field name="median" label="median" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline_2" label="mean_baseline_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg" label="avg" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev" label="stdev" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad" label="mad" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_2" label="median_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline_2" label="median_baseline_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="avg_2" label="avg_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev_2" label="stdev_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad_2" label="mad_2" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="bid" label="bid" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stat_seasonality" label="stat_seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_scale" label="lower_scale" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_scale" label="upper_scale" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_pct" label="upper_pct" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="middle_pct" label="middle_pct" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_pct" label="lower_pct" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev_none" label="stdev_none" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad_none" label="mad_none" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev_hourly" label="stdev_hourly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad_hourly" label="mad_hourly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="stdev_week_hourly" label="stdev_week_hourly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mad_week_hourly" label="mad_week_hourly" type="double" clazz="" isArray="false" isOptional="true"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model joinType="LeftOuterJoin" _caseClass="Enrich_All" isClassRef="false" joinAlgorithms="shuffle">
                      <Predicates sleText="source1.metrics.metric_id = source2.metric_id and source1.metrics.dow = source2.dow and source1.currentoffset = source2.seconds_of_day"/>
                      <ProjectionsEditor>
                        <ProjectionInfo source="source1.currentoffset" name="currentoffset" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.metrics" name="metrics" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median" name="median" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_baseline" name="median_baseline" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mean_baseline_2" name="mean_baseline_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.avg" name="avg" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev" name="stdev" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad" name="mad" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_2" name="median_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.median_baseline_2" name="median_baseline_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mean_baseline" name="mean_baseline" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.avg_2" name="avg_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev_2" name="stdev_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad_2" name="mad_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.bid" name="bid" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.adm_name" name="adm_name" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.name" name="name" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.metric_id" name="metric_id" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.score_method" name="score_method" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stat_seasonality" name="stat_seasonality" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.anomaly_trigger" name="anomaly_trigger" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.lower_scale" name="lower_scale" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.upper_scale" name="upper_scale" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.enabled" name="enabled" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.upper_pct" name="upper_pct" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.middle_pct" name="middle_pct" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.lower_pct" name="lower_pct" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev_none" name="stdev_none" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad_none" name="mad_none" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.stdev_hourly" name="stdev_hourly" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.mad_hourly" name="mad_hourly" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.seasonality" name="seasonality" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.dow" name="dow" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.seconds_of_day" name="seconds_of_day" level="1" exclude="true"/>
                        <ProjectionInfo source="source2.stdev" name="stdev_week_hourly" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.mad" name="mad_week_hourly" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.metric_id" name="metric_id_6" level="1" exclude="true"/>
                      </ProjectionsEditor>
                      <Projections>
                        <Projection source="source1.currentoffset" name="currentoffset" label="currentoffset"/>
                        <Projection source="source1.metrics" name="metrics" label="metrics"/>
                        <Projection source="source1.median" name="median" label="median"/>
                        <Projection source="source1.median_baseline" name="median_baseline" label="median_baseline"/>
                        <Projection source="source1.mean_baseline_2" name="mean_baseline_2" label="mean_baseline_2"/>
                        <Projection source="source1.avg" name="avg" label="avg"/>
                        <Projection source="source1.stdev" name="stdev" label="stdev"/>
                        <Projection source="source1.mad" name="mad" label="mad"/>
                        <Projection source="source1.median_2" name="median_2" label="median_2"/>
                        <Projection source="source1.median_baseline_2" name="median_baseline_2" label="median_baseline_2"/>
                        <Projection source="source1.mean_baseline" name="mean_baseline" label="mean_baseline"/>
                        <Projection source="source1.avg_2" name="avg_2" label="avg_2"/>
                        <Projection source="source1.stdev_2" name="stdev_2" label="stdev_2"/>
                        <Projection source="source1.mad_2" name="mad_2" label="mad_2"/>
                        <Projection source="source1.bid" name="bid" label="bid"/>
                        <Projection source="source1.adm_name" name="adm_name" label="adm_name"/>
                        <Projection source="source1.name" name="name" label="name"/>
                        <Projection source="source1.metric_id" name="metric_id" label="metric_id"/>
                        <Projection source="source1.score_method" name="score_method" label="score_method"/>
                        <Projection source="source1.stat_seasonality" name="stat_seasonality" label="stat_seasonality"/>
                        <Projection source="source1.anomaly_trigger" name="anomaly_trigger" label="anomaly_trigger"/>
                        <Projection source="source1.lower_scale" name="lower_scale" label="lower_scale"/>
                        <Projection source="source1.upper_scale" name="upper_scale" label="upper_scale"/>
                        <Projection source="source1.enabled" name="enabled" label="enabled"/>
                        <Projection source="source1.upper_pct" name="upper_pct" label="upper_pct"/>
                        <Projection source="source1.middle_pct" name="middle_pct" label="middle_pct"/>
                        <Projection source="source1.lower_pct" name="lower_pct" label="lower_pct"/>
                        <Projection source="source1.stdev_none" name="stdev_none" label="stdev_none"/>
                        <Projection source="source1.mad_none" name="mad_none" label="mad_none"/>
                        <Projection source="source1.stdev_hourly" name="stdev_hourly" label="stdev_hourly"/>
                        <Projection source="source1.mad_hourly" name="mad_hourly" label="mad_hourly"/>
                        <Projection source="source2.stdev" name="stdev_week_hourly" label="stdev_week_hourly"/>
                        <Projection source="source2.mad" name="mad_week_hourly" label="mad_week_hourly"/>
                      </Projections>
                    </Model>
                </Node>
                <Node index="1001_22" uuid="ec696960-2456-43b0-8288-6b754c508a35" type="Filter" label="Filter by adm_name list" x="230" y="300" width="124" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.baseline.conf.Baseline_Conf">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="18e43a0b-6266-46a7-8956-44c1b81e7d66">
                        <Field name="bid" label="bid" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="stat_seasonality" label="stat_seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="lower_scale" label="lower_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="upper_scale" label="upper_scale" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.anomaly.baseline.conf.Baseline_Conf">
                      <Field name="bid" label="bid" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="stat_seasonality" label="stat_seasonality" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="lower_scale" label="lower_scale" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="upper_scale" label="upper_scale" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model filterModel="form" udfs="adm_in_list">
                      <Filters>
                        <Filter field="" op="sleText" arg="" value="" sleText="adm_in_list(adm_name, &quot;${ServiceName}&quot;)"/>
                      </Filters>
                    </Model>
                </Node>
                <Link srcId="ec696960-2456-43b0-8288-6b754c508a35" srcPort="out:0" tgtId="72ea5c3f-0366-4456-879c-df4c8e9bdcb4" tgtPort="in:0"/>
                <Link srcId="18e43a0b-6266-46a7-8956-44c1b81e7d66" srcPort="out:0" tgtId="ec696960-2456-43b0-8288-6b754c508a35" tgtPort="in:0"/>
                <Link srcId="68e47939-a871-414d-892d-fa91827d8126" srcPort="dout:5" tgtId="a009bbd9-8f53-4847-8cd4-8287192a21f5" tgtPort="din:1"/>
                <Link srcId="f1ff997c-6f3b-4657-8f70-70c304dc2d29" srcPort="out:0" tgtId="a009bbd9-8f53-4847-8cd4-8287192a21f5" tgtPort="din:0"/>
                <Link srcId="a009bbd9-8f53-4847-8cd4-8287192a21f5" srcPort="out:0" tgtId="a951dd55-592b-4eeb-8c56-31182a345a1e" tgtPort="din:0"/>
                <Link srcId="68e47939-a871-414d-892d-fa91827d8126" srcPort="dout:2" tgtId="f1ff997c-6f3b-4657-8f70-70c304dc2d29" tgtPort="din:1"/>
                <Link srcId="68e47939-a871-414d-892d-fa91827d8126" srcPort="dout:0" tgtId="74ddd949-7370-4ee5-8b9d-d6f8f78ef7fe" tgtPort="din:1"/>
                <Link srcId="a3c731eb-1dda-4be1-8f09-30a252c14d40" srcPort="out:0" tgtId="74ddd949-7370-4ee5-8b9d-d6f8f78ef7fe" tgtPort="din:0"/>
                <Link srcId="f085d957-efde-45b5-8add-bbe0d738c384" srcPort="dout:0" tgtId="f0dc99da-3c62-4457-8d99-5cc29c8f261a" tgtPort="din:1"/>
                <Link srcId="f085d957-efde-45b5-8add-bbe0d738c384" srcPort="dout:0" tgtId="cc75431a-e2ae-4ca1-847f-a055637ae10b" tgtPort="din:1"/>
                <Link srcId="cd6b3007-9e4c-4fa9-8e5d-e0faecb6d708" srcPort="dout:0" tgtId="f085d957-efde-45b5-8add-bbe0d738c384" tgtPort="in:0"/>
                <Link srcId="cc75431a-e2ae-4ca1-847f-a055637ae10b" srcPort="out:0" tgtId="f0dc99da-3c62-4457-8d99-5cc29c8f261a" tgtPort="din:0"/>
                <Link srcId="84143669-19ec-47bd-80b5-ba1ab6f4c67f" srcPort="out:0" tgtId="347b676a-6948-4d66-8b03-2d4cce4cdab8" tgtPort="din:0"/>
                <Link srcId="347b676a-6948-4d66-8b03-2d4cce4cdab8" srcPort="dout:0" tgtId="cc75431a-e2ae-4ca1-847f-a055637ae10b" tgtPort="din:0"/>
                <Link srcId="f0dc99da-3c62-4457-8d99-5cc29c8f261a" srcPort="dout:0" tgtId="b65d127d-c8c3-4619-8d8c-16868c2dc6f2" tgtPort="din:0"/>
                <Link srcId="72ea5c3f-0366-4456-879c-df4c8e9bdcb4" srcPort="dout:0" tgtId="b65d127d-c8c3-4619-8d8c-16868c2dc6f2" tgtPort="din:1"/>
                <Link srcId="d77c33ad-ca41-4c14-82d5-ae3f1a43b5a5" srcPort="dout:0" tgtId="41347c67-2790-4ac3-877a-0c6349227a73" tgtPort="in:0"/>
                <Link srcId="41347c67-2790-4ac3-877a-0c6349227a73" srcPort="dout:0" tgtId="a3c731eb-1dda-4be1-8f09-30a252c14d40" tgtPort="din:1"/>
                <Link srcId="b65d127d-c8c3-4619-8d8c-16868c2dc6f2" srcPort="out:0" tgtId="a3c731eb-1dda-4be1-8f09-30a252c14d40" tgtPort="din:0"/>
                <Link srcId="53842b7e-0f44-425e-8a09-e82dc28918bf" srcPort="dout:0" tgtId="7e6e5186-3b4d-46b5-813f-e7080906d1e6" tgtPort="in:0"/>
                <Link srcId="7e6e5186-3b4d-46b5-813f-e7080906d1e6" srcPort="dout:0" tgtId="68e47939-a871-414d-892d-fa91827d8126" tgtPort="in:0"/>
                <Link srcId="74ddd949-7370-4ee5-8b9d-d6f8f78ef7fe" srcPort="out:0" tgtId="f1ff997c-6f3b-4657-8f70-70c304dc2d29" tgtPort="din:0"/>
                <Link srcId="a951dd55-592b-4eeb-8c56-31182a345a1e" srcPort="dout:0" tgtId="2cf8837b-f824-42d6-8816-0e1984156748" tgtPort="in:0"/>
                <Link srcId="a951dd55-592b-4eeb-8c56-31182a345a1e" srcPort="dout:1" tgtId="1e6dc70e-248d-4ad1-89fb-2ae6f23dff3e" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
          <Lib scope="system" systemPath="${VTBA_HOME}/VIAOps/libs/AnomalyDetection-1.0.jar"/>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"ServiceName","label":"Anomaly Detection Method Name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"_dataSourceSelector","*":{"label":"label","desc":"desc"},"name":"BaselineDataSource","label":"Anomaly Configuration Datasource","type":"object","hidden":"false","disabled":false,"resolveProperty":false,"value":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/viaops_config_db"},"constraints":{"type":"dataSource","args":{}},"enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"DailyBaselineTable","label":"Daily Baseline Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"baseline","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"OverrideBaselineTable","label":"Override Baseline Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"override_baseline","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"PercentileTable","label":"Percentile Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"percentile","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"StatisticTable","label":"Statistic Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"statistic","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"BaselinePollRate","label":"Poll Rate For Baseline Conf (Minutes)","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"5","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"PollRate","label":"Poll Rate For Percentile And Statistic (Minutes)","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"1440","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"DailyCheckTime","label":"Baseline Daily Check Time","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"23:50","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"BaselineStartDate","label":"Initial Baseline Start Date (Global Solution Timezone)","type":"string","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"KeepDays","label":"Keep Baseline (Days)","type":"string","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"BaselineUpdateInterval","label":"Baseline Update Interval (Minutes)","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"0","enumSource":"","runtimeControl":false},{"editorType":"sparkSelect","*":{"label":"label","desc":"desc","options.dow":"constraints.args.options.0.label","options.ww":"constraints.args.options.1.label","options. ":"constraints.args.options.2.label"},"group":"common","name":"Baseline_Seasonality","label":"Baseline Seasonality","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":" ","constraints":{"type":"sparkSelect","args":{"options":[{"label":"Day Of Week","value":"dow"},{"label":"Weekday Weekend","value":"ww"},{"label":"Default","value":" "}],"needPlaceholder":true,"multiple":false,"url":"http://10.101.7.163:18080/vitria-oi/rest/app/spark/space/VIAOps Anomaly/sparkm/VIAOps - Baseline Anomaly Detection","_cid":"6b0943f6-c375-4e54-8ee9-68ed891d5129","name":"defaultValueForExisted"}},"runtimeControl":false}]</Properties>
      <Types>[{"name":"EnrichMetrics","namespace":"","schema":[{"name":"metrics","type":"viaops.anomaly.Aggr_Metrics","_isOptional":false,"_isArray":false},{"name":"currentdow","type":"string","_isOptional":false,"_isArray":false},{"name":"currentoffset","type":"integer","_isOptional":false,"_isArray":false},{"name":"nextdow","type":"string","_isOptional":false,"_isArray":false},{"name":"nextoffset","type":"integer","_isOptional":false,"_isArray":false}]},{"name":"InternalBaseline","namespace":"","schema":[{"name":"dow","type":"string","_isOptional":false,"_isArray":false},{"name":"seconds_of_day","type":"integer","_isOptional":false,"_isArray":false},{"name":"metric_id","type":"string","_isOptional":false,"_isArray":false},{"name":"median","type":"double","_isOptional":false,"_isArray":false},{"name":"median_baseline","type":"double","_isOptional":false,"_isArray":false},{"name":"mean_baseline","type":"double","_isOptional":false,"_isArray":false},{"name":"avg","type":"double","_isOptional":false,"_isArray":false},{"name":"stdev","type":"double","_isOptional":false,"_isArray":false},{"name":"mad","type":"double","_isOptional":false,"_isArray":false},{"name":"usage","type":"integer","_isOptional":false,"_isArray":false},{"name":"generated_tm","type":"long","_isOptional":false,"_isArray":false}]},{"name":"InternalPercentile","namespace":"","schema":[{"name":"metric_id","type":"string","_isOptional":false,"_isArray":false},{"name":"upper_pct","type":"double","_isOptional":false,"_isArray":false},{"name":"middle_pct","type":"double","_isOptional":false,"_isArray":false},{"name":"lower_pct","type":"double","_isOptional":false,"_isArray":false}]},{"name":"InternalStatistic","namespace":"","schema":[{"name":"metric_id","type":"string","_isOptional":false,"_isArray":false},{"name":"seasonality","type":"string","_isOptional":false,"_isArray":false},{"name":"dow","type":"string","_isOptional":true,"_isArray":false},{"name":"seconds_of_day","type":"integer","_isOptional":true,"_isArray":false},{"name":"stdev","type":"double","_isOptional":false,"_isArray":false},{"name":"mad","type":"double","_isOptional":false,"_isArray":false}]},{"name":"metric_baseline2","namespace":"","schema":[{"name":"currentoffset","label":"currentoffset","type":"integer","clazz":"","_isArray":false,"_isOptional":false},{"name":"metrics","label":"metrics","type":"viaops.anomaly.Aggr_Metrics","clazz":"","_isArray":false,"_isOptional":false},{"name":"median","label":"median","type":"double","clazz":"","_isArray":false,"_isOptional":true},{"name":"median_baseline","label":"median_baseline","type":"double","clazz":"","_isArray":false,"_isOptional":true},{"name":"mean_baseline","label":"mean_baseline","type":"double","clazz":"","_isArray":false,"_isOptional":true},{"name":"avg","label":"avg","type":"double","clazz":"","_isArray":false,"_isOptional":true},{"name":"stdev","label":"stdev","type":"double","clazz":"","_isArray":false,"_isOptional":true},{"name":"mad","label":"mad","type":"double","clazz":"","_isArray":false,"_isOptional":true},{"name":"median_2","label":"median_2","type":"double","clazz":"","_isArray":false,"_isOptional":true},{"name":"median_baseline_2","label":"median_baseline_2","type":"double","clazz":"","_isArray":false,"_isOptional":true},{"name":"mean_baseline_2","label":"mean_baseline_2","type":"double","clazz":"","_isArray":false,"_isOptional":true},{"name":"avg_2","label":"avg_2","type":"double","clazz":"","_isArray":false,"_isOptional":true},{"name":"stdev_2","label":"stdev_2","type":"double","clazz":"","_isArray":false,"_isOptional":true},{"name":"mad_2","label":"mad_2","type":"double","clazz":"","_isArray":false,"_isOptional":true}]}]</Types>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"BaselineDataSource":"dataSource","Baseline_Seasonality":"Baseline_Seasonality"}]]></__binding__>
            </Model>
        </Node>
        <Node index="1002" uuid="9fe5fa8b-9bb3-45ed-84ef-4f81d83a270e" type="subflow" label="AnomalyPersistence" x="1320" y="40" width="130" height="75">
            <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
              <DataSource category="#OUTPUT" id="undefined" name="RawAnomaly" nodeId="cdd60428-52e9-4e8c-8c63-9ba685144f37">
                <Field name="adm_name" label="adm_name" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="algorithm_name" label="algorithm_name" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="window_size" label="window_size" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="window_step" label="window_step" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="generated_tm" label="generated_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="dow" label="dow" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="algorithm" label="algorithm" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_median" label="baseline_median" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_stdev" label="baseline_stdev" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_mad" label="baseline_mad" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_avg" label="baseline_avg" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="median_baseline" label="median_baseline" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_stats" label="baseline_stats" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="score_method" label="score_method" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="zscore" label="zscore" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="mzscore" label="mzscore" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="cscore" label="cscore" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="deviation" label="deviation" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="upper_score" label="upper_score" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="lower_score" label="lower_score" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="conf_id" label="conf_id" type="integer" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="trigger" label="trigger" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="new_metric" label="new_metric" type="boolean" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="severity" label="severity" type="integer" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="is_anomaly" label="is_anomaly" type="boolean" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="date_key" label="date_key" type="integer" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_values" label="dim_values" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="batch_tm" label="batch_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
              </DataSource>
            </Source>
            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
              <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm_name" label="algorithm_name" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_median" label="baseline_median" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev" label="baseline_stdev" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad" label="baseline_mad" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_avg" label="baseline_avg" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stats" label="baseline_stats" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="zscore" label="zscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="mzscore" label="mzscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="cscore" label="cscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="deviation" label="deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="upper_score" label="upper_score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="lower_score" label="lower_score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="conf_id" label="conf_id" type="integer" clazz="" isArray="false" isOptional="true"/>
              <Field name="trigger" label="trigger" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="new_metric" label="new_metric" type="boolean" clazz="" isArray="false" isOptional="true"/>
              <Field name="severity" label="severity" type="integer" clazz="" isArray="false" isOptional="false"/>
              <Field name="is_anomaly" label="is_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="batch_tm" label="batch_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.anomaly/AnomalyPersistence","anomaly_table_name":"${anomaly}","output_partition_number":"1"}
</Properties>
              <__subflow__>
              <Flow index="1002" uuid="AnomalyPersistence" isNested="true" revision="95" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.anomaly/AnomalyPersistence" name="AnomalyPersistence" showFooter="true">
                <Node index="1002_1" uuid="f7cc2fc6-1004-4a0e-825f-0cabd9b874f7" type="inPort" label="In" x="121" y="43" width="70" height="40">
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly" referenceType="viaops.anomaly.Raw_Anomaly">
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm_name" label="algorithm_name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_median" label="baseline_median" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev" label="baseline_stdev" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad" label="baseline_mad" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_avg" label="baseline_avg" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stats" label="baseline_stats" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="zscore" label="zscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mzscore" label="mzscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="cscore" label="cscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="deviation" label="deviation" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_score" label="upper_score" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_score" label="lower_score" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="conf_id" label="conf_id" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="trigger" label="trigger" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="new_metric" label="new_metric" type="boolean" clazz="" isArray="false" isOptional="true"/>
                      <Field name="severity" label="severity" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="is_anomaly" label="is_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="batch_tm" label="batch_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"*","type":{"name":"viaops.anomaly.Raw_Anomaly","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1002_2" uuid="245c1c9f-22ad-43be-8576-b667ce2549b3" type="StreamTarget" label="Save data" x="340" y="28" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="f7cc2fc6-1004-4a0e-825f-0cabd9b874f7">
                        <Field name="adm_name" label="adm_name" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm_name" label="algorithm_name" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_median" label="baseline_median" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev" label="baseline_stdev" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad" label="baseline_mad" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_avg" label="baseline_avg" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stats" label="baseline_stats" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="zscore" label="zscore" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mzscore" label="mzscore" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="cscore" label="cscore" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="deviation" label="deviation" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_score" label="upper_score" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_score" label="lower_score" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="conf_id" label="conf_id" type="integer" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="trigger" label="trigger" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="new_metric" label="new_metric" type="boolean" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="severity" label="severity" type="integer" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="is_anomaly" label="is_anomaly" type="boolean" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="integer" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="batch_tm" label="batch_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm_name" label="algorithm_name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_median" label="baseline_median" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev" label="baseline_stdev" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad" label="baseline_mad" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_avg" label="baseline_avg" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stats" label="baseline_stats" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="zscore" label="zscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mzscore" label="mzscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="cscore" label="cscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="deviation" label="deviation" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_score" label="upper_score" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_score" label="lower_score" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="conf_id" label="conf_id" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="trigger" label="trigger" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="new_metric" label="new_metric" type="boolean" clazz="" isArray="false" isOptional="true"/>
                      <Field name="severity" label="severity" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="is_anomaly" label="is_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="batch_tm" label="batch_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="hiveTable" tableName="${anomaly_table_name}" partitionType="eventField" partitionSize="" partitionColumn="date_key" partitionIndex="39" timeColumn="" overwrite="false" partitionNum="${output_partition_number}" dataSpeed="" dataVolume="">
                      <__binding__><![CDATA[{"overwrite":""}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1002_3" uuid="de1d3bad-a3c2-43c7-8a58-07af0a87b206" type="outPort" label="Out" x="580" y="48" width="70" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="245c1c9f-22ad-43be-8576-b667ce2549b3">
                        <Field name="adm_name" label="adm_name" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm_name" label="algorithm_name" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_median" label="baseline_median" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev" label="baseline_stdev" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad" label="baseline_mad" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_avg" label="baseline_avg" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stats" label="baseline_stats" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="zscore" label="zscore" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mzscore" label="mzscore" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="cscore" label="cscore" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="deviation" label="deviation" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_score" label="upper_score" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_score" label="lower_score" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="conf_id" label="conf_id" type="integer" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="trigger" label="trigger" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="new_metric" label="new_metric" type="boolean" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                        <Field name="severity" label="severity" type="integer" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="is_anomaly" label="is_anomaly" type="boolean" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="integer" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                        <Field name="batch_tm" label="batch_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{}
</Properties>
                    </Model>
                </Node>
                <Link srcId="f7cc2fc6-1004-4a0e-825f-0cabd9b874f7" srcPort="out:0" tgtId="245c1c9f-22ad-43be-8576-b667ce2549b3" tgtPort="in:0"/>
                <Link srcId="245c1c9f-22ad-43be-8576-b667ce2549b3" srcPort="out:0" tgtId="de1d3bad-a3c2-43c7-8a58-07af0a87b206" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"anomaly_table_name","label":"Anomaly Table Name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"itops_metric_anomaly","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"output_partition_number","label":"Output Partition Number","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"1","enumSource":"","runtimeControl":false}]</Properties>
              </Flow>
</__subflow__>
            </Model>
        </Node>
        <Node index="1003" uuid="bfa5a694-bb0b-4843-8980-f81a653fe7af" type="StreamSource" label="timeseries" x="36" y="40" width="95" height="89">
            <Output name="Out1" uid="0" outputType="DStream" dataType="String">
              <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model type="textFileStream" url="${m_source}" nameFilter="" include="true" initialOffset="latest" maxFileSizeInUnit="100" maxFileSizeUnit="mb" maxFileSize="104857600" speficiedStartPosition="false" isOutputFileName="false" isSkipFirstLine="false" dataSpeed="" dataVolume="">
            </Model>
        </Node>
        <Node index="1004" uuid="727dd54e-99ce-4e82-89d2-51646aa97d55" type="Router" label="Step 1" x="811" y="40" width="130" height="115">
            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
              <DataSource category="#OUTPUT" id="undefined" name="aggregate" nodeId="32acad17-e402-4692-8352-9c8b956bf1c4">
                <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="baseline" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Output name="threshold" uid="1" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Output name="ignored" uid="3" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"sleExpressions":[{"_id":"c4cbdee7-5f9c-4b76-8ace-ddd357f8a964","sle":"","port":"","label":"baseline","sleExpression":{"text":"algorithm=\"baseline\"","type":"boolean","option":false}},{"_id":"1a8d40b0-eecb-4072-8170-896ac7b15cd0","sleExpression":{"text":"algorithm=\"threshold\"","type":"boolean","option":false},"label":"threshold"},{"_id":"7ca53fa8-8cd2-44ed-86fb-968d494d7ce6","sleExpression":{"text":"algorithm=\"ignored\"","type":"boolean","option":false},"label":"ignored"}]}
</Properties>
            </Model>
        </Node>
        <Node index="1005" uuid="381f3a4e-83a8-4774-8e14-b92b69275f89" type="StreamTarget" label="Dropped Aggr" x="1520" y="300" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:AddUTCdate_key_Class">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="26f11f6b-4a61-456c-8744-d0d7c23b671e">
                <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="date_key" label="date_key" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:AddUTCdate_key_Class">
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model type="hiveTable" tableName="${dropped_aggr_metrics}" partitionType="eventField" partitionSize="" partitionColumn="date_key" partitionIndex="16" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
            </Model>
        </Node>
        <Node index="1006" uuid="32acad17-e402-4692-8352-9c8b956bf1c4" type="subflow" label="Anomaly Aggregate Metrics" x="540" y="40" width="160" height="95">
            <Source name="Timeseries" uid="0" outputType="DStream" dataType="class:EnrichedTimeSeries">
              <DataSource category="#OUTPUT" id="undefined" name="EnrichedOut" nodeId="1b1ed3f5-5cf6-4b83-88d4-461edc9f9b91">
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="date_key" label="date_key" type="int" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="payload" label="payload" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="Aggregate" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Output name="Dropped" uid="1" outputType="DStream" dataType="class:EnrichedTimeSeries">
              <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false"/>
              <Field name="model_metric_id" label="model_metric_id" type="string" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" isArray="false" isOptional="false"/>
              <Field name="app" label="app" type="string" isArray="false" isOptional="false"/>
              <Field name="metric_name" label="metric_name" type="string" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" isArray="false" isOptional="false"/>
              <Field name="aggr_func" label="aggr_func" type="string" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="double" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="int" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" isArray="false" isOptional="false"/>
              <Field name="payload" label="payload" type="string" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.anomaly/Anomaly Aggregate Metrics","adm_name":"${adm_name_m}","conf_poll_rate":"${pull_r}","hbDelay":"0","hbInterval":"0","outOfOrderDelay":"0","storage_rep_level":"1","dataSource":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/viaops_config_db","databaseURL":"jdbc:mysql://master:3306/viaops_config_db?useSSL=false","userName":"root","password":"&lt;M8pMs!EjNvlgCwGy8NwY4c03YiuDCp&gt;","driverType":"com.mysql.jdbc.Driver"},"aggregateStartDate":" ${s_date}","aggregateEndDate":" ","aggrMetric":"false"}
</Properties>
              <__subflow__>
              <Flow index="1006" uuid="Anomaly Aggregate Metrics" isNested="true" revision="4888" acceptedSourceTypes="DStream" referenceURI="remote:///viaops.anomaly/Anomaly Aggregate Metrics" name="Anomaly Aggregate Metrics" showFooter="true">
                <Node index="1006_1" uuid="84ddc096-9043-4a6d-8e74-2756245826cf" type="outPort" label="Aggregate" x="1000" y="33" width="85.390625" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
                      <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="ae3d4bd1-3ebe-4fd1-81e7-40deb8daac50">
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" referenceType="viaops.anomaly.Aggr_Metrics">
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"type":{"name":"viaops.anomaly.Aggr_Metrics","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1006_2" uuid="6201de9b-13c0-4d52-872a-22551d588ad3" type="outPort" label="Dropped" x="789" y="132" width="76.03125" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:EnrichedTimeSeries">
                      <DataSource category="#OUTPUT" id="undefined" name="dropped" nodeId="c867666f-0325-4a09-8549-bf8776ebfa2b">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="int" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="payload" label="payload" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream">
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"type":{"name":"","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1006_3" uuid="69693eca-06a6-4d91-855b-3af685bc5cb0" type="inPort" label="Timeseries" x="140" y="40" width="88.234375" height="40">
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:EnrichedTimeSeries">
                      <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="int" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" isArray="false" isOptional="false"/>
                      <Field name="payload" label="payload" type="string" isArray="false" isOptional="false"/>
                    </Output>
                    <Model>
<Properties>
{"portType":"*","type":{"name":"","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1006_4" uuid="818ea7a0-131e-4c51-8304-503b387c43c4" type="Window" label="Algorithm" x="480" y="172" width="130" height="135">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:AnomalyAlgorithm">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="37a2519f-8b50-4ebd-8e43-6a45d1aacb89">
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="ignore_anomaly" label="ignore_anomaly" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="All" uid="0" outputType="DStream" dataType="class:AnomalyAlgorithm">
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="ignore_anomaly" label="ignore_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Changes" uid="1" outputType="DStream" dataType="class:AnomalyAlgorithm">
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="ignore_anomaly" label="ignore_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Expired" uid="2" outputType="DStream" dataType="class:AnomalyAlgorithm">
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="ignore_anomaly" label="ignore_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Deleted" uid="3" outputType="DStream" dataType="class:AnomalyAlgorithm">
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="ignore_anomaly" label="ignore_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model windowPolicy="attribute" partition="" checkpointInterval="/S" restoreState="false">
                      <Time mode="system">
                      </Time>
                      <GroupKeys policy="latest" numPerGroup="1">
                        <GroupKey field="adm_name"/>
                        <GroupKey field="metric_id"/>
                      </GroupKeys>
                      <DeleteEvents sleText="!input.enabled"/>
                      <Expirations duration="/S" baseline="lastevent">
                      </Expirations>
                    </Model>
                </Node>
                <Node index="1006_5" uuid="65c92fac-0f75-4e89-8f56-fe578f8b4e85" type="JDBCStream" label="Load Algorithm" x="100" y="108" width="130" height="75">
                    <Output name="out" uid="0" outputType="DStream" dataType="class:AnomalyAlgorithm">
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="ignore_anomaly" label="ignore_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="jdbcStream" sourceType="jdbc" caseClass="AnomalyAlgorithm" isClassRef="true" dataSpeed="" dataVolume="" dataSource="/vitria/m3o/datasource/DefaultDomain/viaops_config_db">
                      <__binding__><![CDATA[{"dataSource":"dataSource"}]]></__binding__>
                      <Schema>
                        <Field name="mid" label="mid" type="long" clazz="" isArray="false" isOptional="false" wrapName="mid"/>
                        <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false" wrapName="adm_name"/>
                        <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true" wrapName="name"/>
                        <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false" wrapName="metric_id"/>
                        <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false" wrapName="algorithm"/>
                        <Field name="fill_policy" label="fill_policy" type="integer" clazz="" isArray="false" isOptional="false" wrapName="fill_policy"/>
                        <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="false" wrapName="seasonality"/>
                        <Field name="ignore_baseline" label="ignore_baseline" type="boolean" clazz="" isArray="false" isOptional="true" wrapName="ignore_baseline"/>
                        <Field name="ignore_anomaly" label="ignore_anomaly" type="boolean" clazz="" isArray="false" isOptional="true" wrapName="ignore_anomaly"/>
                        <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="true" wrapName="enabled"/>
                        <Field name="modified_ts" label="modified_ts" type="datetime" clazz="" isArray="false" isOptional="true" wrapName="modified_ts"/>
                      </Schema>
                      <datasource name="/vitria/m3o/datasource/DefaultDomain/viaops_config_db"></datasource>
                      <query>
                      <table schema='viaops_config_db' defaultSchema='viaops_config_db' info='{"catalog":"viaops_config_db","name":"viaops_anomaly_algorithm","type":"VIEW"}'>viaops_anomaly_algorithm</table>
                      <columns>
                        <column>adm_name</column>
                        <column>metric_id</column>
                        <column>algorithm</column>
                        <column>seasonality</column>
                        <column>ignore_anomaly</column>
                        <column>enabled</column>
                      </columns>
                      <growColumns>
                      </growColumns>
                      <filter/>
                      <incremental>false</incremental>
                      </query>
                      <pollRate every='${conf_poll_rate}/m' value='NaN'/>
                    </Model>
                </Node>
                <Node index="1006_6" uuid="c867666f-0325-4a09-8549-bf8776ebfa2b" type="AnomalyAggregateMetrics" label="Aggregation" x="520" y="20" width="140" height="95">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:EnrichedTimeSeries">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="69693eca-06a6-4d91-855b-3af685bc5cb0">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="int" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="payload" label="payload" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Source name="source2" uid="1" outputType="DStream" dataType="class:AnomalyAlgorithm">
                      <DataSource category="#OUTPUT" id="undefined" name="All" nodeId="818ea7a0-131e-4c51-8304-503b387c43c4">
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="ignore_anomaly" label="ignore_anomaly" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="aggregate" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
                      <Field name="window_size" label="window_size" type="long" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="dropped" uid="1" outputType="DStream" dataType="class:EnrichedTimeSeries">
                      <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="int" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" isArray="false" isOptional="false"/>
                      <Field name="payload" label="payload" type="string" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"hbDelay":"0","hbInterval":"0","outOfOrderDelay":"0","storage_rep_level":"1","adm_name":"${adm_name_m}","aggr_metrics":"${aggrMetric}"}
</Properties>
                      <__binding__><![CDATA[{"hbDelay":"hbDelay","hbInterval":"hbInterval","outOfOrderDelay":"outOfOrderDelay","storage_rep_level":"storage_rep_level","adm_name":"adm_name","windowType":""}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1006_7" uuid="ae3d4bd1-3ebe-4fd1-81e7-40deb8daac50" type="Adhoc" label="Filter" x="787" y="14" width="130" height="75">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
                      <DataSource category="#OUTPUT" id="undefined" name="aggregate" nodeId="c867666f-0325-4a09-8549-bf8776ebfa2b">
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out1" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics" referenceType="viaops.anomaly.Aggr_Metrics">
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[
val gconf = com.vitria.viaops.ad.SolGlobalConf.getGlobalConfList("${adm_name}", "${dataSource}", vtContext).anyConf
val startDate = "${aggregateStartDate}".trim
val toDate = "${aggregateEndDate}".trim
val retval = if("".equals(startDate) && "".equals(toDate)){
  source1
}else{
def getTSM( v:String ):Long={
 if (v.indexOf("-") < 0) v.toLong else gconf.dateToSeconds(v)
}
if("".equals(startDate)){
   val toDateInSeconds= getTSM(toDate)
   source1.vtFilter(item => { item.start_tm < toDateInSeconds })
} else if("".equals(toDate)){
    val beginDateInSeconds = getTSM(startDate)
    source1.vtFilter(item => {item.start_tm >= beginDateInSeconds})
} else{
    val beginDateInSeconds= getTSM(startDate)
    val toDateInSeconds   = getTSM(toDate)
    source1.vtFilter(item => { item.start_tm >= beginDateInSeconds && item.start_tm < toDateInSeconds })
}
}              ]]></Script>
                    </Model>
                </Node>
                <Node index="1006_8" uuid="37a2519f-8b50-4ebd-8e43-6a45d1aacb89" type="Filter" label="Filter by adm name" x="271" y="108" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:AnomalyAlgorithm">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="65c92fac-0f75-4e89-8f56-fe578f8b4e85">
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="ignore_anomaly" label="ignore_anomaly" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:AnomalyAlgorithm">
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="ignore_anomaly" label="ignore_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model filterModel="form" udfs="adm_in_list">
                      <Filters>
                        <Filter field="" op="sleText" arg="" value="" sleText="adm_in_list(adm_name, &quot;${adm_name}&quot;)"/>
                      </Filters>
                    </Model>
                </Node>
                <Link srcId="c867666f-0325-4a09-8549-bf8776ebfa2b" srcPort="dout:0" tgtId="ae3d4bd1-3ebe-4fd1-81e7-40deb8daac50" tgtPort="din:0"/>
                <Link srcId="c867666f-0325-4a09-8549-bf8776ebfa2b" srcPort="dout:1" tgtId="6201de9b-13c0-4d52-872a-22551d588ad3" tgtPort="in:0"/>
                <Link srcId="69693eca-06a6-4d91-855b-3af685bc5cb0" srcPort="out:0" tgtId="c867666f-0325-4a09-8549-bf8776ebfa2b" tgtPort="in:0"/>
                <Link srcId="818ea7a0-131e-4c51-8304-503b387c43c4" srcPort="dout:0" tgtId="c867666f-0325-4a09-8549-bf8776ebfa2b" tgtPort="in:1"/>
                <Link srcId="ae3d4bd1-3ebe-4fd1-81e7-40deb8daac50" srcPort="dout:0" tgtId="84ddc096-9043-4a6d-8e74-2756245826cf" tgtPort="in:0"/>
                <Link srcId="65c92fac-0f75-4e89-8f56-fe578f8b4e85" srcPort="out:0" tgtId="37a2519f-8b50-4ebd-8e43-6a45d1aacb89" tgtPort="in:0"/>
                <Link srcId="37a2519f-8b50-4ebd-8e43-6a45d1aacb89" srcPort="out:0" tgtId="818ea7a0-131e-4c51-8304-503b387c43c4" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
          <Lib scope="system" systemPath="${VTBA_HOME}/VIAOps/libs/AnomalyDetection-1.0.jar"/>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"adm_name","label":"Anomaly Detection Method Name","type":"string","hidden":"false","disabled":false,"impactSchema":"false","escapeValue":false,"resolveProperty":false,"value":"Video","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"conf_poll_rate","label":"Anomaly Configuration Poll Rate in Minutes","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"5","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"hbDelay","label":"Heartbeat Delay in Minutes","type":"long","hidden":"false","disabled":false,"resolveProperty":false,"value":0,"enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"hbInterval","label":"Heartbeat Interval in Minutes","type":"long","hidden":"false","disabled":false,"resolveProperty":false,"value":"0","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"outOfOrderDelay","label":"Out of Order Delay in Minutes","type":"long","hidden":"false","disabled":false,"resolveProperty":false,"value":0,"enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"storage_rep_level","label":"Storage Level Replication","type":"long","hidden":"false","disabled":false,"resolveProperty":false,"value":1,"enumSource":"","runtimeControl":false},{"editorType":"_dataSourceSelector","*":{"label":"label","desc":"desc"},"name":"dataSource","label":"Anomaly Configuration Datasource","type":"object","hidden":"false","disabled":false,"resolveProperty":false,"value":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/viaops_config_db"},"constraints":{"type":"dataSource","args":{}},"enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"aggregateStartDate","label":"Aggregation Start Date","type":"string","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"value":" ","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"aggregateEndDate","label":"Aggregation End Date","type":"string","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"value":" ","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"aggrMetric","label":"Aggregate Metrics","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"true","enumSource":"","runtimeControl":false}]</Properties>
      <Types>[{"name":"AggrFlattenKey","namespace":"","schema":[{"name":"end_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"metric_id","type":"string","_isOptional":false,"_isArray":false},{"name":"agg_func","type":"string","_isOptional":false,"_isArray":false}]},{"name":"AggrMeasure","namespace":"","schema":[{"name":"cnt","type":"double","_isOptional":false,"_isArray":false},{"name":"sum","type":"double","_isOptional":false,"_isArray":false},{"name":"min","type":"double","_isOptional":false,"_isArray":false},{"name":"max","type":"double","_isOptional":false,"_isArray":false},{"name":"lastCnt","type":"double","_isOptional":false,"_isArray":false},{"name":"lastSum","type":"double","_isOptional":false,"_isArray":false},{"name":"lastMin","type":"double","_isOptional":true,"_isArray":false},{"name":"lastMax","type":"double","_isOptional":true,"_isArray":false},{"name":"base_metric_id","type":"string","_isOptional":false,"_isArray":false},{"name":"dim_keys","type":"string","_isOptional":false,"_isArray":false},{"name":"dim_values","type":"string","_isOptional":false,"_isArray":false},{"name":"model_metric_id","type":"string","_isOptional":false,"_isArray":false},{"name":"tm","type":"long","_isOptional":false,"_isArray":false}]},{"name":"AnomalyAlgorithm","namespace":"","schema":[{"name":"adm_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_id","type":"string","_isOptional":false,"_isArray":false},{"name":"algorithm","type":"string","_isOptional":false,"_isArray":false},{"name":"seasonality","type":"string","_isOptional":true,"_isArray":false},{"name":"ignore_anomaly","type":"boolean","_isOptional":false,"_isArray":false},{"name":"enabled","type":"boolean","_isOptional":false,"_isArray":false}]}]</Types>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"dataSource":"dataSource"}]]></__binding__>
            </Model>
        </Node>
        <Node index="1007" uuid="54a00937-cda3-4fcb-816f-99f01118897b" type="StreamTarget" label="Dropped Metric" x="780" y="300" width="124" height="86">
            <Source name="source" uid="0" outputType="DStream" dataType="class:EnrichedTimeSeries">
              <DataSource category="#OUTPUT" id="undefined" name="dropped" nodeId="32acad17-e402-4692-8352-9c8b956bf1c4">
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="date_key" label="date_key" type="int" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="payload" label="payload" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:EnrichedTimeSeries">
              <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false"/>
              <Field name="model_metric_id" label="model_metric_id" type="string" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" isArray="false" isOptional="false"/>
              <Field name="app" label="app" type="string" isArray="false" isOptional="false"/>
              <Field name="metric_name" label="metric_name" type="string" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" isArray="false" isOptional="false"/>
              <Field name="aggr_func" label="aggr_func" type="string" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="double" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="int" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" isArray="false" isOptional="false"/>
              <Field name="payload" label="payload" type="string" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model type="hiveTable" tableName="${dropped_metric}" partitionType="eventField" partitionSize="" partitionColumn="date_key" partitionIndex="10" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
            </Model>
        </Node>
        <Node index="1008" uuid="9d55632e-3d68-4d3d-80fb-3ec12f8041a4" type="subflow" label="Threshold Anomaly Detection" x="1040" y="311" width="180" height="95">
            <Source name="AggrMetrics" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
              <DataSource category="#OUTPUT" id="undefined" name="threshold" nodeId="727dd54e-99ce-4e82-89d2-51646aa97d55">
                <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="RawAnomaly" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
              <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm_name" label="algorithm_name" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_median" label="baseline_median" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev" label="baseline_stdev" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad" label="baseline_mad" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_avg" label="baseline_avg" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stats" label="baseline_stats" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="zscore" label="zscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="mzscore" label="mzscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="cscore" label="cscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="deviation" label="deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="upper_score" label="upper_score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="lower_score" label="lower_score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="conf_id" label="conf_id" type="integer" clazz="" isArray="false" isOptional="true"/>
              <Field name="trigger" label="trigger" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="new_metric" label="new_metric" type="boolean" clazz="" isArray="false" isOptional="true"/>
              <Field name="severity" label="severity" type="integer" clazz="" isArray="false" isOptional="false"/>
              <Field name="is_anomaly" label="is_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="batch_tm" label="batch_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Output name="DroppedMetrics" uid="1" outputType="DStream" dataType="class:viaops.anomaly.Dropped_Metrics">
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.anomaly/Threshold Anomaly Detection","name":"${adm_name_m}","dataSource":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/viaops_config_db","databaseURL":"jdbc:mysql://master:3306/viaops_config_db?useSSL=false","userName":"root","password":"&lt;EJFxa@WjqaIcLUlTfBvNQC3MMFWO@j!&gt;","driverType":"com.mysql.jdbc.Driver"},"pull_rate":"${pull_r}"}
</Properties>
              <__subflow__>
              <Flow index="1008" uuid="Threshold Anomaly Detection" isNested="true" revision="1858" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.anomaly/Threshold Anomaly Detection" name="Threshold Anomaly Detection" showFooter="true">
                <Node index="1008_1" uuid="68048ad8-3a52-4bd1-8e83-ed390aa609fc" type="inPort" label="AggrMetrics" x="71" y="60" width="94.015625" height="40">
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics" referenceType="viaops.anomaly.Aggr_Metrics">
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.anomaly.Aggr_Metrics","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1008_2" uuid="758b5411-0cfc-4a4a-83b0-4075cc9f4d07" type="JDBCStream" label="Poll threshold conf" x="50" y="134" width="130" height="75">
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Anomaly_Threshold_Conf_CaseClass">
                      <Field name="tid" label="tid" type="long" isArray="false" isOptional="false" column="tid" wrapName="tid"/>
                      <Field name="adm_name" label="adm_name" type="string" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                      <Field name="name" label="name" type="string" isArray="false" isOptional="true" column="name" wrapName="name"/>
                      <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false" column="metric_id" wrapName="metric_id"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" isArray="false" isOptional="true" column="lower_threshold" wrapName="lower_threshold"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" isArray="false" isOptional="true" column="upper_threshold" wrapName="upper_threshold"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isArray="false" isOptional="true" column="anomaly_trigger" wrapName="anomaly_trigger"/>
                      <Field name="enabled" label="enabled" type="boolean" isArray="false" isOptional="true" column="enabled" wrapName="enabled"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="jdbcStream" sourceType="jdbc" caseClass="Anomaly_Threshold_Conf_CaseClass" isClassRef="false" dataSpeed="" dataVolume="" dataSource="/vitria/m3o/datasource/DefaultDomain/viaops_config_db">
                      <__binding__><![CDATA[{"dataSource":"dataSource"}]]></__binding__>
                      <Schema>
                        <Field name="tid" label="tid" type="long" clazz="" isArray="false" isOptional="false" wrapName="tid"/>
                        <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false" wrapName="adm_name"/>
                        <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true" wrapName="name"/>
                        <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false" wrapName="metric_id"/>
                        <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true" wrapName="lower_threshold"/>
                        <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true" wrapName="upper_threshold"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="true" wrapName="anomaly_trigger"/>
                        <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="true" wrapName="enabled"/>
                        <Field name="modified_ts" label="modified_ts" type="datetime" clazz="" isArray="false" isOptional="true" wrapName="modified_ts"/>
                      </Schema>
                      <datasource name="/vitria/m3o/datasource/DefaultDomain/viaops_config_db"></datasource>
                      <query>
                      <table schema='viaops_config_db' defaultSchema='viaops_config_db' info='{"catalog":"viaops_config_db","name":"viaops_anomaly_simple_threshold","type":"TABLE"}'>viaops_anomaly_simple_threshold</table>
                      <columns>
                        <column>tid</column>
                        <column>adm_name</column>
                        <column>name</column>
                        <column>metric_id</column>
                        <column>lower_threshold</column>
                        <column>upper_threshold</column>
                        <column>anomaly_trigger</column>
                        <column>enabled</column>
                      </columns>
                      <growColumns>
                      </growColumns>
                      <filter/>
                      <incremental>false</incremental>
                      </query>
                      <pollRate every='${pull_rate}/m' value='NaN'/>
                    </Model>
                </Node>
                <Node index="1008_3" uuid="9babeaf0-9d34-451c-82f8-fa4845e455f4" type="Window" label="Conf Window" x="406" y="220" width="130" height="135">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Anomaly_Threshold_Conf_CaseClass">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="56b9cec9-3680-43b9-8c6f-6c38ff58f56b">
                        <Field name="tid" label="tid" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false" column="tid" wrapName="tid"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" column="name" wrapName="name"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" column="metric_id" wrapName="metric_id"/>
                        <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="true" column="lower_threshold" wrapName="lower_threshold"/>
                        <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="true" column="upper_threshold" wrapName="upper_threshold"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" column="anomaly_trigger" wrapName="anomaly_trigger"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" isArray="false" isOptional="true" column="enabled" wrapName="enabled"/>
                      </DataSource>
                    </Source>
                    <Output name="All" uid="0" outputType="DStream" dataType="class:Anomaly_Threshold_Conf_CaseClass">
                      <Field name="tid" label="tid" type="long" isArray="false" isOptional="false" column="tid" wrapName="tid"/>
                      <Field name="adm_name" label="adm_name" type="string" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                      <Field name="name" label="name" type="string" isArray="false" isOptional="true" column="name" wrapName="name"/>
                      <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false" column="metric_id" wrapName="metric_id"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" isArray="false" isOptional="true" column="lower_threshold" wrapName="lower_threshold"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" isArray="false" isOptional="true" column="upper_threshold" wrapName="upper_threshold"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isArray="false" isOptional="true" column="anomaly_trigger" wrapName="anomaly_trigger"/>
                      <Field name="enabled" label="enabled" type="boolean" isArray="false" isOptional="true" column="enabled" wrapName="enabled"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Changes" uid="1" outputType="DStream" dataType="class:Anomaly_Threshold_Conf_CaseClass">
                      <Field name="tid" label="tid" type="long" isArray="false" isOptional="false" column="tid" wrapName="tid"/>
                      <Field name="adm_name" label="adm_name" type="string" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                      <Field name="name" label="name" type="string" isArray="false" isOptional="true" column="name" wrapName="name"/>
                      <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false" column="metric_id" wrapName="metric_id"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" isArray="false" isOptional="true" column="lower_threshold" wrapName="lower_threshold"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" isArray="false" isOptional="true" column="upper_threshold" wrapName="upper_threshold"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isArray="false" isOptional="true" column="anomaly_trigger" wrapName="anomaly_trigger"/>
                      <Field name="enabled" label="enabled" type="boolean" isArray="false" isOptional="true" column="enabled" wrapName="enabled"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Expired" uid="2" outputType="DStream" dataType="class:Anomaly_Threshold_Conf_CaseClass">
                      <Field name="tid" label="tid" type="long" isArray="false" isOptional="false" column="tid" wrapName="tid"/>
                      <Field name="adm_name" label="adm_name" type="string" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                      <Field name="name" label="name" type="string" isArray="false" isOptional="true" column="name" wrapName="name"/>
                      <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false" column="metric_id" wrapName="metric_id"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" isArray="false" isOptional="true" column="lower_threshold" wrapName="lower_threshold"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" isArray="false" isOptional="true" column="upper_threshold" wrapName="upper_threshold"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isArray="false" isOptional="true" column="anomaly_trigger" wrapName="anomaly_trigger"/>
                      <Field name="enabled" label="enabled" type="boolean" isArray="false" isOptional="true" column="enabled" wrapName="enabled"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Deleted" uid="3" outputType="DStream" dataType="class:Anomaly_Threshold_Conf_CaseClass">
                      <Field name="tid" label="tid" type="long" isArray="false" isOptional="false" column="tid" wrapName="tid"/>
                      <Field name="adm_name" label="adm_name" type="string" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                      <Field name="name" label="name" type="string" isArray="false" isOptional="true" column="name" wrapName="name"/>
                      <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false" column="metric_id" wrapName="metric_id"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" isArray="false" isOptional="true" column="lower_threshold" wrapName="lower_threshold"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" isArray="false" isOptional="true" column="upper_threshold" wrapName="upper_threshold"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isArray="false" isOptional="true" column="anomaly_trigger" wrapName="anomaly_trigger"/>
                      <Field name="enabled" label="enabled" type="boolean" isArray="false" isOptional="true" column="enabled" wrapName="enabled"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model windowPolicy="attribute" partition="" checkpointInterval="/S" restoreState="false">
                      <Time mode="system">
                      </Time>
                      <GroupKeys policy="latest" numPerGroup="1">
                        <GroupKey field="metric_id"/>
                      </GroupKeys>
                      <DeleteEvents sleText="input.enabled = false"/>
                      <Expirations duration="/S" baseline="lastevent">
                      </Expirations>
                    </Model>
                </Node>
                <Node index="1008_4" uuid="0d58804b-406f-4079-8b63-782cf291cbd3" type="Join" label="Join Threshold" x="554" y="40" width="130" height="95">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="68048ad8-3a52-4bd1-8e83-ed390aa609fc">
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Source name="source2" uid="1" outputType="DStream" dataType="class:Anomaly_Threshold_Conf_CaseClass">
                      <DataSource category="#OUTPUT" id="undefined" name="All" nodeId="9babeaf0-9d34-451c-82f8-fa4845e455f4">
                        <Field name="tid" label="tid" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="tid" column="tid"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="adm_name" column="adm_name"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" wrapName="name" column="name"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="metric_id" column="metric_id"/>
                        <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="true" wrapName="lower_threshold" column="lower_threshold"/>
                        <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="true" wrapName="upper_threshold" column="upper_threshold"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" wrapName="anomaly_trigger" column="anomaly_trigger"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" isArray="false" isOptional="true" wrapName="enabled" column="enabled"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Anomaly_Simple_Threshold_Join_CaseClass">
                      <Field name="adm_name_2" label="adm_name_2" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="tid" label="tid" type="long" clazz="" isArray="false" isOptional="true" column="tid" wrapName="tid"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="true" column="adm_name" wrapName="adm_name"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true" column="name" wrapName="name"/>
                      <Field name="metric_id_2" label="metric_id_2" type="string" clazz="" isArray="false" isOptional="true" column="metric_id" wrapName="metric_id"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true" column="lower_threshold" wrapName="lower_threshold"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true" column="upper_threshold" wrapName="upper_threshold"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="true" column="anomaly_trigger" wrapName="anomaly_trigger"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="true" column="enabled" wrapName="enabled"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model joinType="LeftOuterJoin" _caseClass="Anomaly_Simple_Threshold_Join_CaseClass" isClassRef="false" joinAlgorithms="shuffle">
                      <Predicates sleText="source1.model_metric_id = source2.metric_id"/>
                      <ProjectionsEditor>
                        <ProjectionInfo source="source1.adm_name" name="adm_name_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.algorithm" name="algorithm" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.aggr_metric" name="aggr_metric" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.last_interval_metric" name="last_interval_metric" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.model_metric_id" name="model_metric_id" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.window_size" name="window_size" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.window_step" name="window_step" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.start_tm" name="start_tm" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.end_tm" name="end_tm" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.metric_id" name="metric_id" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.dow" name="dow" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.seasonality" name="seasonality" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.generated_tm" name="generated_tm" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.base_metric_id" name="base_metric_id" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.dim_keys" name="dim_keys" level="1" exclude="false"/>
                        <ProjectionInfo source="source1.dim_values" name="dim_values" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.tid" name="tid" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.adm_name" name="adm_name" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.name" name="name" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.metric_id" name="metric_id_2" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.lower_threshold" name="lower_threshold" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.upper_threshold" name="upper_threshold" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.anomaly_trigger" name="anomaly_trigger" level="1" exclude="false"/>
                        <ProjectionInfo source="source2.enabled" name="enabled" level="1" exclude="false"/>
                      </ProjectionsEditor>
                      <Projections>
                        <Projection source="source1.adm_name" name="adm_name_2" label="adm_name_2"/>
                        <Projection source="source1.algorithm" name="algorithm" label="algorithm"/>
                        <Projection source="source1.aggr_metric" name="aggr_metric" label="aggr_metric"/>
                        <Projection source="source1.last_interval_metric" name="last_interval_metric" label="last_interval_metric"/>
                        <Projection source="source1.model_metric_id" name="model_metric_id" label="model_metric_id"/>
                        <Projection source="source1.window_size" name="window_size" label="window_size"/>
                        <Projection source="source1.window_step" name="window_step" label="window_step"/>
                        <Projection source="source1.start_tm" name="start_tm" label="start_tm"/>
                        <Projection source="source1.end_tm" name="end_tm" label="end_tm"/>
                        <Projection source="source1.metric_id" name="metric_id" label="metric_id"/>
                        <Projection source="source1.dow" name="dow" label="dow"/>
                        <Projection source="source1.seasonality" name="seasonality" label="seasonality"/>
                        <Projection source="source1.generated_tm" name="generated_tm" label="generated_tm"/>
                        <Projection source="source1.base_metric_id" name="base_metric_id" label="base_metric_id"/>
                        <Projection source="source1.dim_keys" name="dim_keys" label="dim_keys"/>
                        <Projection source="source1.dim_values" name="dim_values" label="dim_values"/>
                        <Projection source="source2.tid" name="tid" label="tid"/>
                        <Projection source="source2.adm_name" name="adm_name" label="adm_name"/>
                        <Projection source="source2.name" name="name" label="name"/>
                        <Projection source="source2.metric_id" name="metric_id_2" label="metric_id_2"/>
                        <Projection source="source2.lower_threshold" name="lower_threshold" label="lower_threshold"/>
                        <Projection source="source2.upper_threshold" name="upper_threshold" label="upper_threshold"/>
                        <Projection source="source2.anomaly_trigger" name="anomaly_trigger" label="anomaly_trigger"/>
                        <Projection source="source2.enabled" name="enabled" label="enabled"/>
                      </Projections>
                    </Model>
                </Node>
                <Node index="1008_5" uuid="9fcdff57-4b1c-4fd1-8d14-537364573e84" type="Compute" label="Add dropped reason" x="1038" y="177" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Anomaly_Simple_Threshold_Join_CaseClass">
                      <DataSource category="#OUTPUT" id="undefined" name="DroppedMetrics" nodeId="e14c2183-7b49-4a8f-8013-26d4e657c2da">
                        <Field name="adm_name_2" label="adm_name_2" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="tid" label="tid" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="tid" column="tid"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="adm_name" column="adm_name"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="name" column="name"/>
                        <Field name="metric_id_2" label="metric_id_2" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="metric_id" column="metric_id"/>
                        <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="lower_threshold" column="lower_threshold"/>
                        <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="upper_threshold" column="upper_threshold"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="anomaly_trigger" column="anomaly_trigger"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="enabled" column="enabled"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Dropped_Metrics">
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="viaops.anomaly.Dropped_Metrics" isClassRef="true">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="window_size" outputType="long" alias="window_size" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="window_step" outputType="long" alias="window_step" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="start_tm" outputType="long" alias="start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="end_tm" outputType="long" alias="end_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="generated_tm" outputType="long" alias="generated_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_id" outputType="string" alias="metric_id" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="dow" outputType="string" alias="dow" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="algorithm" outputType="string" alias="algorithm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="seasonality" outputType="string" alias="seasonality" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_metric" outputType="double" alias="aggr_metric" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="last_interval_metric" outputType="double" alias="last_interval_metric" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;ThresholdConfNotFound&quot;" outputType="string" alias="reason" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="base_metric_id" outputType="string" alias="base_metric_id" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="dim_keys" outputType="string" alias="dim_keys" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="dim_values" outputType="string" alias="dim_values" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="model_metric_id" outputType="string" alias="model_metric_id" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="1008_6" uuid="51a0f0b7-b93e-48d5-8935-3ce384bdd949" type="outPort" label="RawAnomaly" x="1280" y="40" width="100.703125" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="3330da40-6317-4c8c-8425-9c68accf5d57">
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm_name" label="algorithm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_median" label="baseline_median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev" label="baseline_stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad" label="baseline_mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_avg" label="baseline_avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stats" label="baseline_stats" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="zscore" label="zscore" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mzscore" label="mzscore" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="cscore" label="cscore" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="deviation" label="deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_score" label="upper_score" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_score" label="lower_score" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="conf_id" label="conf_id" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="trigger" label="trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="new_metric" label="new_metric" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="severity" label="severity" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="is_anomaly" label="is_anomaly" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="batch_tm" label="batch_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{}
</Properties>
                    </Model>
                </Node>
                <Node index="1008_7" uuid="e14c2183-7b49-4a8f-8013-26d4e657c2da" type="Router" label="Route enrich result" x="753" y="40" width="140" height="95">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Anomaly_Simple_Threshold_Join_CaseClass">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="0d58804b-406f-4079-8b63-782cf291cbd3">
                        <Field name="adm_name_2" label="adm_name_2" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="tid" label="tid" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="tid" column="tid"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="adm_name" column="adm_name"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="name" column="name"/>
                        <Field name="metric_id_2" label="metric_id_2" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="metric_id" column="metric_id"/>
                        <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="lower_threshold" column="lower_threshold"/>
                        <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="upper_threshold" column="upper_threshold"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="anomaly_trigger" column="anomaly_trigger"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="enabled" column="enabled"/>
                      </DataSource>
                    </Source>
                    <Output name="JoinedMetrics" uid="0" outputType="DStream" dataType="class:Anomaly_Simple_Threshold_Join_CaseClass">
                      <Field name="adm_name_2" label="adm_name_2" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="tid" label="tid" type="long" clazz="" isArray="false" isOptional="true" column="tid" wrapName="tid"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="true" column="adm_name" wrapName="adm_name"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true" column="name" wrapName="name"/>
                      <Field name="metric_id_2" label="metric_id_2" type="string" clazz="" isArray="false" isOptional="true" column="metric_id" wrapName="metric_id"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true" column="lower_threshold" wrapName="lower_threshold"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true" column="upper_threshold" wrapName="upper_threshold"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="true" column="anomaly_trigger" wrapName="anomaly_trigger"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="true" column="enabled" wrapName="enabled"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="DroppedMetrics" uid="2" outputType="DStream" dataType="class:Anomaly_Simple_Threshold_Join_CaseClass">
                      <Field name="adm_name_2" label="adm_name_2" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="tid" label="tid" type="long" clazz="" isArray="false" isOptional="true" column="tid" wrapName="tid"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="true" column="adm_name" wrapName="adm_name"/>
                      <Field name="name" label="name" type="string" clazz="" isArray="false" isOptional="true" column="name" wrapName="name"/>
                      <Field name="metric_id_2" label="metric_id_2" type="string" clazz="" isArray="false" isOptional="true" column="metric_id" wrapName="metric_id"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true" column="lower_threshold" wrapName="lower_threshold"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true" column="upper_threshold" wrapName="upper_threshold"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" clazz="" isArray="false" isOptional="true" column="anomaly_trigger" wrapName="anomaly_trigger"/>
                      <Field name="enabled" label="enabled" type="boolean" clazz="" isArray="false" isOptional="true" column="enabled" wrapName="enabled"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"sleExpressions":[{"_id":"c4cbdee7-5f9c-4b76-8ace-ddd357f8a964","sle":"","port":"","sleExpression":{"text":"isnotnull(metric_id_2)","type":"boolean","option":true},"label":"JoinedMetrics"},{"_id":"f3173327-6d05-4d99-8ba2-568b879d9862","sleExpression":{"text":"isnull(metric_id_2)","type":"boolean","option":true},"label":"DroppedMetrics"}]}
</Properties>
                    </Model>
                </Node>
                <Node index="1008_8" uuid="3330da40-6317-4c8c-8425-9c68accf5d57" type="Adhoc" label="Map Anomaly" x="1040" y="40" width="130" height="75">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:Anomaly_Simple_Threshold_Join_CaseClass">
                      <DataSource category="#OUTPUT" id="undefined" name="JoinedMetrics" nodeId="e14c2183-7b49-4a8f-8013-26d4e657c2da">
                        <Field name="adm_name_2" label="adm_name_2" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="tid" label="tid" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="tid" column="tid"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="adm_name" column="adm_name"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="name" column="name"/>
                        <Field name="metric_id_2" label="metric_id_2" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="metric_id" column="metric_id"/>
                        <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="lower_threshold" column="lower_threshold"/>
                        <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="upper_threshold" column="upper_threshold"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="anomaly_trigger" column="anomaly_trigger"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" wrapName="enabled" column="enabled"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly" referenceType="viaops.anomaly.Raw_Anomaly">
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm_name" label="algorithm_name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_median" label="baseline_median" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev" label="baseline_stdev" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad" label="baseline_mad" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_avg" label="baseline_avg" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stats" label="baseline_stats" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="zscore" label="zscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mzscore" label="mzscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="cscore" label="cscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="deviation" label="deviation" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_score" label="upper_score" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_score" label="lower_score" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="conf_id" label="conf_id" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="trigger" label="trigger" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="new_metric" label="new_metric" type="boolean" clazz="" isArray="false" isOptional="true"/>
                      <Field name="severity" label="severity" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="is_anomaly" label="is_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="batch_tm" label="batch_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model isDynamicSchema="false">
                      <Script><![CDATA[val gconf = com.vitria.viaops.ad.SolGlobalConf.getGlobalConfList("${name}", "${dataSource}", vtContext)
val retval = source1.vtMap(x => {
              val severity=
                           x.anomaly_trigger.getOrElse("").toLowerCase() match {
                             case "both" => if (x.aggr_metric > x.upper_threshold.getOrElse(Double.MaxValue) || x.aggr_metric < x.lower_threshold.getOrElse(Double.MinValue)) 0 else 10
                             case "upper" => if (x.aggr_metric > x.upper_threshold.getOrElse(Double.MaxValue)) 0 else 10
                             case "lower" => if (x.aggr_metric < x.lower_threshold.getOrElse(Double.MinValue)) 0 else 10
                             case _ => 10
                           }
              viaops.anomaly.Raw_Anomaly(  
                x.adm_name.getOrElse(""),
                x.name,
                x.window_size,
                x.window_step,
                x.start_tm,
                x.end_tm,
                System.currentTimeMillis()/1000,
                x.metric_id,
                x.dow,
                x.algorithm,
                x.aggr_metric,
                x.last_interval_metric,
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[String]],
                None.asInstanceOf[Option[String]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                x.lower_threshold,
                x.upper_threshold,
                Option((x.tid.getOrElse(0L)).toInt),
                x.anomaly_trigger,
                Option(false),
                severity,
                if (severity == 0) true else false,
                gconf.formatDateKey(x.adm_name.getOrElse(""), x.start_tm),
                x.base_metric_id,
                x.dim_keys,
                x.dim_values,
                Option(x.generated_tm)
              )}
        )
        
retval]]></Script>
                      <shellScript><![CDATA[{"global":"","custom_func":""}]]></shellScript>
                    </Model>
                </Node>
                <Node index="1008_9" uuid="94f951b5-5681-4c83-83da-8a83c3ca222d" type="outPort" label="DroppedMetrics" x="1271" y="170" width="114.703125" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Dropped_Metrics">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="9fcdff57-4b1c-4fd1-8d14-537364573e84">
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{}
</Properties>
                    </Model>
                </Node>
                <Node index="1008_10" uuid="56b9cec9-3680-43b9-8c6f-6c38ff58f56b" type="Filter" label="Filter by ADM name" x="231" y="140" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Anomaly_Threshold_Conf_CaseClass">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="758b5411-0cfc-4a4a-83b0-4075cc9f4d07">
                        <Field name="tid" label="tid" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false" column="tid" wrapName="tid"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                        <Field name="name" label="name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" column="name" wrapName="name"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" column="metric_id" wrapName="metric_id"/>
                        <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="true" column="lower_threshold" wrapName="lower_threshold"/>
                        <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="true" column="upper_threshold" wrapName="upper_threshold"/>
                        <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="true" column="anomaly_trigger" wrapName="anomaly_trigger"/>
                        <Field name="enabled" label="enabled" type="boolean" isDimension="false" isMeasure="false" isArray="false" isOptional="true" column="enabled" wrapName="enabled"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Anomaly_Threshold_Conf_CaseClass">
                      <Field name="tid" label="tid" type="long" isArray="false" isOptional="false" column="tid" wrapName="tid"/>
                      <Field name="adm_name" label="adm_name" type="string" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                      <Field name="name" label="name" type="string" isArray="false" isOptional="true" column="name" wrapName="name"/>
                      <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false" column="metric_id" wrapName="metric_id"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" isArray="false" isOptional="true" column="lower_threshold" wrapName="lower_threshold"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" isArray="false" isOptional="true" column="upper_threshold" wrapName="upper_threshold"/>
                      <Field name="anomaly_trigger" label="anomaly_trigger" type="string" isArray="false" isOptional="true" column="anomaly_trigger" wrapName="anomaly_trigger"/>
                      <Field name="enabled" label="enabled" type="boolean" isArray="false" isOptional="true" column="enabled" wrapName="enabled"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model filterModel="form" udfs="adm_in_list">
                      <Filters>
                        <Filter field="" op="sleText" arg="" value="" sleText="adm_in_list(adm_name, &apos;${name}&apos;)"/>
                      </Filters>
                    </Model>
                </Node>
                <Link srcId="56b9cec9-3680-43b9-8c6f-6c38ff58f56b" srcPort="out:0" tgtId="9babeaf0-9d34-451c-82f8-fa4845e455f4" tgtPort="in:0"/>
                <Link srcId="758b5411-0cfc-4a4a-83b0-4075cc9f4d07" srcPort="out:0" tgtId="56b9cec9-3680-43b9-8c6f-6c38ff58f56b" tgtPort="in:0"/>
                <Link srcId="3330da40-6317-4c8c-8425-9c68accf5d57" srcPort="dout:0" tgtId="51a0f0b7-b93e-48d5-8935-3ce384bdd949" tgtPort="in:0"/>
                <Link srcId="9fcdff57-4b1c-4fd1-8d14-537364573e84" srcPort="out:0" tgtId="94f951b5-5681-4c83-83da-8a83c3ca222d" tgtPort="in:0"/>
                <Link srcId="e14c2183-7b49-4a8f-8013-26d4e657c2da" srcPort="dout:0" tgtId="3330da40-6317-4c8c-8425-9c68accf5d57" tgtPort="din:0"/>
                <Link srcId="0d58804b-406f-4079-8b63-782cf291cbd3" srcPort="out:0" tgtId="e14c2183-7b49-4a8f-8013-26d4e657c2da" tgtPort="in:0"/>
                <Link srcId="e14c2183-7b49-4a8f-8013-26d4e657c2da" srcPort="dout:2" tgtId="9fcdff57-4b1c-4fd1-8d14-537364573e84" tgtPort="in:0"/>
                <Link srcId="68048ad8-3a52-4bd1-8e83-ed390aa609fc" srcPort="out:0" tgtId="0d58804b-406f-4079-8b63-782cf291cbd3" tgtPort="din:0"/>
                <Link srcId="9babeaf0-9d34-451c-82f8-fa4845e455f4" srcPort="dout:0" tgtId="0d58804b-406f-4079-8b63-782cf291cbd3" tgtPort="din:1"/>
      <Codes>
      </Codes>
      <Libraries>
          <Lib scope="system" systemPath="${VTBA_HOME}/VIAOps/libs/AnomalyDetection-1.0.jar"/>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"name","label":"Anomaly Detection Method Name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"_dataSourceSelector","*":{"label":"label","desc":"desc"},"name":"dataSource","label":"Anomaly Configuration Datasource","type":"object","hidden":"false","disabled":false,"resolveProperty":false,"value":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/viaops_config_db"},"constraints":{"type":"dataSource","args":{}},"enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"pull_rate","label":"Anomaly Configuration Poll Rate In Minutes","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"5","enumSource":"","runtimeControl":false}]</Properties>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"name":"","dataSource":"dataSource"}]]></__binding__>
            </Model>
        </Node>
        <Node index="1009" uuid="1b1ed3f5-5cf6-4b83-88d4-461edc9f9b91" type="subflow" label="Enrich MetricID" x="267" y="40" width="180" height="90">
            <Source name="TimeSeries" uid="0" outputType="DStream" dataType="String">
              <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="bfa5a694-bb0b-4843-8980-f81a653fe7af">
                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="EnrichedOut" uid="0" outputType="DStream" dataType="class:EnrichedTimeSeries">
              <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false"/>
              <Field name="model_metric_id" label="model_metric_id" type="string" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" isArray="false" isOptional="false"/>
              <Field name="app" label="app" type="string" isArray="false" isOptional="false"/>
              <Field name="metric_name" label="metric_name" type="string" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" isArray="false" isOptional="false"/>
              <Field name="aggr_func" label="aggr_func" type="string" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="double" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="int" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" isArray="false" isOptional="false"/>
              <Field name="payload" label="payload" type="string" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.anomaly/Enrich MetricID","admName":"${adm_name_m}","DataSource":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/viaops_config_db","databaseURL":"jdbc:mysql://master:3306/viaops_config_db?useSSL=false","userName":"root","password":"&lt;VxDl9gkoynEWjJWaic7avWuBiEORJXT9&gt;","driverType":"com.mysql.jdbc.Driver"},"TableName":"${p_system_model}","PollRate":"1","case":{"name":"EnrichedTimeSeries","ref":"false","userTyped":true}}
</Properties>
              <__subflow__>
              <Flow index="1009" uuid="Enrich MetricID" isNested="true" revision="1212" acceptedSourceTypes="DStream" referenceURI="remote:///viaops.anomaly/Enrich MetricID" name="Enrich MetricID" showFooter="true">
                <Node index="1009_1" uuid="bdb16439-089a-45ba-8e39-bf36d6bf35e0" type="inPort" label="TimeSeries" x="51" y="40" width="90.234375" height="40">
                    <Output name="Out" uid="0" outputType="DStream" dataType="String">
                      <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"*","type":{"name":"","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1009_2" uuid="3d2fc650-e58e-45eb-8263-e15531b48b4c" type="EnrichMetricID" label="Enrich MetricIDs" x="740" y="26" width="130" height="95">
                    <Source name="source1" uid="0" outputType="DStream" dataType="String">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="bdb16439-089a-45ba-8e39-bf36d6bf35e0">
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Source name="source2" uid="1" outputType="DStream" dataType="class:MetricIDs">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="0ce64573-3ff4-47fd-8ce4-913fb4cc3c4f">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="json_qdc" label="json_qdc" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="parse_target_group" label="parse_target_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:EnrichedTimeSeries">
                      <Field name="metric_id" label="metric_id" type="string" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="int" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" isArray="false" isOptional="false"/>
                      <Field name="payload" label="payload" type="string" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"parallelism":"4","case":{"name":"EnrichedTimeSeries","ref":"false","userTyped":true}}
</Properties>
                      <__binding__><![CDATA[{"output_class_name":"","enriched_case_class":"","${parallelism}":"${parallelism}","parallelism":"","case":"case"}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1009_3" uuid="c2e74603-8ca8-4ff0-8323-1f5a06127ed3" type="outPort" label="EnrichedOut" x="1020" y="74" width="96.703125" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:EnrichedTimeSeries">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="3d2fc650-e58e-45eb-8263-e15531b48b4c">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                        <Field name="app" label="app" type="string" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="double" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="int" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                        <Field name="payload" label="payload" type="string" isDimension="undefined" isMeasure="undefined" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{}
</Properties>
                    </Model>
                </Node>
                <Node index="1009_4" uuid="67776468-e82c-447e-8e71-07a28c01484a" type="Window" label="Metrics" x="226" y="108" width="130" height="135">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:MetricIDs">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="9298aa5e-7dad-4acd-839f-d31993506f1a">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="json_qdc" label="json_qdc" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="parse_target_group" label="parse_target_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="All" uid="0" outputType="DStream" dataType="class:MetricIDs">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="json_qdc" label="json_qdc" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_group" label="parse_target_group" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Changes" uid="1" outputType="DStream" dataType="class:MetricIDs">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="json_qdc" label="json_qdc" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_group" label="parse_target_group" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Expired" uid="2" outputType="DStream" dataType="class:MetricIDs">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="json_qdc" label="json_qdc" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_group" label="parse_target_group" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Deleted" uid="3" outputType="DStream" dataType="class:MetricIDs">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="json_qdc" label="json_qdc" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_group" label="parse_target_group" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model windowPolicy="attribute" partition="" checkpointInterval="/S" restoreState="false">
                      <Time mode="system">
                      </Time>
                      <GroupKeys policy="latest" numPerGroup="1">
                        <GroupKey field="metric_id"/>
                      </GroupKeys>
                      <Expirations duration="/N" baseline="lastevent">
                      </Expirations>
                    </Model>
                </Node>
                <Node index="1009_5" uuid="d3d4234d-0818-4932-83ca-3390e049d5f7" type="Adhoc" label="Load System Model" x="52" y="106" width="130" height="75">
                    <Output name="out" uid="0" outputType="DStream" dataType="class:MetricIDs" referenceType="MetricIDs">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="json_qdc" label="json_qdc" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_group" label="parse_target_group" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model isDynamicSchema="false">
                      <Schema>
                        <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false" wrapName="metric_id"/>
                        <Field name="sql_qdc" label="sql_qdc" type="string" clazz="" isArray="false" isOptional="false" wrapName="sql_qdc"/>
                        <Field name="json_qdc" label="json_qdc" type="string" clazz="" isArray="false" isOptional="false" wrapName="json_qdc"/>
                        <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false" wrapName="aggr_func"/>
                        <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_source_group"/>
                        <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_source_name"/>
                        <Field name="parse_target_group" label="parse_target_group" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_target_group"/>
                        <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_target_app"/>
                        <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_target_metric"/>
                        <Field name="modified_ts" label="modified_ts" type="datetime" clazz="" isArray="false" isOptional="false" wrapName="modified_ts"/>
                      </Schema>
                      <Script><![CDATA[   
  import com.vitria.spark.streaming.api.scala.VitriaDStreamPairFunctions._
  import org.apache.spark.streaming.dstream.DStream.toPairDStreamFunctions
  import org.apache.spark.streaming.dstream.VtJdbcDStream
  import org.apache.spark.util.jdbc.VitriaJdbcRDD
  import com.vitria.spark.jdbc.stream.VtJdbcQueryObject
  import com.vitria.spark.jdbc.stream.VTJdbcDStreamBuild
  import com.vitria.spark.jdbc.ConnectionSetting
  import com.vitria.spark.jdbc.QuerySetting
  import com.vitria.spark.jdbc.VtDBUtil
  import com.vitria.spark.jdbc.types.Java2Scala
  import com.vitria.spark.jdbc.VtParse
  import org.apache.spark.util.jdbc.VitriaJdbcRDD
  import java.util.UUID
  import com.vitria.spark.util.VtJsonParser
  import scala.collection.mutable.{ Map => MMap }
  import com.vitria.spark.jdbc.JdbcUtils
  import com.vitria.viaops.ad.DBUtils

  val schema = null
  val table = "${TableName}"
  val datasource = DBUtils.parseDatasource("${DataSource}").get("dataSource")

  def cs = {
import org.apache.spark.sql.rdbms.ConnectionSettingUtil
ConnectionSettingUtil.getOrCreate("custom_block_source_metric_ids", {
  val map = new java.util.HashMap[String, String]()
  map.put(javax.naming.Context.PROVIDER_URL, vtContext.getProperty("vitria.domain.provider.url"))
  map.put(javax.naming.Context.SECURITY_PRINCIPAL, vtContext.getProperty("vitria.domain.naming.user"))
  map.put(javax.naming.Context.SECURITY_CREDENTIALS, VtDBUtil.unencrypt(vtContext.getProperty("vitria.domain.naming.password")))
  val dsinfo = VtDBUtil.getDataSourceInfo(datasource, map)
  val url = dsinfo.get("url")
  val driver = dsinfo.get("driver")
  val user = dsinfo.get("user")
  val pwd = dsinfo.get("password")

  Class.forName(driver)
  val csf = new ConnectionSetting(driver, url, user, pwd)
  val connProps = new java.util.Properties()
  connProps.put("DomainServiceProviderURL", vtContext.getProperty("vitria.domain.provider.url"))
  connProps.put("vitria.domain.naming.user", vtContext.getProperty("vitria.domain.naming.user"))
  connProps.put("vitria.domain.naming.password", VtDBUtil.unencrypt(vtContext.getProperty("vitria.domain.naming.password")))
  csf.setProps(connProps)

  csf
})
  }

  val qs = new QuerySetting
  qs.setInc(false)

  qs.setDbType(VtDBUtil.getDBType(cs))

  var isAdvanced = true
  qs.setAdvanced(isAdvanced)
  if (isAdvanced) {
      val admSqlList = com.vitria.viaops.ADMUtils.admsToSQLList("${admName}")
val sql = """|SELECT ${TableName}.metric_id, ${TableName}.base_metric_id, ${TableName}.dim_keys, ${TableName}.dim_values,
         | ${TableName}.json_qdc, ${TableName}.aggr_func, ${TableName}.parse_target_group
         |FROM ${TableName} JOIN viaops_anomaly_algorithm 
         |   ON viaops_anomaly_algorithm.metric_id = ${TableName}.metric_id 
         |WHERE viaops_anomaly_algorithm.adm_name in """.stripMargin + admSqlList + """|
         | AND viaops_anomaly_algorithm.enabled""".stripMargin
qs.setAdvancedInitSQL(sql)
qs.setAdvancedIncSQL(null)
  } else {
qs.setSchema(null)
qs.setTable(null)
qs.setFilter(null)
  }

  qs.setColumns(Array(
("metric_id", null, "string", false),
("base_metric_id", null, "string", false),
("dim_keys", null, "string", false),
("dim_values", null, "string", false),
("json_qdc", null, "string", false),
("aggr_func", null, "string", false),
("parse_target_group", null, "string", false)))
  qs.setOrderKeys(Array())

  qs.setPollRate(${PollRate} * 60 * 1000L)
  qs.initlize

  val ss = VTJdbcDStreamBuild.jdbcDStream2(ssc, cs, qs)

  val retval = ss.flatMap { row =>

try {
  val vall = MetricIDs(
  Java2Scala.convert[String](row(0)), 
  Java2Scala.convert[String](row(1)), 
  Java2Scala.convert[String](row(2)), 
  Java2Scala.convert[String](row(3)),
  Java2Scala.convert[String](row(4)), 
  Java2Scala.convert[String](row(5)), 
  Java2Scala.convert[String](row(6)))
  Some(vall)
} catch {
  case e: Throwable => {
logger.warn("Ignore bad row " + row.mkString(", "), e)
None
  }
}
  }]]></Script>
                      <shellScript><![CDATA[{"global":"","custom_func":""}]]></shellScript>
                    </Model>
                </Node>
                <Node index="1009_7" uuid="4139c7a1-172b-4725-83b7-46eb0bc9a07e" type="JDBCStream" label="workaround" x="40" y="260" width="129" height="75">
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Enrich_Metric_ID_DS_WR_Class">
                      <Field name="adm_name" label="adm_name" type="string" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                      <Field name="window_size" label="window_size" type="long" isArray="false" isOptional="false" column="window_size" wrapName="window_size"/>
                      <Field name="anomaly_step_size" label="anomaly_step_size" type="long" isArray="false" isOptional="false" column="anomaly_step_size" wrapName="anomaly_step_size"/>
                      <Field name="value_field" label="value_field" type="string" isArray="false" isOptional="false" column="value_field" wrapName="value_field"/>
                      <Field name="source_table" label="source_table" type="string" isArray="false" isOptional="false" column="source_table" wrapName="source_table"/>
                      <Field name="timezone" label="timezone" type="string" isArray="false" isOptional="false" column="timezone" wrapName="timezone"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="jdbcStream" sourceType="jdbc" caseClass="Enrich_Metric_ID_DS_WR_Class" isClassRef="false" dataSpeed="" dataVolume="" dataSource="/vitria/m3o/datasource/DefaultDomain/viaops_config_db">
                      <__binding__><![CDATA[{"dataSource":"DataSource"}]]></__binding__>
                      <Schema>
                        <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false" wrapName="adm_name"/>
                        <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false" wrapName="window_size"/>
                        <Field name="anomaly_step_size" label="anomaly_step_size" type="long" clazz="" isArray="false" isOptional="false" wrapName="anomaly_step_size"/>
                        <Field name="value_field" label="value_field" type="string" clazz="" isArray="false" isOptional="false" wrapName="value_field"/>
                        <Field name="source_table" label="source_table" type="string" clazz="" isArray="false" isOptional="false" wrapName="source_table"/>
                        <Field name="timezone" label="timezone" type="string" clazz="" isArray="false" isOptional="false" wrapName="timezone"/>
                      </Schema>
                      <datasource name="/vitria/m3o/datasource/DefaultDomain/viaops_config_db"></datasource>
                      <query>
                      <table schema='viaops_config_db' defaultSchema='viaops_config_db' info='{"catalog":"viaops_config_db","name":"viaops_anomaly_sol","type":"TABLE"}'>viaops_anomaly_sol</table>
                      <columns>
                        <column>adm_name</column>
                        <column>window_size</column>
                        <column>anomaly_step_size</column>
                        <column>value_field</column>
                        <column>source_table</column>
                        <column>timezone</column>
                      </columns>
                      <growColumns>
                      </growColumns>
                      <filter>adm_name is null</filter>
                      <incremental>false</incremental>
                      </query>
                      <pollRate every='0/m' value='0'/>
                    </Model>
                </Node>
                <Node index="1009_8" uuid="48d81616-9ab0-4ef7-856a-2f6e064a6bf3" type="Filter" label="filter out all" x="200" y="260" width="78" height="74">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Enrich_Metric_ID_DS_WR_Class">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="4139c7a1-172b-4725-83b7-46eb0bc9a07e">
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="adm_name" column="adm_name"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="window_size" column="window_size"/>
                        <Field name="anomaly_step_size" label="anomaly_step_size" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="anomaly_step_size" column="anomaly_step_size"/>
                        <Field name="value_field" label="value_field" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="value_field" column="value_field"/>
                        <Field name="source_table" label="source_table" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="source_table" column="source_table"/>
                        <Field name="timezone" label="timezone" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="timezone" column="timezone"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Enrich_Metric_ID_DS_WR_Class">
                      <Field name="adm_name" label="adm_name" type="string" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                      <Field name="window_size" label="window_size" type="long" isArray="false" isOptional="false" column="window_size" wrapName="window_size"/>
                      <Field name="anomaly_step_size" label="anomaly_step_size" type="long" isArray="false" isOptional="false" column="anomaly_step_size" wrapName="anomaly_step_size"/>
                      <Field name="value_field" label="value_field" type="string" isArray="false" isOptional="false" column="value_field" wrapName="value_field"/>
                      <Field name="source_table" label="source_table" type="string" isArray="false" isOptional="false" column="source_table" wrapName="source_table"/>
                      <Field name="timezone" label="timezone" type="string" isArray="false" isOptional="false" column="timezone" wrapName="timezone"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model filterModel="form">
                      <Filters>
                        <Filter field="" op="sleText" arg="" value="" sleText="1=0"/>
                      </Filters>
                    </Model>
                </Node>
                <Node index="1009_9" uuid="9298aa5e-7dad-4acd-839f-d31993506f1a" type="Compute" label="align schema" x="300" y="260" width="117" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Enrich_Metric_ID_DS_WR_Class">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="48d81616-9ab0-4ef7-856a-2f6e064a6bf3">
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="adm_name" column="adm_name"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="window_size" column="window_size"/>
                        <Field name="anomaly_step_size" label="anomaly_step_size" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="anomaly_step_size" column="anomaly_step_size"/>
                        <Field name="value_field" label="value_field" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="value_field" column="value_field"/>
                        <Field name="source_table" label="source_table" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="source_table" column="source_table"/>
                        <Field name="timezone" label="timezone" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="timezone" column="timezone"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:MetricIDs">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="json_qdc" label="json_qdc" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_group" label="parse_target_group" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="MetricIDs" isClassRef="true">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="metric_id" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="base_metric_id" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="dim_keys" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="dim_values" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="json_qdc" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="aggr_func" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="parse_target_group" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="1009_10" uuid="0ce64573-3ff4-47fd-8ce4-913fb4cc3c4f" type="Adhoc" label="Print metric_id count" x="514" y="100" width="130" height="75">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:MetricIDs">
                      <DataSource category="#OUTPUT" id="undefined" name="All" nodeId="67776468-e82c-447e-8e71-07a28c01484a">
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="json_qdc" label="json_qdc" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="parse_target_group" label="parse_target_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:MetricIDs">
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="json_qdc" label="json_qdc" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="parse_target_group" label="parse_target_group" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model isDynamicSchema="false">
                      <Script><![CDATA[val retval = source1.vtTransform(rdd => {
    if (rdd != null) {
        logger_.info(s"""The count of the metrics in system model: ${rdd.count()}""")
    }
    rdd
})
]]></Script>
                    </Model>
                </Node>
                <Link srcId="67776468-e82c-447e-8e71-07a28c01484a" srcPort="dout:0" tgtId="0ce64573-3ff4-47fd-8ce4-913fb4cc3c4f" tgtPort="din:0"/>
                <Link srcId="0ce64573-3ff4-47fd-8ce4-913fb4cc3c4f" srcPort="dout:0" tgtId="3d2fc650-e58e-45eb-8263-e15531b48b4c" tgtPort="in:1"/>
                <Link srcId="4139c7a1-172b-4725-83b7-46eb0bc9a07e" srcPort="out:0" tgtId="48d81616-9ab0-4ef7-856a-2f6e064a6bf3" tgtPort="in:0"/>
                <Link srcId="d3d4234d-0818-4932-83ca-3390e049d5f7" srcPort="dout:0" tgtId="67776468-e82c-447e-8e71-07a28c01484a" tgtPort="in:0"/>
                <Link srcId="bdb16439-089a-45ba-8e39-bf36d6bf35e0" srcPort="out:0" tgtId="3d2fc650-e58e-45eb-8263-e15531b48b4c" tgtPort="in:0"/>
                <Link srcId="3d2fc650-e58e-45eb-8263-e15531b48b4c" srcPort="out:0" tgtId="c2e74603-8ca8-4ff0-8323-1f5a06127ed3" tgtPort="in:0"/>
                <Link srcId="48d81616-9ab0-4ef7-856a-2f6e064a6bf3" srcPort="out:0" tgtId="9298aa5e-7dad-4acd-839f-d31993506f1a" tgtPort="in:0"/>
                <Link srcId="9298aa5e-7dad-4acd-839f-d31993506f1a" srcPort="out:0" tgtId="67776468-e82c-447e-8e71-07a28c01484a" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"admName","label":"Anomaly Detection Method Name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"_dataSourceSelector","*":{"label":"label","desc":"desc"},"name":"DataSource","label":"System Model Datasource","type":"object","hidden":"false","disabled":false,"resolveProperty":false,"value":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/viaops_config_db","databaseURL":"jdbc:mysql://10.101.3.186:3306/viaops_config_db","userName":"root","password":"&lt;j4dg2AZTL6lo1Xhtca&gt;","driverType":"com.mysql.jdbc.Driver"},"constraints":{"type":"dataSource","args":{}},"enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"TableName","label":"System Model Table Name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_metric_qdc","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"PollRate","label":"Poll Rate (Minutes)","type":"long","hidden":"false","disabled":false,"resolveProperty":false,"value":1,"enumSource":"","runtimeControl":false},{"name":"case","label":"Case Class","type":"object","excluded":true,"impactSchema":true,"constraints":"caseClass","value":{"name":"EnrichedTimeSeries","ref":"false","userTyped":true},"editorType":"caseClass","group":"common","*":{"label":"label","desc":"desc"},"runtimeControl":false}]</Properties>
      <Types>[{"name":"MetricIDs","namespace":"","schema":[{"name":"metric_id","type":"string","_isOptional":false,"_isArray":false},{"name":"base_metric_id","type":"string","_isOptional":false,"_isArray":false},{"name":"dim_keys","type":"string","_isOptional":false,"_isArray":false},{"name":"dim_values","type":"string","_isOptional":false,"_isArray":false},{"name":"json_qdc","type":"string","_isOptional":false,"_isArray":false},{"name":"aggr_func","type":"string","_isOptional":false,"_isArray":false},{"name":"parse_target_group","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"dataSource":"dataSource"}]]></__binding__>
            </Model>
        </Node>
        <Node index="1010" uuid="a7609310-7f78-4c5e-83ee-4517df4afbe7" type="StreamTarget" label="Incident HDFS" x="1510" y="40" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="9fe5fa8b-9bb3-45ed-84ef-4f81d83a270e">
                <Field name="adm_name" label="adm_name" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="algorithm_name" label="algorithm_name" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="window_size" label="window_size" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="window_step" label="window_step" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="generated_tm" label="generated_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="dow" label="dow" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="algorithm" label="algorithm" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_median" label="baseline_median" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_stdev" label="baseline_stdev" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_mad" label="baseline_mad" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_avg" label="baseline_avg" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="median_baseline" label="median_baseline" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="baseline_stats" label="baseline_stats" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="score_method" label="score_method" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="zscore" label="zscore" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="mzscore" label="mzscore" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="cscore" label="cscore" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="deviation" label="deviation" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="upper_score" label="upper_score" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="lower_score" label="lower_score" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="conf_id" label="conf_id" type="integer" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="trigger" label="trigger" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="new_metric" label="new_metric" type="boolean" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
                <Field name="severity" label="severity" type="integer" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="is_anomaly" label="is_anomaly" type="boolean" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="date_key" label="date_key" type="integer" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_values" label="dim_values" type="string" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="false"/>
                <Field name="batch_tm" label="batch_tm" type="long" isDimension="undefined" isMeasure="undefined" clazz="" isArray="false" isOptional="true"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
              <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm_name" label="algorithm_name" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_median" label="baseline_median" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev" label="baseline_stdev" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad" label="baseline_mad" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_avg" label="baseline_avg" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stats" label="baseline_stats" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="zscore" label="zscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="mzscore" label="mzscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="cscore" label="cscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="deviation" label="deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="upper_score" label="upper_score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="lower_score" label="lower_score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="conf_id" label="conf_id" type="integer" clazz="" isArray="false" isOptional="true"/>
              <Field name="trigger" label="trigger" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="new_metric" label="new_metric" type="boolean" clazz="" isArray="false" isOptional="true"/>
              <Field name="severity" label="severity" type="integer" clazz="" isArray="false" isOptional="false"/>
              <Field name="is_anomaly" label="is_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="batch_tm" label="batch_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model type="file" url="${incident_url}" namePrefix="${incident_file_prefix}" format="json" partitionNum="1" dataSpeed="" dataVolume="">
            </Model>
        </Node>
        <Node index="1011" uuid="26f11f6b-4a61-456c-8744-d0d7c23b671e" type="Compute" label="Add UTC date_key" x="1306" y="290" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Dropped_Metrics">
              <DataSource category="#OUTPUT" id="undefined" name="DroppedMetrics" nodeId="bb5ab448-037b-4547-8a32-9de419a928a1">
                <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="reason" label="reason" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:AddUTCdate_key_Class">
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="reason" label="reason" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="AddUTCdate_key_Class" isClassRef="false">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="window_size" outputType="long" alias="window_size" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="window_step" outputType="long" alias="window_step" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="start_tm" outputType="long" alias="start_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="end_tm" outputType="long" alias="end_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="generated_tm" outputType="long" alias="generated_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="metric_id" outputType="string" alias="metric_id" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="dow" outputType="string" alias="dow" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="algorithm" outputType="string" alias="algorithm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="seasonality" outputType="string" alias="seasonality" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="aggr_metric" outputType="double" alias="aggr_metric" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="last_interval_metric" outputType="double" alias="last_interval_metric" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="reason" outputType="string" alias="reason" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="base_metric_id" outputType="string" alias="base_metric_id" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="dim_keys" outputType="string" alias="dim_keys" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="dim_values" outputType="string" alias="dim_values" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="model_metric_id" outputType="string" alias="model_metric_id" wordWarp="true"/>
                <Compute op="sleText" field="" arg="" value="cast(format_date(from_unixtime_millisec(start_tm* 1000), &quot;yyyyMMdd&quot;, &quot;UTC&quot;), &quot;int&quot;)" outputType="integer" alias="date_key" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="true"/>
            </Model>
        </Node>
        <Node index="1013" uuid="cdd60428-52e9-4e8c-8c63-9ba685144f37" type="subflow" label="Map To Anomaly" x="1070" y="200" width="140" height="75">
            <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
              <DataSource category="#OUTPUT" id="undefined" name="ignored" nodeId="727dd54e-99ce-4e82-89d2-51646aa97d55">
                <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="RawAnomaly" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
              <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm_name" label="algorithm_name" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_median" label="baseline_median" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev" label="baseline_stdev" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad" label="baseline_mad" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_avg" label="baseline_avg" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="baseline_stats" label="baseline_stats" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="zscore" label="zscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="mzscore" label="mzscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="cscore" label="cscore" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="deviation" label="deviation" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="upper_score" label="upper_score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="lower_score" label="lower_score" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
              <Field name="conf_id" label="conf_id" type="integer" clazz="" isArray="false" isOptional="true"/>
              <Field name="trigger" label="trigger" type="string" clazz="" isArray="false" isOptional="true"/>
              <Field name="new_metric" label="new_metric" type="boolean" clazz="" isArray="false" isOptional="true"/>
              <Field name="severity" label="severity" type="integer" clazz="" isArray="false" isOptional="false"/>
              <Field name="is_anomaly" label="is_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
              <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="batch_tm" label="batch_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.anomaly/Map To Anomaly","name":"${adm_name_m}","dataSource":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/viaops_config_db","databaseURL":"jdbc:mysql://master:3306/viaops_config_db?useSSL=false","userName":"root","password":"&lt;tRKambKPADvZu3cnpOsmo62YHXSo&gt;","driverType":"com.mysql.jdbc.Driver"}}
</Properties>
              <__subflow__>
              <Flow index="1013" uuid="Map To Anomaly" isNested="true" revision="592" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.anomaly/Map To Anomaly" name="Map To Anomaly" showFooter="true">
                <Node index="1013_1" uuid="223eca2d-70cf-4766-8c74-e73d1cbff340" type="inPort" label="In" x="140" y="80" width="70" height="40">
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics" referenceType="viaops.anomaly.Aggr_Metrics">
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="seasonality" label="seasonality" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="model_metric_id" label="model_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.anomaly.Aggr_Metrics","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1013_2" uuid="bbb23109-7b0e-441f-89c5-6e12b8ccae14" type="outPort" label="RawAnomaly" x="640" y="80" width="100.703125" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly">
                      <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="07c22625-8346-4703-8f39-26b7ee9d5565">
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm_name" label="algorithm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_median" label="baseline_median" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev" label="baseline_stdev" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad" label="baseline_mad" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_avg" label="baseline_avg" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="median_baseline" label="median_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mean_baseline" label="mean_baseline" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="baseline_stats" label="baseline_stats" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="score_method" label="score_method" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="zscore" label="zscore" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="mzscore" label="mzscore" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="cscore" label="cscore" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="deviation" label="deviation" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_score" label="upper_score" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_score" label="lower_score" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="lower_threshold" label="lower_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="upper_threshold" label="upper_threshold" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="conf_id" label="conf_id" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="trigger" label="trigger" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="new_metric" label="new_metric" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="severity" label="severity" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="is_anomaly" label="is_anomaly" type="boolean" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="integer" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="batch_tm" label="batch_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{}
</Properties>
                    </Model>
                </Node>
                <Node index="1013_3" uuid="5eb6d90e-4de0-41a8-8d68-911c7fe38d5e" type="JDBCStream" label="Wordaround datasource issue" x="166" y="160" width="130" height="75">
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Map_Anomaly_Workaround_Case_Class">
                      <Field name="adm_name" label="adm_name" type="string" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                      <Field name="window_size" label="window_size" type="long" isArray="false" isOptional="false" column="window_size" wrapName="window_size"/>
                      <Field name="anomaly_step_size" label="anomaly_step_size" type="long" isArray="false" isOptional="false" column="anomaly_step_size" wrapName="anomaly_step_size"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="jdbcStream" sourceType="jdbc" caseClass="Map_Anomaly_Workaround_Case_Class" isClassRef="false" dataSpeed="" dataVolume="" dataSource="/vitria/m3o/datasource/DefaultDomain/viaops_config_db">
                      <__binding__><![CDATA[{"dataSource":"dataSource"}]]></__binding__>
                      <Schema>
                        <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false" wrapName="adm_name"/>
                        <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false" wrapName="window_size"/>
                        <Field name="anomaly_step_size" label="anomaly_step_size" type="long" clazz="" isArray="false" isOptional="false" wrapName="anomaly_step_size"/>
                        <Field name="value_field" label="value_field" type="string" clazz="" isArray="false" isOptional="false" wrapName="value_field"/>
                        <Field name="source_table" label="source_table" type="string" clazz="" isArray="false" isOptional="false" wrapName="source_table"/>
                        <Field name="timezone" label="timezone" type="string" clazz="" isArray="false" isOptional="false" wrapName="timezone"/>
                      </Schema>
                      <datasource name="/vitria/m3o/datasource/DefaultDomain/viaops_config_db"></datasource>
                      <query>
                      <table schema='viaops_config_db' defaultSchema='viaops_config_db' info='{"catalog":"viaops_config_db","name":"viaops_anomaly_sol","type":"TABLE"}'>viaops_anomaly_sol</table>
                      <columns>
                        <column>adm_name</column>
                        <column>window_size</column>
                        <column>anomaly_step_size</column>
                      </columns>
                      <growColumns>
                      </growColumns>
                      <filter/>
                      <incremental>false</incremental>
                      </query>
                      <pollRate every='0/m' value='0'/>
                    </Model>
                </Node>
                <Node index="1013_4" uuid="e59c9d79-c805-42bb-8f58-5d0546493042" type="Adhoc" label="A fake target" x="360" y="151" width="130" height="75">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:Map_Anomaly_Workaround_Case_Class">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="5eb6d90e-4de0-41a8-8d68-911c7fe38d5e">
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false" column="window_size" wrapName="window_size"/>
                        <Field name="anomaly_step_size" label="anomaly_step_size" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false" column="anomaly_step_size" wrapName="anomaly_step_size"/>
                      </DataSource>
                    </Source>
                    <Output name="Out1" uid="0" outputType="DStream" dataType="class:Map_Anomaly_Workaround_Case_Class" referenceType="Map_Anomaly_Workaround_Case_Class">
                      <Field name="adm_name" label="adm_name" type="string" isArray="false" isOptional="false" column="adm_name" wrapName="adm_name"/>
                      <Field name="window_size" label="window_size" type="long" isArray="false" isOptional="false" column="window_size" wrapName="window_size"/>
                      <Field name="anomaly_step_size" label="anomaly_step_size" type="long" isArray="false" isOptional="false" column="anomaly_step_size" wrapName="anomaly_step_size"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[source1.foreachRDD(rdd => rdd.foreach(_ => Unit))
val retval = source1]]></Script>
                    </Model>
                </Node>
                <Node index="1013_5" uuid="07c22625-8346-4703-8f39-26b7ee9d5565" type="Adhoc" label="Map to Anomaly" x="360" y="60" width="130" height="75">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Aggr_Metrics">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="223eca2d-70cf-4766-8c74-e73d1cbff340">
                        <Field name="window_size" label="window_size" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="window_step" label="window_step" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="start_tm" label="start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="end_tm" label="end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_id" label="metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dow" label="dow" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="algorithm" label="algorithm" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="seasonality" label="seasonality" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="aggr_metric" label="aggr_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="last_interval_metric" label="last_interval_metric" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="generated_tm" label="generated_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="base_metric_id" label="base_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_keys" label="dim_keys" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="dim_values" label="dim_values" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="model_metric_id" label="model_metric_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="adm_name" label="adm_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out1" uid="0" outputType="DStream" dataType="class:viaops.anomaly.Raw_Anomaly" referenceType="viaops.anomaly.Raw_Anomaly">
                      <Field name="adm_name" label="adm_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm_name" label="algorithm_name" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="window_size" label="window_size" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="window_step" label="window_step" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="start_tm" label="start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="end_tm" label="end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="generated_tm" label="generated_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dow" label="dow" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="algorithm" label="algorithm" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_metric" label="aggr_metric" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="last_interval_metric" label="last_interval_metric" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_median" label="baseline_median" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev" label="baseline_stdev" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad" label="baseline_mad" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_hly" label="baseline_stdev_hly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_hly" label="baseline_mad_hly" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_wkl" label="baseline_stdev_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_wkl" label="baseline_mad_wkl" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stdev_wkh" label="baseline_stdev_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_mad_wkh" label="baseline_mad_wkh" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_avg" label="baseline_avg" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="median_baseline" label="median_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mean_baseline" label="mean_baseline" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="baseline_stats" label="baseline_stats" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="score_method" label="score_method" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="zscore" label="zscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="mzscore" label="mzscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="cscore" label="cscore" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="deviation" label="deviation" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_score" label="upper_score" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_score" label="lower_score" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="lower_threshold" label="lower_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="upper_threshold" label="upper_threshold" type="double" clazz="" isArray="false" isOptional="true"/>
                      <Field name="conf_id" label="conf_id" type="integer" clazz="" isArray="false" isOptional="true"/>
                      <Field name="trigger" label="trigger" type="string" clazz="" isArray="false" isOptional="true"/>
                      <Field name="new_metric" label="new_metric" type="boolean" clazz="" isArray="false" isOptional="true"/>
                      <Field name="severity" label="severity" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="is_anomaly" label="is_anomaly" type="boolean" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="integer" clazz="" isArray="false" isOptional="false"/>
                      <Field name="base_metric_id" label="base_metric_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_keys" label="dim_keys" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="dim_values" label="dim_values" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="batch_tm" label="batch_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[val gconf = com.vitria.viaops.ad.SolGlobalConf.getGlobalConfList("${name}", "${dataSource}", vtContext)
val retval = source1.vtMap(x => {
              viaops.anomaly.Raw_Anomaly(  
                x.adm_name,
                None,
                x.window_size,
                x.window_step,
                x.start_tm,
                x.end_tm,
                System.currentTimeMillis()/1000,
                x.metric_id,
                x.dow,
                x.algorithm,
                x.aggr_metric,
                x.last_interval_metric,
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[String]],
                None.asInstanceOf[Option[String]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Double]],
                None.asInstanceOf[Option[Int]],
                None.asInstanceOf[Option[String]],
                Option(false),
                1000,
                false,
                gconf.formatDateKey(x.adm_name, x.start_tm),
                x.base_metric_id,
                x.dim_keys,
                x.dim_values,
                Option(x.generated_tm)
              )})]]></Script>
                    </Model>
                </Node>
                <Link srcId="223eca2d-70cf-4766-8c74-e73d1cbff340" srcPort="out:0" tgtId="07c22625-8346-4703-8f39-26b7ee9d5565" tgtPort="din:0"/>
                <Link srcId="5eb6d90e-4de0-41a8-8d68-911c7fe38d5e" srcPort="out:0" tgtId="e59c9d79-c805-42bb-8f58-5d0546493042" tgtPort="din:0"/>
                <Link srcId="07c22625-8346-4703-8f39-26b7ee9d5565" srcPort="dout:0" tgtId="bbb23109-7b0e-441f-89c5-6e12b8ccae14" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"name","label":"Anomaly Detection Method Name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"name":"dataSource","label":"Anomaly Configuration Datasource","type":"object","constraints":{"type":"dataSource","args":{}},"editorID":"_dataSourceSelector","value":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/viaops_config_db"},"editorType":"_dataSourceSelector","runtimeControl":false}]</Properties>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"name":"","dataSource":"dataSource"}]]></__binding__>
            </Model>
        </Node>
        <Link srcId="727dd54e-99ce-4e82-89d2-51646aa97d55" srcPort="dout:3" tgtId="cdd60428-52e9-4e8c-8c63-9ba685144f37" tgtPort="din:0"/>
        <Link srcId="26f11f6b-4a61-456c-8744-d0d7c23b671e" srcPort="out:0" tgtId="381f3a4e-83a8-4774-8e14-b92b69275f89" tgtPort="in:0"/>
        <Link srcId="9d55632e-3d68-4d3d-80fb-3ec12f8041a4" srcPort="dout:0" tgtId="9fe5fa8b-9bb3-45ed-84ef-4f81d83a270e" tgtPort="din:0"/>
        <Link srcId="9fe5fa8b-9bb3-45ed-84ef-4f81d83a270e" srcPort="dout:0" tgtId="a7609310-7f78-4c5e-83ee-4517df4afbe7" tgtPort="in:0"/>
        <Link srcId="1b1ed3f5-5cf6-4b83-88d4-461edc9f9b91" srcPort="dout:0" tgtId="32acad17-e402-4692-8352-9c8b956bf1c4" tgtPort="din:0"/>
        <Link srcId="727dd54e-99ce-4e82-89d2-51646aa97d55" srcPort="dout:1" tgtId="9d55632e-3d68-4d3d-80fb-3ec12f8041a4" tgtPort="din:0"/>
        <Link srcId="32acad17-e402-4692-8352-9c8b956bf1c4" srcPort="dout:1" tgtId="54a00937-cda3-4fcb-816f-99f01118897b" tgtPort="in:0"/>
        <Link srcId="32acad17-e402-4692-8352-9c8b956bf1c4" srcPort="dout:0" tgtId="727dd54e-99ce-4e82-89d2-51646aa97d55" tgtPort="in:0"/>
        <Link srcId="727dd54e-99ce-4e82-89d2-51646aa97d55" srcPort="dout:0" tgtId="bb5ab448-037b-4547-8a32-9de419a928a1" tgtPort="din:0"/>
        <Link srcId="bb5ab448-037b-4547-8a32-9de419a928a1" srcPort="dout:0" tgtId="9fe5fa8b-9bb3-45ed-84ef-4f81d83a270e" tgtPort="din:0"/>
        <Link srcId="9d55632e-3d68-4d3d-80fb-3ec12f8041a4" srcPort="dout:1" tgtId="26f11f6b-4a61-456c-8744-d0d7c23b671e" tgtPort="in:0"/>
        <Link srcId="bb5ab448-037b-4547-8a32-9de419a928a1" srcPort="dout:1" tgtId="26f11f6b-4a61-456c-8744-d0d7c23b671e" tgtPort="in:0"/>
        <Link srcId="bfa5a694-bb0b-4843-8980-f81a653fe7af" srcPort="dout:0" tgtId="1b1ed3f5-5cf6-4b83-88d4-461edc9f9b91" tgtPort="din:0"/>
        <Link srcId="cdd60428-52e9-4e8c-8c63-9ba685144f37" srcPort="dout:0" tgtId="9fe5fa8b-9bb3-45ed-84ef-4f81d83a270e" tgtPort="din:0"/>
      <Codes>
      </Codes>
      <Libraries>
          <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/com/vitria/driver/main/mysql-connector-java-*-bin.jar"/>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"name":"dataSource","label":"Anomaly Configuration Datasource","type":"object","editorID":"_dataSourceSelector","value":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/viaops_config_db","databaseURL":"jdbc:mysql://master:3306/viaops_config_db?useSSL=false","userName":"root","password":"&lt;RRVb7XGcD!xcoYBtMQOYa!eHTLC@3B&gt;","driverType":"com.mysql.jdbc.Driver"},"editorType":"_dataSourceSelector","runtimeControl":false,"constraints":{"type":"dataSource","args":{}}},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"pull_r","label":"Anomaly Configuration Poll Rate in Minutes","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"5","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"s_date","label":"Start Date","type":"string","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"value":" ","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"adm_name_m","label":"Anomaly Detection Method Name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"myservice-5/5","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"m_source","label":"Metric Source","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"hdfs://master/anomaly/myservice","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"incident_url","label":"Incident Target","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"hdfs://master/incident/myservice","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"incident_file_prefix","label":"Incident File Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"myservice-5min","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"dropped_metric","label":"Dropped Source Metric","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"myservice_mysource_metric_dropped","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"anomaly","label":"Anomaly Table Name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"myservice_metric_history","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"dropped_aggr_metrics","label":"Dropped Aggregated Metrics","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"myservice_audit_anomaly_dropped","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"baseline_table_name","label":"Baseline Table Name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_baseline","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"override_baseline_table_name","label":"Override Baseline Table Name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_override_baseline","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"percentile","label":"Percentile Table Name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_percentile","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"statistic","label":"Statistic Table Name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_statistics","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"p_system_model","label":"System Model Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_metric_qdc","enumSource":"","runtimeControl":false},{"editorType":"sparkSelect","*":{"label":"label","desc":"desc","options.dow":"constraints.args.options.0.label","options.ww":"constraints.args.options.1.label","options. ":"constraints.args.options.2.label"},"group":"common","name":"Baseline_Seasonality","label":"Baseline Seasonality","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":" ","runtimeControl":false,"constraints":{"type":"sparkSelect","args":{"options":[{"label":"Day Of Week","value":"dow"},{"label":"Weekday Weekend","value":"ww"},{"label":"Default","value":" "}],"needPlaceholder":true,"multiple":false,"url":"http://10.101.7.163:18080/vitria-oi/rest/app/spark/space/VIAOps Anomaly/sparkm/VIAOps - Baseline Anomaly Detection","_cid":"6b0943f6-c375-4e54-8ee9-68ed891d5129","name":"defaultValueForExisted"}}}]</Properties>
      </Flow>
    </Flows>
  </ModelInfo>
</DataPipeModel>