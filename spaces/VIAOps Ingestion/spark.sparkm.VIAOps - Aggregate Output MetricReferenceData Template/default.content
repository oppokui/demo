<DataPipeModel description="It contains 3 ADF subflow:&#x000A;1. Aggregate over event-time jumping window&#x000A;2. Store metric output into SparkSQL and HDFS&#x000A;3. Metric&apos;s reference data for filtering and enrichment purpose " name="VIAOps - Aggregate Output MetricReferenceData Template" editBy="flow" is_init="false" useStreaming="auto" durableStreaming="false" streamingAutoStart="true" useHive="auto" batchDuration="P1M" checkpoint="" batchSampling="true" sparkMasterHost="">
  <HiveConfig>
    <Properties>
      <Property name="hive.warehouse.hdfs.source" value=""/>
      <Property name="hive.metastore.data.source" value=""/>
      <Property name="hive.server2.thrift.port" value=""/>
      <Property name="hive.db.schema" value=""/>
    </Properties>
  </HiveConfig>
  <ModelInfo validated="true">
    <Pipes>
      <Pipe index="1000" uuid="" name="(main)">
      </Pipe>
    </Pipes>
    <Flows>
      <Flow index="1000" uuid="Main" isNested="false" revision="2" name="Main" showFooter="true">
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[]</Properties>
      </Flow>
      <Flow index="2000" uuid="Aggregate" isNested="true" revision="1810" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="local://AggregateTemplate" registered="true" subflowPath="viaops.ingestion" name="Aggregate" showFooter="true">
        <Node index="2001" uuid="e83941c2-c6d7-4806-8336-691f792d1fde" type="inPort" label="source1" x="100" y="70" width="72.703125" height="40">
            <Output name="out" uid="0" outputType="*" dataType="class:FilterEventsofInterest_Class">
              <Field name="datekey" label="datekey" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="status" label="status" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="severity" label="severity" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="SERVICE" label="SERVICE" type="string" clazz="" isArray="false" isOptional="false" column="SERVICE"/>
              <Field name="COMPONENT" label="COMPONENT" type="string" clazz="" isArray="false" isOptional="false" column="COMPONENT"/>
              <Field name="METRIC_SOURCE" label="METRIC_SOURCE" type="string" clazz="" isArray="false" isOptional="false" column="METRIC_SOURCE"/>
              <Field name="SOURCE_METRIC_NAME" label="SOURCE_METRIC_NAME" type="string" clazz="" isArray="false" isOptional="false" column="SOURCE_METRIC_NAME"/>
              <Field name="METRIC_NAME" label="METRIC_NAME" type="string" clazz="" isArray="false" isOptional="false" column="METRIC_NAME"/>
              <Field name="METRIC_UOM" label="METRIC_UOM" type="string" clazz="" isArray="false" isOptional="false" column="METRIC_UOM"/>
              <Field name="METRIC_UOM_LABEL" label="METRIC_UOM_LABEL" type="string" clazz="" isArray="false" isOptional="false" column="METRIC_UOM_LABEL"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"portType":"*"}
</Properties>
            </Model>
        </Node>
        <Node index="2002" uuid="6783797e-0f4f-49c2-81b7-50906d504046" type="Aggregate" label="Count 5 minutes" x="232" y="50" width="130" height="95">
            <Source name="source" uid="0" outputType="DStream" dataType="class:FilterEventsofInterest_Class">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="e83941c2-c6d7-4806-8336-691f792d1fde">
                <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="status" label="status" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="severity" label="severity" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="SERVICE" label="SERVICE" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="SERVICE"/>
                <Field name="COMPONENT" label="COMPONENT" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="COMPONENT"/>
                <Field name="METRIC_SOURCE" label="METRIC_SOURCE" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_SOURCE"/>
                <Field name="SOURCE_METRIC_NAME" label="SOURCE_METRIC_NAME" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="SOURCE_METRIC_NAME"/>
                <Field name="METRIC_NAME" label="METRIC_NAME" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_NAME"/>
                <Field name="METRIC_UOM" label="METRIC_UOM" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_UOM"/>
                <Field name="METRIC_UOM_LABEL" label="METRIC_UOM_LABEL" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_UOM_LABEL"/>
              </DataSource>
            </Source>
            <Output name="Out" uid="0" outputType="DStream" dataType="(Long,Long,Long)">
              <Field name="_vt_time" label="_vt_time" type="long" isArray="false" isOptional="false"/>
              <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Output name="Dropped" uid="1" outputType="DStream" dataType="class:FilterEventsofInterest_Class">
              <Field name="datekey" label="datekey" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="status" label="status" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="severity" label="severity" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="SERVICE" label="SERVICE" type="string" clazz="" isArray="false" isOptional="false" column="SERVICE"/>
              <Field name="COMPONENT" label="COMPONENT" type="string" clazz="" isArray="false" isOptional="false" column="COMPONENT"/>
              <Field name="METRIC_SOURCE" label="METRIC_SOURCE" type="string" clazz="" isArray="false" isOptional="false" column="METRIC_SOURCE"/>
              <Field name="SOURCE_METRIC_NAME" label="SOURCE_METRIC_NAME" type="string" clazz="" isArray="false" isOptional="false" column="SOURCE_METRIC_NAME"/>
              <Field name="METRIC_NAME" label="METRIC_NAME" type="string" clazz="" isArray="false" isOptional="false" column="METRIC_NAME"/>
              <Field name="METRIC_UOM" label="METRIC_UOM" type="string" clazz="" isArray="false" isOptional="false" column="METRIC_UOM"/>
              <Field name="METRIC_UOM_LABEL" label="METRIC_UOM_LABEL" type="string" clazz="" isArray="false" isOptional="false" column="METRIC_UOM_LABEL"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="" isClassRef="false">
              <Measures>
                <Measure type="count" field="" asName="count"/>
                <Measure type="window_end_time" field="" asName="aggr_end_tm"/>
              </Measures>
              <Window enable="true" size="5/N"  step="5/N" timeMode="event" outputCondition="changes">
                <EventTime field="ts"/>
              </Window>
              <__binding__><![CDATA[{"windowSetting":"windowSetting","timeSetting":"timeSetting","dimensions":"dimensions","measures":"measures"}]]></__binding__>
              <__binding__><![CDATA[{"windowSetting":"windowSetting","timeSetting":"timeSetting","dimensions":"dimensions","measures":"measures"}]]></__binding__>
            </Model>
        </Node>
        <Node index="2003" uuid="328fbd82-fdae-41c6-8c16-c241c5f6da38" type="Aggregate" label="Count Dropped Events" x="426" y="140" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:FilterEventsofInterest_Class">
              <DataSource category="#OUTPUT" id="undefined" name="Dropped" nodeId="6783797e-0f4f-49c2-81b7-50906d504046">
                <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="status" label="status" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="severity" label="severity" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="SERVICE" label="SERVICE" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="SERVICE"/>
                <Field name="COMPONENT" label="COMPONENT" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="COMPONENT"/>
                <Field name="METRIC_SOURCE" label="METRIC_SOURCE" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_SOURCE"/>
                <Field name="SOURCE_METRIC_NAME" label="SOURCE_METRIC_NAME" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="SOURCE_METRIC_NAME"/>
                <Field name="METRIC_NAME" label="METRIC_NAME" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_NAME"/>
                <Field name="METRIC_UOM" label="METRIC_UOM" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_UOM"/>
                <Field name="METRIC_UOM_LABEL" label="METRIC_UOM_LABEL" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_UOM_LABEL"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="(Long,Long)">
              <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
              <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="" isClassRef="false">
              <Measures>
                <Measure type="count" field="" asName="count"/>
                <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
              </Measures>
              <Window enable="false" />
            </Model>
        </Node>
        <Node index="2004" uuid="77779a47-2c4b-4aed-8f85-cf080f562555" type="Aggregate" label="Get earliest event time" x="427" y="229" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:FilterEventsofInterest_Class">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="e83941c2-c6d7-4806-8336-691f792d1fde">
                <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="status" label="status" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="severity" label="severity" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="SERVICE" label="SERVICE" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="SERVICE"/>
                <Field name="COMPONENT" label="COMPONENT" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="COMPONENT"/>
                <Field name="METRIC_SOURCE" label="METRIC_SOURCE" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_SOURCE"/>
                <Field name="SOURCE_METRIC_NAME" label="SOURCE_METRIC_NAME" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="SOURCE_METRIC_NAME"/>
                <Field name="METRIC_NAME" label="METRIC_NAME" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_NAME"/>
                <Field name="METRIC_UOM" label="METRIC_UOM" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_UOM"/>
                <Field name="METRIC_UOM_LABEL" label="METRIC_UOM_LABEL" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_UOM_LABEL"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
              <Field name="min_ts" label="min_ts" type="datetime" isArray="false" isOptional="true"/>
              <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="" isClassRef="false">
              <Measures>
                <Measure type="min" field="ts" asName="min_ts"/>
                <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
              </Measures>
              <Window enable="false" />
              <__binding__><![CDATA[{"measures":""}]]></__binding__>
              <__binding__><![CDATA[{"measures":""}]]></__binding__>
            </Model>
        </Node>
        <Node index="2005" uuid="2348b56b-9a33-4b0e-8a3e-1f8460ca4a4c" type="outPort" label="ToNormalize" x="472" y="40" width="96.6875" height="40">
            <Source name="source" uid="0" outputType="DStream" dataType="(Long,Long,Long)">
              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="6783797e-0f4f-49c2-81b7-50906d504046">
                <Field name="_vt_time" label="_vt_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Model>
<Properties>
{}
</Properties>
            </Model>
        </Node>
        <Node index="2006" uuid="6d89e7d0-9df0-4c7f-8f9a-4a61a4dc2072" type="Aggregate" label="Get latest event time" x="427" y="308" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:FilterEventsofInterest_Class">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="e83941c2-c6d7-4806-8336-691f792d1fde">
                <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="status" label="status" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="severity" label="severity" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="SERVICE" label="SERVICE" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="SERVICE"/>
                <Field name="COMPONENT" label="COMPONENT" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="COMPONENT"/>
                <Field name="METRIC_SOURCE" label="METRIC_SOURCE" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_SOURCE"/>
                <Field name="SOURCE_METRIC_NAME" label="SOURCE_METRIC_NAME" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="SOURCE_METRIC_NAME"/>
                <Field name="METRIC_NAME" label="METRIC_NAME" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_NAME"/>
                <Field name="METRIC_UOM" label="METRIC_UOM" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_UOM"/>
                <Field name="METRIC_UOM_LABEL" label="METRIC_UOM_LABEL" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_UOM_LABEL"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
              <Field name="max_ts" label="max_ts" type="datetime" isArray="false" isOptional="true"/>
              <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="" isClassRef="false">
              <Measures>
                <Measure type="max" field="ts" asName="max_ts"/>
                <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
              </Measures>
              <Window enable="false" />
              <__binding__><![CDATA[{"measures":""}]]></__binding__>
              <__binding__><![CDATA[{"measures":""}]]></__binding__>
            </Model>
        </Node>
        <Node index="2007" uuid="4efed069-fbe4-42b4-84f5-418fa5488257" type="Compute" label="Conver to metrics (Dropped Events)" x="609" y="140" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="(Long,Long)">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="328fbd82-fdae-41c6-8c16-c241c5f6da38">
                <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${atimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Total Dropped Events&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="cast(count, &quot;string&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;sum&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Count&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="if(${agg_stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${atimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="2008" uuid="60d1ab54-b1e5-466d-886a-d566772cdc1b" type="subflow" label="CharterTemplateAuditlog" x="1012" y="194" width="130" height="75">
            <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9">
                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/AuditLog","audit_parquetfolder":"${agg_audit_table_folder}","source":"${agg_source}"}
</Properties>
              <__subflow__>
              <Flow index="2008" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                <Node index="2008_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="2008_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{"type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="2008_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="AuditLogTable" isClassRef="true">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="2008_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                      <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                    </Model>
                </Node>
                <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_parquetfolder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_ingestion_auditlog","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false}]</Properties>
      <Types>[{"name":"AuditLogTable","schema":[{"name":"date_key","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_start_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_end_tm","type":"long","_isOptional":true,"_isArray":false},{"name":"metric_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_value","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_uom","type":"string","_isOptional":false,"_isArray":false},{"name":"uom_label","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group","type":"string","_isOptional":false,"_isArray":false},{"name":"system_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"process_type","type":"string","_isOptional":false,"_isArray":false},{"name":"aggr_type","type":"string","_isOptional":false,"_isArray":false},{"name":"source_fmt","type":"string","_isOptional":false,"_isArray":false},{"name":"source_tz","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group_prefix","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_key","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_value","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"audit_parquetfolder":"","source":""}]]></__binding__>
            </Model>
        </Node>
        <Node index="2009" uuid="c8abb6dc-3518-41c5-88a5-7e016006e3f4" type="Compute" label="Convert to metrics (Earliest Event Time)" x="610" y="229" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="77779a47-2c4b-4aed-8f85-cf080f562555">
                <Field name="min_ts" label="min_ts" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${atimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Earliest Event Time&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="to_nonoption(cast(min_ts, &quot;string&quot;), &quot;null&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;ealiest&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Earliest&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="if(${agg_stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${atimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="2010" uuid="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" type="Filter" label="Do Audit Log" x="820" y="200" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="5f5f2582-13cd-46eb-8b21-b7894c459c28">
                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model filterModel="form">
              <Filters>
                <Filter field="" op="sleText" arg="" value="" sleText="&quot;${agg_doaudit}&quot; = &quot;True&quot; || &quot;${agg_doaudit}&quot; = &quot;true&quot;"/>
              </Filters>
            </Model>
        </Node>
        <Node index="2011" uuid="62838e97-64f5-4e62-872f-16d5e1dabdc2" type="subflow" label="CharterTemplateDroppedEvents" x="920" y="47" width="130" height="75">
            <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="04ac791e-25cd-4c05-88e3-f093d50eb330">
                <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="Out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/DroppedEvents","drop_source_group":"","drop_source":"${agg_source}","drop_sparksqltable":"${agg_dropped_events}","vtimezone":"Europe/London"}
</Properties>
              <__subflow__>
              <Flow index="2011" uuid="DroppedEvents" isNested="true" revision="672" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/DroppedEvents" name="DroppedEvents" showFooter="true">
                <Node index="2011_1" uuid="cd64c670-6c5f-440e-8b66-441c760166d8" type="inPort" label="In" x="240" y="32" width="70" height="40">
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents" referenceType="viaops.ingestion.DroppedEvents">
                      <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.DroppedEvents","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="2011_2" uuid="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" type="Compute" label="to Dropped Events" x="366" y="10" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="cd64c670-6c5f-440e-8b66-441c760166d8">
                        <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="toDroppedEvents_Class" isClassRef="false" udfs="generate_datekey">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${vtimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${drop_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${drop_source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="error" outputType="string" alias="error" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="data" outputType="string" alias="event" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="mixed"/>
                    </Model>
                </Node>
                <Node index="2011_3" uuid="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" type="StreamTarget" label="write to Hive" x="560" y="9" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="event" label="event" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="hiveTable" tableName="${drop_sparksqltable}" partitionType="eventField" partitionSize="" partitionColumn="date_key" partitionIndex="0" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                    </Model>
                </Node>
                <Node index="2011_4" uuid="dd779a23-bc63-4200-8e22-05639b978a68" type="outPort" label="Out" x="746" y="29" width="70" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="event" label="event" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{"type":{"name":"viaops.ingestion.DroppedEvents","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Link srcId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" srcPort="out:0" tgtId="dd779a23-bc63-4200-8e22-05639b978a68" tgtPort="in:0"/>
                <Link srcId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" srcPort="out:0" tgtId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" tgtPort="in:0"/>
                <Link srcId="cd64c670-6c5f-440e-8b66-441c760166d8" srcPort="out:0" tgtId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"drop_source_group","label":"Source Group","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"drop_source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"drop_sparksqltable","label":"Dropped Events Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"vtimezone","label":"Time Zone","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Etc/GMT","defaultValueForExisted":"Europe/London","enumSource":"rest:/global/?op=get.timezones","runtimeControl":false}]</Properties>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"drop_service":"","drop_app":"","drop_sparksqltable":"","drop_source":"","vtimezone":"atimezone","daylight":"","drop_source_group":"agg_source_group"}]]></__binding__>
            </Model>
        </Node>
        <Node index="2012" uuid="5f5f2582-13cd-46eb-8b21-b7894c459c28" type="Compute" label="Conver to metrics (Latest Event Time)" x="610" y="308" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="6d89e7d0-9df0-4c7f-8f9a-4a61a4dc2072">
                <Field name="max_ts" label="max_ts" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${atimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Latest Event Time&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="to_nonoption(cast(max_ts, &quot;string&quot;), &quot;null&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;latest&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Latest&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="if(${agg_stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${atimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="2013" uuid="85e06d15-61e0-444b-8a0a-d90fbc877d83" type="Adhoc" label="to Json String" x="607" y="47" width="130" height="75">
            <Source name="source1" uid="0" outputType="DStream" dataType="class:FilterEventsofInterest_Class">
              <DataSource category="#OUTPUT" id="undefined" name="Dropped" nodeId="6783797e-0f4f-49c2-81b7-50906d504046">
                <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="status" label="status" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="severity" label="severity" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="SERVICE" label="SERVICE" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="SERVICE"/>
                <Field name="COMPONENT" label="COMPONENT" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="COMPONENT"/>
                <Field name="METRIC_SOURCE" label="METRIC_SOURCE" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_SOURCE"/>
                <Field name="SOURCE_METRIC_NAME" label="SOURCE_METRIC_NAME" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="SOURCE_METRIC_NAME"/>
                <Field name="METRIC_NAME" label="METRIC_NAME" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_NAME"/>
                <Field name="METRIC_UOM" label="METRIC_UOM" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_UOM"/>
                <Field name="METRIC_UOM_LABEL" label="METRIC_UOM_LABEL" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false" column="METRIC_UOM_LABEL"/>
              </DataSource>
            </Source>
            <Output name="Out1" uid="0" outputType="DStream" dataType="String" referenceType="string">
              <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
              <Script><![CDATA[import com.fasterxml.jackson.databind.ObjectMapper
        import com.fasterxml.jackson.module.scala.DefaultScalaModule
        import com.fasterxml.jackson.module.scala.experimental.ScalaObjectMapper
        
        def toJson[T: Manifest](mapper: ScalaObjectMapper, value: T): String = {
            mapper.writerFor[T].writeValueAsString(value)
        }
        
        val retval = source1.mapPartitions { itr => {
                val mapper = new ObjectMapper() with ScalaObjectMapper
                mapper.registerModule(DefaultScalaModule)
                itr.map(data => toJson(mapper, data))
            }
        }
        ]]></Script>
            </Model>
        </Node>
        <Node index="2014" uuid="04ac791e-25cd-4c05-88e3-f093d50eb330" type="Compute" label="Tag Error" x="760" y="47" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="String">
              <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="85e06d15-61e0-444b-8a0a-d90fbc877d83">
                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents">
              <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="viaops.ingestion.DroppedEvents" isClassRef="true">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="&quot;out-of-order&quot;" outputType="string" alias="error" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="data" outputType="string" alias="data" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Link srcId="85e06d15-61e0-444b-8a0a-d90fbc877d83" srcPort="dout:0" tgtId="04ac791e-25cd-4c05-88e3-f093d50eb330" tgtPort="in:0"/>
        <Link srcId="6783797e-0f4f-49c2-81b7-50906d504046" srcPort="dout:1" tgtId="85e06d15-61e0-444b-8a0a-d90fbc877d83" tgtPort="din:0"/>
        <Link srcId="c8abb6dc-3518-41c5-88a5-7e016006e3f4" srcPort="out:0" tgtId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" tgtPort="in:0"/>
        <Link srcId="4efed069-fbe4-42b4-84f5-418fa5488257" srcPort="out:0" tgtId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" tgtPort="in:0"/>
        <Link srcId="77779a47-2c4b-4aed-8f85-cf080f562555" srcPort="dout:0" tgtId="c8abb6dc-3518-41c5-88a5-7e016006e3f4" tgtPort="in:0"/>
        <Link srcId="6783797e-0f4f-49c2-81b7-50906d504046" srcPort="dout:1" tgtId="328fbd82-fdae-41c6-8c16-c241c5f6da38" tgtPort="in:0"/>
        <Link srcId="e83941c2-c6d7-4806-8336-691f792d1fde" srcPort="out:0" tgtId="77779a47-2c4b-4aed-8f85-cf080f562555" tgtPort="in:0"/>
        <Link srcId="e83941c2-c6d7-4806-8336-691f792d1fde" srcPort="out:0" tgtId="6783797e-0f4f-49c2-81b7-50906d504046" tgtPort="in:0"/>
        <Link srcId="6783797e-0f4f-49c2-81b7-50906d504046" srcPort="dout:0" tgtId="2348b56b-9a33-4b0e-8a3e-1f8460ca4a4c" tgtPort="in:0"/>
        <Link srcId="e83941c2-c6d7-4806-8336-691f792d1fde" srcPort="out:0" tgtId="6d89e7d0-9df0-4c7f-8f9a-4a61a4dc2072" tgtPort="in:0"/>
        <Link srcId="328fbd82-fdae-41c6-8c16-c241c5f6da38" srcPort="dout:0" tgtId="4efed069-fbe4-42b4-84f5-418fa5488257" tgtPort="in:0"/>
        <Link srcId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" srcPort="out:0" tgtId="60d1ab54-b1e5-466d-886a-d566772cdc1b" tgtPort="din:0"/>
        <Link srcId="6d89e7d0-9df0-4c7f-8f9a-4a61a4dc2072" srcPort="dout:0" tgtId="5f5f2582-13cd-46eb-8b21-b7894c459c28" tgtPort="in:0"/>
        <Link srcId="5f5f2582-13cd-46eb-8b21-b7894c459c28" srcPort="out:0" tgtId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" tgtPort="in:0"/>
        <Link srcId="04ac791e-25cd-4c05-88e3-f093d50eb330" srcPort="out:0" tgtId="62838e97-64f5-4e62-872f-16d5e1dabdc2" tgtPort="din:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"number","*":{"label":"label","desc":"desc"},"name":"agg_stopBatchCount","label":"Stop After n Microbatch","type":"integer","hidden":"false","disabled":false,"resolveProperty":false,"value":0,"constraints":{"min":"0","max":"999999","step":"1","places":"","maxLength":""},"runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"agg_source_group","label":"Source Group","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"agg_source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"atimezone","label":"Time Zone","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Etc/GMT","enumSource":"rest:/global/?op=get.timezones","runtimeControl":false},{"editorType":"timeSetting","*":{"label":"label","desc":"desc"},"name":"timeSetting","label":"Time Setting","type":"object","hidden":"false","disabled":false,"resolveProperty":false,"value":{"timeSettingValue":{"timeType":"event","eventField":"ts","hbChecked":false,"oooChecked":false,"hbDelay":"30/S","oooDelay":"30/S"}},"constraints":{"type":"timeSetting","args":{"node":{"id":"6783797e-0f4f-49c2-81b7-50906d504046","uuid":"6783797e-0f4f-49c2-81b7-50906d504046","type":"Aggregate","pipe":"Aggregate","x":"232","y":"50","width":"130","height":"95","label":"Count 5 minutes","model":{"func":"Aggregate","desc":"","index":"2002","_nodeId":"6783797e-0f4f-49c2-81b7-50906d504046","sources":[{"sourceName":"source","uid":"0","sourceData":{"category":"#OUTPUT","params":[],"schema":[{"name":"datekey","label":"datekey","type":"long","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"status","label":"status","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"severity","label":"severity","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"host","label":"host","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"ts","label":"ts","type":"datetime","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"SERVICE","label":"SERVICE","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"SERVICE"},{"name":"COMPONENT","label":"COMPONENT","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"COMPONENT"},{"name":"METRIC_SOURCE","label":"METRIC_SOURCE","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_SOURCE"},{"name":"SOURCE_METRIC_NAME","label":"SOURCE_METRIC_NAME","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"SOURCE_METRIC_NAME"},{"name":"METRIC_NAME","label":"METRIC_NAME","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_NAME"},{"name":"METRIC_UOM","label":"METRIC_UOM","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM"},{"name":"METRIC_UOM_LABEL","label":"METRIC_UOM_LABEL","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM_LABEL"}],"uuid":"e83941c2-c6d7-4806-8336-691f792d1fde","nodeId":"e83941c2-c6d7-4806-8336-691f792d1fde","pipeId":"Aggregate","name":"out","outputType":"DStream","dataType":"class:FilterEventsofInterest_Class"}}],"outputs":[{"schema":[{"name":"_vt_time","label":"_vt_time","type":"long","_isArray":false,"_isOptional":false},{"name":"count","label":"count","type":"long","_isArray":false,"_isOptional":false},{"name":"aggr_end_tm","label":"aggr_end_tm","type":"long","_isArray":false,"_isOptional":false}],"name":"Out","uid":"0","outputType":"DStream","dataType":"(Long,Long,Long)","dataSpeed":null,"dataVolume":null,"meta":{"cacheEnabled":false,"storageLevel":null,"partitionEnabled":false,"partitionPolicy":null,"partitionNum":null,"shuffle":false,"exploreConfig":{"_index":"Default","items":[{"name":"Default"}]}}},{"schema":[{"name":"datekey","label":"datekey","type":"long","clazz":"","_isArray":false,"_isOptional":false},{"name":"status","label":"status","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"severity","label":"severity","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"host","label":"host","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"ts","label":"ts","type":"datetime","clazz":"","_isArray":false,"_isOptional":false},{"name":"SERVICE","label":"SERVICE","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"SERVICE"},{"name":"COMPONENT","label":"COMPONENT","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"COMPONENT"},{"name":"METRIC_SOURCE","label":"METRIC_SOURCE","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_SOURCE"},{"name":"SOURCE_METRIC_NAME","label":"SOURCE_METRIC_NAME","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"SOURCE_METRIC_NAME"},{"name":"METRIC_NAME","label":"METRIC_NAME","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_NAME"},{"name":"METRIC_UOM","label":"METRIC_UOM","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM"},{"name":"METRIC_UOM_LABEL","label":"METRIC_UOM_LABEL","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM_LABEL"}],"name":"Dropped","uid":"1","outputType":"DStream","dataType":"class:FilterEventsofInterest_Class","dataSpeed":null,"dataVolume":null,"meta":{"cacheEnabled":false,"storageLevel":null,"partitionEnabled":false,"partitionPolicy":null,"partitionNum":null,"shuffle":false,"exploreConfig":{"_index":"Default","items":[{"name":"Default"}]}},"label":"Dropped"}],"measures":[{"type":"count","field":"","asName":"count"},{"type":"window_end_time","field":"","asName":"aggr_end_tm"}],"windowSize":"5/N","windowInterval":"5/N","timeSettingValue":{"timeType":"event","eventField":"ts"},"outputCondition":"changes","showWindowProperty":true,"__binding__":{"windowSetting":"windowSetting","timeSetting":"timeSetting","dimensions":"dimensions","measures":"measures"},"caseClass":"","ref":"false"},"index":"2002"}}},"enumSource":"","runtimeControl":false,"group":"group","groupLabel":"Window"},{"editorType":"windowSetting","*":{"label":"label","desc":"desc"},"name":"windowSetting","label":"Window Setting","type":"object","hidden":"false","disabled":false,"resolveProperty":false,"value":{"windowSize":"5/N","windowInterval":"5/N","windowPolicy":"time"},"constraints":{"type":"windowSetting","args":{"node":{"id":"6783797e-0f4f-49c2-81b7-50906d504046","uuid":"6783797e-0f4f-49c2-81b7-50906d504046","type":"Aggregate","pipe":"Aggregate","x":"232","y":"50","width":"130","height":"95","label":"Count 5 minutes","model":{"func":"Aggregate","desc":"","index":"2002","_nodeId":"6783797e-0f4f-49c2-81b7-50906d504046","sources":[{"sourceName":"source","uid":"0","sourceData":{"category":"#OUTPUT","params":[],"schema":[{"name":"datekey","label":"datekey","type":"long","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"status","label":"status","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"severity","label":"severity","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"host","label":"host","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"ts","label":"ts","type":"datetime","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"SERVICE","label":"SERVICE","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"SERVICE"},{"name":"COMPONENT","label":"COMPONENT","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"COMPONENT"},{"name":"METRIC_SOURCE","label":"METRIC_SOURCE","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_SOURCE"},{"name":"SOURCE_METRIC_NAME","label":"SOURCE_METRIC_NAME","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"SOURCE_METRIC_NAME"},{"name":"METRIC_NAME","label":"METRIC_NAME","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_NAME"},{"name":"METRIC_UOM","label":"METRIC_UOM","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM"},{"name":"METRIC_UOM_LABEL","label":"METRIC_UOM_LABEL","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM_LABEL"}],"uuid":"e83941c2-c6d7-4806-8336-691f792d1fde","nodeId":"e83941c2-c6d7-4806-8336-691f792d1fde","pipeId":"Aggregate","name":"out","outputType":"DStream","dataType":"class:FilterEventsofInterest_Class"}}],"outputs":[{"schema":[{"name":"_vt_time","label":"_vt_time","type":"long","_isArray":false,"_isOptional":false},{"name":"count","label":"count","type":"long","_isArray":false,"_isOptional":false},{"name":"aggr_end_tm","label":"aggr_end_tm","type":"long","_isArray":false,"_isOptional":false}],"name":"Out","uid":"0","outputType":"DStream","dataType":"(Long,Long,Long)","dataSpeed":null,"dataVolume":null,"meta":{"cacheEnabled":false,"storageLevel":null,"partitionEnabled":false,"partitionPolicy":null,"partitionNum":null,"shuffle":false,"exploreConfig":{"_index":"Default","items":[{"name":"Default"}]}}},{"schema":[{"name":"datekey","label":"datekey","type":"long","clazz":"","_isArray":false,"_isOptional":false},{"name":"status","label":"status","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"severity","label":"severity","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"host","label":"host","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"ts","label":"ts","type":"datetime","clazz":"","_isArray":false,"_isOptional":false},{"name":"SERVICE","label":"SERVICE","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"SERVICE"},{"name":"COMPONENT","label":"COMPONENT","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"COMPONENT"},{"name":"METRIC_SOURCE","label":"METRIC_SOURCE","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_SOURCE"},{"name":"SOURCE_METRIC_NAME","label":"SOURCE_METRIC_NAME","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"SOURCE_METRIC_NAME"},{"name":"METRIC_NAME","label":"METRIC_NAME","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_NAME"},{"name":"METRIC_UOM","label":"METRIC_UOM","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM"},{"name":"METRIC_UOM_LABEL","label":"METRIC_UOM_LABEL","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM_LABEL"}],"name":"Dropped","uid":"1","outputType":"DStream","dataType":"class:FilterEventsofInterest_Class","dataSpeed":null,"dataVolume":null,"meta":{"cacheEnabled":false,"storageLevel":null,"partitionEnabled":false,"partitionPolicy":null,"partitionNum":null,"shuffle":false,"exploreConfig":{"_index":"Default","items":[{"name":"Default"}]}},"label":"Dropped"}],"measures":[{"type":"count","field":"","asName":"count"},{"type":"window_end_time","field":"","asName":"aggr_end_tm"}],"windowSize":"5/N","windowInterval":"5/N","timeSettingValue":{"timeType":"event","eventField":"ts"},"outputCondition":"changes","showWindowProperty":true,"__binding__":{"windowSetting":"windowSetting","timeSetting":"timeSetting","dimensions":"dimensions","measures":"measures"},"caseClass":"","ref":"false"},"index":"2002"}}},"enumSource":"","runtimeControl":false,"group":"group","groupLabel":"Window"},{"name":"dimensions","label":"Dimension fields","type":"string","editorType":"fieldMultiSelect","editorID":"_dimension","constraints":{"type":"fieldMultiSelect","args":{"nodeType":"all","node":{"id":"6783797e-0f4f-49c2-81b7-50906d504046","uuid":"6783797e-0f4f-49c2-81b7-50906d504046","type":"Aggregate","pipe":"Aggregate","x":"232","y":"50","width":"130","height":"95","label":"Count 5 minutes","model":{"func":"Aggregate","desc":"","index":"2002","_nodeId":"6783797e-0f4f-49c2-81b7-50906d504046","sources":[{"sourceName":"source","uid":"0","sourceData":{"category":"#OUTPUT","params":[],"schema":[{"name":"datekey","label":"datekey","type":"long","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"status","label":"status","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"severity","label":"severity","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"host","label":"host","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"ts","label":"ts","type":"datetime","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"SERVICE","label":"SERVICE","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"SERVICE"},{"name":"COMPONENT","label":"COMPONENT","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"COMPONENT"},{"name":"METRIC_SOURCE","label":"METRIC_SOURCE","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_SOURCE"},{"name":"SOURCE_METRIC_NAME","label":"SOURCE_METRIC_NAME","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"SOURCE_METRIC_NAME"},{"name":"METRIC_NAME","label":"METRIC_NAME","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_NAME"},{"name":"METRIC_UOM","label":"METRIC_UOM","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM"},{"name":"METRIC_UOM_LABEL","label":"METRIC_UOM_LABEL","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM_LABEL"}],"uuid":"e83941c2-c6d7-4806-8336-691f792d1fde","nodeId":"e83941c2-c6d7-4806-8336-691f792d1fde","pipeId":"Aggregate","name":"out","outputType":"DStream","dataType":"class:FilterEventsofInterest_Class"}}],"outputs":[{"schema":[{"name":"_vt_time","label":"_vt_time","type":"long","_isArray":false,"_isOptional":false},{"name":"count","label":"count","type":"long","_isArray":false,"_isOptional":false},{"name":"aggr_end_tm","label":"aggr_end_tm","type":"long","_isArray":false,"_isOptional":false}],"name":"Out","uid":"0","outputType":"DStream","dataType":"(Long,Long,Long)","dataSpeed":null,"dataVolume":null,"meta":{"cacheEnabled":false,"storageLevel":null,"partitionEnabled":false,"partitionPolicy":null,"partitionNum":null,"shuffle":false,"exploreConfig":{"_index":"Default","items":[{"name":"Default"}]}}},{"schema":[{"name":"datekey","label":"datekey","type":"long","clazz":"","_isArray":false,"_isOptional":false},{"name":"status","label":"status","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"severity","label":"severity","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"host","label":"host","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"ts","label":"ts","type":"datetime","clazz":"","_isArray":false,"_isOptional":false},{"name":"SERVICE","label":"SERVICE","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"SERVICE"},{"name":"COMPONENT","label":"COMPONENT","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"COMPONENT"},{"name":"METRIC_SOURCE","label":"METRIC_SOURCE","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_SOURCE"},{"name":"SOURCE_METRIC_NAME","label":"SOURCE_METRIC_NAME","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"SOURCE_METRIC_NAME"},{"name":"METRIC_NAME","label":"METRIC_NAME","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_NAME"},{"name":"METRIC_UOM","label":"METRIC_UOM","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM"},{"name":"METRIC_UOM_LABEL","label":"METRIC_UOM_LABEL","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM_LABEL"}],"name":"Dropped","uid":"1","outputType":"DStream","dataType":"class:FilterEventsofInterest_Class","dataSpeed":null,"dataVolume":null,"meta":{"cacheEnabled":false,"storageLevel":null,"partitionEnabled":false,"partitionPolicy":null,"partitionNum":null,"shuffle":false,"exploreConfig":{"_index":"Default","items":[{"name":"Default"}]}},"label":"Dropped"}],"measures":[{"type":"count","field":"","asName":"count"},{"type":"window_end_time","field":"","asName":"aggr_end_tm"}],"windowSize":"5/N","windowInterval":"5/N","timeSettingValue":{"timeType":"event","eventField":"ts"},"outputCondition":"changes","showWindowProperty":true,"__binding__":{"windowSetting":"windowSetting","timeSetting":"timeSetting","dimensions":"dimensions","measures":"measures"},"caseClass":"","ref":"false"},"index":"2002"}}},"sourceSchemaSensitive":true,"value":[],"runtimeControl":false,"group":"group1","groupLabel":"Aggregate"},{"editorType":"measureSetting","*":{"label":"label","desc":"desc"},"group":"group1","groupLabel":"Aggregate","name":"measures","label":"Measure Fields","type":"object","hidden":"false","disabled":false,"resolveProperty":false,"value":[{"type":"count","field":"","asName":"count"},{"type":"window_end_time","field":"","asName":"aggr_end_tm"}],"constraints":{"type":"measureSetting","args":{"node":{"id":"6783797e-0f4f-49c2-81b7-50906d504046","uuid":"6783797e-0f4f-49c2-81b7-50906d504046","type":"Aggregate","pipe":"Aggregate","x":"232","y":"50","width":"130","height":"95","label":"Count 5 minutes","model":{"func":"Aggregate","desc":"","index":"2002","_nodeId":"6783797e-0f4f-49c2-81b7-50906d504046","sources":[{"sourceName":"source","uid":"0","sourceData":{"category":"#OUTPUT","params":[],"schema":[{"name":"datekey","label":"datekey","type":"long","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"status","label":"status","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"severity","label":"severity","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"host","label":"host","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"ts","label":"ts","type":"datetime","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"SERVICE","label":"SERVICE","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"SERVICE"},{"name":"COMPONENT","label":"COMPONENT","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"COMPONENT"},{"name":"METRIC_SOURCE","label":"METRIC_SOURCE","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_SOURCE"},{"name":"SOURCE_METRIC_NAME","label":"SOURCE_METRIC_NAME","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"SOURCE_METRIC_NAME"},{"name":"METRIC_NAME","label":"METRIC_NAME","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_NAME"},{"name":"METRIC_UOM","label":"METRIC_UOM","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM"},{"name":"METRIC_UOM_LABEL","label":"METRIC_UOM_LABEL","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM_LABEL"}],"uuid":"e83941c2-c6d7-4806-8336-691f792d1fde","nodeId":"e83941c2-c6d7-4806-8336-691f792d1fde","pipeId":"Aggregate","name":"out","outputType":"DStream","dataType":"class:FilterEventsofInterest_Class"}}],"outputs":[{"schema":[{"name":"_vt_time","label":"_vt_time","type":"long","_isArray":false,"_isOptional":false},{"name":"count","label":"count","type":"long","_isArray":false,"_isOptional":false},{"name":"aggr_end_tm","label":"aggr_end_tm","type":"long","_isArray":false,"_isOptional":false}],"name":"Out","uid":"0","outputType":"DStream","dataType":"(Long,Long,Long)","dataSpeed":null,"dataVolume":null,"meta":{"cacheEnabled":false,"storageLevel":null,"partitionEnabled":false,"partitionPolicy":null,"partitionNum":null,"shuffle":false,"exploreConfig":{"_index":"Default","items":[{"name":"Default"}]}}},{"schema":[{"name":"datekey","label":"datekey","type":"long","clazz":"","_isArray":false,"_isOptional":false},{"name":"status","label":"status","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"severity","label":"severity","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"host","label":"host","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"ts","label":"ts","type":"datetime","clazz":"","_isArray":false,"_isOptional":false},{"name":"SERVICE","label":"SERVICE","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"SERVICE"},{"name":"COMPONENT","label":"COMPONENT","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"COMPONENT"},{"name":"METRIC_SOURCE","label":"METRIC_SOURCE","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_SOURCE"},{"name":"SOURCE_METRIC_NAME","label":"SOURCE_METRIC_NAME","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"SOURCE_METRIC_NAME"},{"name":"METRIC_NAME","label":"METRIC_NAME","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_NAME"},{"name":"METRIC_UOM","label":"METRIC_UOM","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM"},{"name":"METRIC_UOM_LABEL","label":"METRIC_UOM_LABEL","type":"string","clazz":"","_isArray":false,"_isOptional":false,"column":"METRIC_UOM_LABEL"}],"name":"Dropped","uid":"1","outputType":"DStream","dataType":"class:FilterEventsofInterest_Class","dataSpeed":null,"dataVolume":null,"meta":{"cacheEnabled":false,"storageLevel":null,"partitionEnabled":false,"partitionPolicy":null,"partitionNum":null,"shuffle":false,"exploreConfig":{"_index":"Default","items":[{"name":"Default"}]}},"label":"Dropped"}],"measures":[{"type":"count","field":"","asName":"count"},{"type":"window_end_time","field":"","asName":"aggr_end_tm"}],"windowSize":"5/N","windowInterval":"5/N","timeSettingValue":{"timeType":"event","eventField":"ts"},"outputCondition":"changes","showWindowProperty":true,"__binding__":{"windowSetting":"windowSetting","timeSetting":"timeSetting","dimensions":"dimensions","measures":"measures"},"caseClass":"","ref":"false"},"index":"2002"}}},"enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Audit","name":"agg_dropped_events","label":"Dropped Events Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Audit","name":"agg_doaudit","label":"Audit Log","type":"boolean","hidden":"false","disabled":false,"resolveProperty":false,"value":"true","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Audit","name":"agg_audit_table_folder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false}]</Properties>
      </Flow>
      <Flow index="3000" uuid="MetricReferenceData" isNested="true" revision="528" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="local://MetricReferenceDataTemplate" registered="true" subflowPath="viaops.ingestion" name="MetricReferenceData" showFooter="true">
        <Node index="3001" uuid="6029ac79-48d9-4e91-8d5f-bf6b1e7cc197" type="JDBCStream" label="Load System Model" x="46" y="20" width="130" height="75">
            <Output name="out" uid="0" outputType="DStream" dataType="class:SystemModelData">
              <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model type="jdbcStream" sourceType="jdbc" caseClass="SystemModelData" isClassRef="true" dataSpeed="" dataVolume="" dataSource="/vitria/m3o/datasource/DefaultDomain/charter_ref_db">
              <__binding__><![CDATA[{"dataSource":"dataSource","databaseList":"","tableList":"ref_table"}]]></__binding__>
              <Schema>
                <Field name="metric_id" label="metric_id" type="string" clazz="" isArray="false" isOptional="false" wrapName="metric_id"/>
                <Field name="sql_qdc" label="sql_qdc" type="string" clazz="" isArray="false" isOptional="false" wrapName="sql_qdc"/>
                <Field name="json_qdc" label="json_qdc" type="string" clazz="" isArray="false" isOptional="false" wrapName="json_qdc"/>
                <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false" wrapName="aggr_func"/>
                <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_source_group"/>
                <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_source_name"/>
                <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_target_app"/>
                <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false" wrapName="parse_target_metric"/>
                <Field name="modified_ts" label="modified_ts" type="datetime" clazz="" isArray="false" isOptional="false" wrapName="modified_ts"/>
              </Schema>
              <datasource name="/vitria/m3o/datasource/DefaultDomain/charter_ref_db"></datasource>
              <query>
              <table schema='charter_ref_db' defaultSchema='charter_ref_db' info='{"catalog":"charter_ref_db","name":"charter_service_model","type":"TABLE"}'>charter_service_model</table>
              <columns>
                <column>aggr_func</column>
                <column>parse_source_group</column>
                <column>parse_source_name</column>
                <column>parse_target_app</column>
                <column>parse_target_metric</column>
              </columns>
              <growColumns>
              </growColumns>
              <filter>${ref_filterScript}</filter>
              <incremental>false</incremental>
              </query>
              <pollRate every='${poll}/m' value='NaN'/>
            </Model>
        </Node>
        <Node index="3002" uuid="46c6dae7-217b-466f-8a0a-1f3b14d70d9f" type="Window" label="Group Metrics" x="380" y="20" width="130" height="135">
            <Source name="source" uid="0" outputType="DStream" dataType="class:SystemModelData">
              <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="e0fdeeb6-a708-4a70-8958-837d58e1e40d">
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="All" uid="0" outputType="DStream" dataType="class:SystemModelData">
              <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Output name="Changes" uid="1" outputType="DStream" dataType="class:SystemModelData">
              <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Output name="Expired" uid="2" outputType="DStream" dataType="class:SystemModelData">
              <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Output name="Deleted" uid="3" outputType="DStream" dataType="class:SystemModelData">
              <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model windowPolicy="attribute" partition="" checkpointInterval="/S" restoreState="false">
              <Time mode="system">
              </Time>
              <GroupKeys policy="latest" numPerGroup="1">
                <GroupKey field="parse_source_group"/>
                <GroupKey field="parse_source_name"/>
                <GroupKey field="parse_target_app"/>
                <GroupKey field="parse_target_metric"/>
              </GroupKeys>
              <Expirations duration="/S" baseline="lastevent">
              </Expirations>
            </Model>
        </Node>
        <Node index="3003" uuid="bc4ea8d5-e474-4b66-8e55-040246f8a424" type="Compute" label="All Metrics" x="553" y="20" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:SystemModelData">
              <DataSource category="#OUTPUT" id="undefined" name="All" nodeId="46c6dae7-217b-466f-8a0a-1f3b14d70d9f">
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="(String,String,String,String,String)">
              <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model isClassRef="false">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="aggr_func" outputType="string" alias="aggr_func" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="parse_source_group" outputType="string" alias="parse_source_group" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="parse_source_name" outputType="string" alias="parse_source_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="parse_target_app" outputType="string" alias="parse_target_app" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="parse_target_metric" outputType="string" alias="parse_target_metric" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="mixed"/>
            </Model>
        </Node>
        <Node index="3004" uuid="354f4d2b-5f04-462e-84fe-455d4a0e8da3" type="outPort" label="Out" x="720" y="40" width="70" height="40">
            <Source name="source" uid="0" outputType="DStream" dataType="(String,String,String,String,String)">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="bc4ea8d5-e474-4b66-8e55-040246f8a424">
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Model>
<Properties>
{}
</Properties>
            </Model>
        </Node>
        <Node index="3005" uuid="e0fdeeb6-a708-4a70-8958-837d58e1e40d" type="Adhoc" label="FlatMap" x="210" y="20" width="130" height="75">
            <Source name="source1" uid="0" outputType="DStream" dataType="class:SystemModelData">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="6029ac79-48d9-4e91-8d5f-bf6b1e7cc197">
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="aggr_func" column="aggr_func"/>
                <Field name="parse_source_group" label="parse_source_group" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="parse_source_group" column="parse_source_group"/>
                <Field name="parse_source_name" label="parse_source_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="parse_source_name" column="parse_source_name"/>
                <Field name="parse_target_app" label="parse_target_app" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="parse_target_app" column="parse_target_app"/>
                <Field name="parse_target_metric" label="parse_target_metric" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" wrapName="parse_target_metric" column="parse_target_metric"/>
              </DataSource>
            </Source>
            <Output name="Out1" uid="0" outputType="DStream" dataType="class:SystemModelData" referenceType="SystemModelData">
              <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_group" label="parse_source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_source_name" label="parse_source_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_app" label="parse_target_app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="parse_target_metric" label="parse_target_metric" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
              <Script><![CDATA[val retval = source1.flatMap { data =>
    data.parse_source_name.split(",").map { source_name =>
        SystemModelData(data.aggr_func, data.parse_source_group, source_name, data.parse_target_app, data.parse_target_metric)
    }
}]]></Script>
            </Model>
        </Node>
        <Link srcId="bc4ea8d5-e474-4b66-8e55-040246f8a424" srcPort="out:0" tgtId="354f4d2b-5f04-462e-84fe-455d4a0e8da3" tgtPort="in:0"/>
        <Link srcId="46c6dae7-217b-466f-8a0a-1f3b14d70d9f" srcPort="dout:0" tgtId="bc4ea8d5-e474-4b66-8e55-040246f8a424" tgtPort="in:0"/>
        <Link srcId="6029ac79-48d9-4e91-8d5f-bf6b1e7cc197" srcPort="out:0" tgtId="e0fdeeb6-a708-4a70-8958-837d58e1e40d" tgtPort="din:0"/>
        <Link srcId="e0fdeeb6-a708-4a70-8958-837d58e1e40d" srcPort="dout:0" tgtId="46c6dae7-217b-466f-8a0a-1f3b14d70d9f" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"_dataSourceSelector","*":{"label":"label","desc":"desc"},"name":"dataSource","label":"Datasource","type":"object","hidden":"false","disabled":false,"resolveProperty":false,"value":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/charter_ref_db"},"defaultValueForExisted":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/charter_ref_db","databaseURL":"jdbc:mysql://10.101.3.186:3306/charter_ref_db","userName":"root","password":"&lt;X0ws2Kuv10c59bxYGyv4xvu&gt;","driverType":"com.mysql.jdbc.Driver"},"constraints":{"type":"dataSource","args":{"node":{"id":"6029ac79-48d9-4e91-8d5f-bf6b1e7cc197","uuid":"6029ac79-48d9-4e91-8d5f-bf6b1e7cc197","type":"JDBCStream","pipe":"MetricReferenceData","x":"46","y":"20","width":"130","height":"75","label":"Load System Model","model":{"func":"JDBCStream","desc":"Load System Model","index":"3001","_nodeId":"6029ac79-48d9-4e91-8d5f-bf6b1e7cc197","sources":[],"output":{"category":"#OUTPUT","name":"out","uid":"0","schema":[{"name":"aggr_func","type":"string","_isOptional":false,"_isArray":false,"label":"aggr_func","clazz":""},{"name":"parse_source_group","type":"string","_isOptional":false,"_isArray":false,"label":"parse_source_group","clazz":""},{"name":"parse_source_name","type":"string","_isOptional":false,"_isArray":false,"label":"parse_source_name","clazz":""},{"name":"parse_target_app","type":"string","_isOptional":false,"_isArray":false,"label":"parse_target_app","clazz":""},{"name":"parse_target_metric","type":"string","_isOptional":false,"_isArray":false,"label":"parse_target_metric","clazz":""}],"outputType":"DStream","dataType":"class:SystemModelData","dataSpeed":"","dataVolume":"","result":[],"meta":{"cacheEnabled":false,"storageLevel":null,"partitionEnabled":false,"partitionPolicy":null,"partitionNum":null,"shuffle":false,"exploreConfig":{"_index":"Default","items":[{"name":"Default"}]}}},"__binding__":{"dataSource":"dataSource","databaseList":"","tableList":"ref_table"},"schema":[{"name":"metric_id","label":"metric_id","type":"string","clazz":"","_isArray":false,"_isOptional":false,"wrapName":"metric_id"},{"name":"sql_qdc","label":"sql_qdc","type":"string","clazz":"","_isArray":false,"_isOptional":false,"wrapName":"sql_qdc"},{"name":"json_qdc","label":"json_qdc","type":"string","clazz":"","_isArray":false,"_isOptional":false,"wrapName":"json_qdc"},{"name":"aggr_func","label":"aggr_func","type":"string","clazz":"","_isArray":false,"_isOptional":false,"wrapName":"aggr_func"},{"name":"parse_source_group","label":"parse_source_group","type":"string","clazz":"","_isArray":false,"_isOptional":false,"wrapName":"parse_source_group"},{"name":"parse_source_name","label":"parse_source_name","type":"string","clazz":"","_isArray":false,"_isOptional":false,"wrapName":"parse_source_name"},{"name":"parse_target_app","label":"parse_target_app","type":"string","clazz":"","_isArray":false,"_isOptional":false,"wrapName":"parse_target_app"},{"name":"parse_target_metric","label":"parse_target_metric","type":"string","clazz":"","_isArray":false,"_isOptional":false,"wrapName":"parse_target_metric"},{"name":"modified_ts","label":"modified_ts","type":"datetime","clazz":"","_isArray":false,"_isOptional":false,"wrapName":"modified_ts"}],"tableInfo":"{\"catalog\":\"charter_ref_db\",\"name\":\"charter_service_model\",\"type\":\"TABLE\"}","databaseName":"charter_ref_db","tableName":"charter_service_model","defaultSchema":"charter_ref_db","selectedFields":["aggr_func","parse_source_group","parse_source_name","parse_target_app","parse_target_metric"],"growFields":[],"script":"${ref_filterScript}","updatePolicy":"all","rate":"${poll}","unit":"m","sourceType":"jdbc","dataSource":"/vitria/m3o/datasource/DefaultDomain/charter_ref_db","caseClass":"SystemModelData","ref":"true","dataSpeed":"","dataVolume":"","driverType":"com.mysql.jdbc.Driver","databaseURL":"jdbc:mysql://10.101.3.186:3306/charter_ref_db?useSSL=false","userName":"root","password":"&lt;5078@9OP@SPjZdz6jlEyqTvM&gt;","passwordRef":"false"},"index":"3001"}}},"enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"ref_table","label":"System Model Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_parse_model","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"ref_source_group","label":"Source Group","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"stva_video","enumSource":"","runtimeControl":false},{"editorType":"script","*":{"label":"label","desc":"desc"},"name":"ref_filterScript","label":"Filter Script","type":"string","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"value":"parse_source_group=&apos;${source_group}&apos;","constraints":{"type":"script","args":{"scriptMode":"sql","scriptSection":"false","header":"false"}},"runtimeControl":false},{"editorType":"number","*":{"label":"label","desc":"desc"},"group":"common","name":"poll","label":"Poll Rate (Minutes)","type":"integer","hidden":"false","disabled":false,"resolveProperty":false,"value":"1","defaultValueForExisted":"1","constraints":{"min":"0","max":"999999","step":"1","places":"","maxLength":""},"runtimeControl":false}]</Properties>
      <Types>[{"name":"SystemModelData","namespace":"","schema":[{"name":"aggr_func","type":"string","_isOptional":false,"_isArray":false},{"name":"parse_source_group","type":"string","_isOptional":false,"_isArray":false},{"name":"parse_source_name","type":"string","_isOptional":false,"_isArray":false},{"name":"parse_target_app","type":"string","_isOptional":false,"_isArray":false},{"name":"parse_target_metric","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
      </Flow>
      <Flow index="4000" uuid="MetricOutput" isNested="true" revision="4189" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="local://OutputTemplate" registered="true" subflowPath="viaops.ingestion" name="MetricOutput" showFooter="true">
        <Node index="4001" uuid="83dcd221-9159-46d5-8fb4-b6c524c69c02" type="inPort" label="source1" x="100" y="83" width="72.703125" height="40">
            <Output name="out" uid="0" outputType="DStream" dataType="class:TestClass">
              <Field name="datekey" label="datekey" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="tsepoch" label="tsepoch" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricname" label="metricname" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricvalue" label="metricvalue" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricuom" label="metricuom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uomlabel" label="uomlabel" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="svc" label="svc" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dom" label="dom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="usr" label="usr" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="shost" label="shost" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dhost" label="dhost" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="node" label="node" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"portType":"DStream"}
</Properties>
            </Model>
        </Node>
        <Node index="4002" uuid="16257540-b127-448a-8891-c8a71a46df04" type="StreamTarget" label="Stream to Anomaly Detection" x="560" y="120" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:TestClass">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="a2992e48-a216-41c5-857a-5230e14d64a6">
                <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="tsepoch" label="tsepoch" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricname" label="metricname" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricvalue" label="metricvalue" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricuom" label="metricuom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="uomlabel" label="uomlabel" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="svc" label="svc" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="usr" label="usr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="shost" label="shost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="node" label="node" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:TestClass">
              <Field name="datekey" label="datekey" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="tsepoch" label="tsepoch" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricname" label="metricname" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricvalue" label="metricvalue" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricuom" label="metricuom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uomlabel" label="uomlabel" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="svc" label="svc" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dom" label="dom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="usr" label="usr" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="shost" label="shost" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dhost" label="dhost" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="node" label="node" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model type="file" url="${ANOMALY_TARGET_FILENAME}" namePrefix="${anomalyFileNamePrefix}" format="json" partitionNum="1" dataSpeed="" dataVolume="">
              <__binding__><![CDATA[{"fileNamePrefix":""}]]></__binding__>
            </Model>
        </Node>
        <Node index="4003" uuid="cfde6cfb-7498-4b34-8dfc-62eb71da9bb4" type="Adhoc" label="Persist History Table" x="560" y="31" width="130" height="75">
            <Source name="source1" uid="0" outputType="DStream" dataType="class:TestClass">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="73490184-781b-4acb-8f0e-500cca2f6ad9">
                <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="tsepoch" label="tsepoch" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricname" label="metricname" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricvalue" label="metricvalue" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricuom" label="metricuom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="uomlabel" label="uomlabel" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="svc" label="svc" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="usr" label="usr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="shost" label="shost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="node" label="node" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="Out1" uid="0" outputType="DStream" dataType="String" referenceType="string">
              <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
              <Script><![CDATA[
import org.apache.hadoop.conf.Configuration
import org.apache.hadoop.fs.{FileStatus, FileSystem, Path}
import java.net.URI
import org.apache.hadoop.fs.PathFilter
import java.util.UUID

def copydir(fs: FileSystem, src: Path, dest: Path): Unit = {
    val children = fs.listStatus(src)
    children.foreach(child => {
        val targetPath = new Path(dest, child.getPath.getName)
        if (child.isDirectory()) {
            val result = fs.mkdirs(targetPath)
            copydir(fs, child.getPath, targetPath)
        } else if (!"_SUCCESS".equals(child.getPath.getName)) {
            var realtarget = new Path(dest, "${output_source}-"+child.getPath.getName)
            if (fs.exists(targetPath)) {
                realtarget = new Path(dest, "${output_source}-"+UUID.randomUUID.toString+"-"+child.getPath.getName)
            }
            fs.rename(child.getPath, realtarget)
        }
    })
    fs.delete(src, true)
}

def getKeyValues(fs: FileSystem, folderName: String, key: String) : Array[String] = {
    val statuses: Array[FileStatus] = fs.listStatus(new Path(folderName))
    val keyvalues: Array[String] = statuses.filter(_.isDirectory).map(_.getPath.getName).filter(_.startsWith(key + "="))
    keyvalues
}

def getSubfolder(fs: FileSystem, folderName: String, keys: Array[String]) : Array[String] = {
    if (keys.length == 0) {
        Array[String]()
    } else {
        val currentkey = keys(0)
        val keyvalues = getKeyValues(fs, folderName, currentkey)

        if (keys.length > 1) {
            keyvalues.flatMap(kv => {
                val subkeyvalues = getSubfolder(fs, folderName.concat("/").concat(kv), keys.drop(1)).map(kv.concat(",").concat(_))
                subkeyvalues
            })
        } else {
            keyvalues
        }
    }
}

def folderNotExist(fs: FileSystem, baseName: String, subName: String): Boolean = {
    !fs.exists(new Path(baseName, subName))
}

val basefolder = "${HISTORY_TABLE_FOLDER}"
val tempfolder = java.util.UUID.randomUUID.toString
//   val tempfolder = "${__flowIndex__}"
val partitionkeys = "${output_partition_keys}".replaceAll("\\[|\\]", "").split(',').map(x => x.trim())

//prepare sql
val historyTableName = "${history_table_name}"
val tempSB = new StringBuilder()
val selectSQL = """select distinct concat(""" + partitionkeys.map(k => s"""concat("$k=", $k)""").addString(tempSB, """ , "/" , """) + s""") from tempMetricOutput"""
//println("==================" + selectSQL)
val repairSQL = "MSCK REPAIR TABLE %s".format(historyTableName)
//println("==================" + repairSQL)
val partitionNum: Int = 1

source1.foreachRDD(rdd => {
    val fs = FileSystem.get(URI.create(basefolder), new Configuration)
    
    //println("================= start get partition")
    //val partitions: Array[String] = if (fs.exists(new Path(basefolder))) {getSubfolder(fs, basefolder, partitionkeys)} else {Array[String]()}
    //println("================= end get partition")
    //partitions.foreach(println)
    
    var needrepair: Boolean = false
    
    val src = new Path(basefolder, tempfolder)
    val dest = new Path(basefolder)
    val df = hiveContext.createDataFrame(rdd)
    
    df.createOrReplaceTempView("tempMetricOutput")
    //println("================= start select hive")
    val arrayP = hiveContext.sql(selectSQL).map(_.getString(0)).collect()
    needrepair = arrayP.exists(ps => folderNotExist(fs, basefolder, ps))
    
    //arrayP.foreach(pvalue => {
    //    println("===============" + pvalue)
    //})
    //println("=============== needrepair: " + needrepair)
    //println("================= end select hive")
    
    df.repartition(partitionNum).write.mode("append").partitionBy(partitionkeys:_*).parquet(src.toUri().toString())
    copydir(fs, src, dest)
    
    //repair table
    if (needrepair) {
        //println("================= repair table")
        if(hiveContext.tableNames.contains(historyTableName)) {
            hiveContext.sql(repairSQL)
        }
        //println("================= end repair table")
    }
})

val retval = source1.map(i => "")   ]]></Script>
            </Model>
        </Node>
        <Node index="4004" uuid="b4c41092-f31d-4ad0-809f-b82569d544b5" type="Aggregate" label="Count Output Events" x="560" y="206" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:TestClass">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="9327217d-5098-4477-807b-3ee5d8b297d0">
                <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="tsepoch" label="tsepoch" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricname" label="metricname" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricvalue" label="metricvalue" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricuom" label="metricuom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="uomlabel" label="uomlabel" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="svc" label="svc" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="usr" label="usr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="shost" label="shost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="node" label="node" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="(Long,Long)">
              <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
              <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="" isClassRef="false">
              <Measures>
                <Measure type="count" field="" asName="count"/>
                <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
              </Measures>
              <Window enable="false" />
            </Model>
        </Node>
        <Node index="4005" uuid="1191f81c-7709-4100-8afd-2b5d3d3d8c2c" type="Compute" label="Conver to metrics (Output Events)" x="753" y="212" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="(Long,Long)">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="b4c41092-f31d-4ad0-809f-b82569d544b5">
                <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${motimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Total Output Events&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="count" outputType="string" alias="metric_value" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;sum&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Count&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${output_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="if(${output_stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${motimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${output_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="4006" uuid="73490184-781b-4acb-8f0e-500cca2f6ad9" type="Filter" label="Filter History Target" x="340" y="32" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:TestClass">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="83dcd221-9159-46d5-8fb4-b6c524c69c02">
                <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="tsepoch" label="tsepoch" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricname" label="metricname" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricvalue" label="metricvalue" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricuom" label="metricuom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="uomlabel" label="uomlabel" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="svc" label="svc" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="usr" label="usr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="shost" label="shost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="node" label="node" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:TestClass">
              <Field name="datekey" label="datekey" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="tsepoch" label="tsepoch" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricname" label="metricname" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricvalue" label="metricvalue" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricuom" label="metricuom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uomlabel" label="uomlabel" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="svc" label="svc" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dom" label="dom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="usr" label="usr" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="shost" label="shost" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dhost" label="dhost" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="node" label="node" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model filterModel="form">
              <Filters>
                <Filter field="" op="sleText" arg="" value="" sleText="&quot;${OPERATION_MODE}&quot; = &quot;History&quot; || &quot;${OPERATION_MODE}&quot; = &quot;Both&quot;"/>
              </Filters>
            </Model>
        </Node>
        <Node index="4007" uuid="a2992e48-a216-41c5-857a-5230e14d64a6" type="Filter" label="Filter Anomaly HDFS Target" x="340" y="120" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:TestClass">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="83dcd221-9159-46d5-8fb4-b6c524c69c02">
                <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="tsepoch" label="tsepoch" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricname" label="metricname" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricvalue" label="metricvalue" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricuom" label="metricuom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="uomlabel" label="uomlabel" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="svc" label="svc" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="usr" label="usr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="shost" label="shost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="node" label="node" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:TestClass">
              <Field name="datekey" label="datekey" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="tsepoch" label="tsepoch" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricname" label="metricname" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricvalue" label="metricvalue" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricuom" label="metricuom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uomlabel" label="uomlabel" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="svc" label="svc" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dom" label="dom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="usr" label="usr" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="shost" label="shost" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dhost" label="dhost" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="node" label="node" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model filterModel="form">
              <Filters>
                <Filter field="" op="sleText" arg="" value="" sleText="&quot;${OPERATION_MODE}&quot; = &quot;Anomaly&quot; || &quot;${OPERATION_MODE}&quot; = &quot;Both&quot;"/>
              </Filters>
            </Model>
        </Node>
        <Node index="4008" uuid="9327217d-5098-4477-807b-3ee5d8b297d0" type="Filter" label="Enable Audit Log" x="340" y="206" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:TestClass">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="83dcd221-9159-46d5-8fb4-b6c524c69c02">
                <Field name="datekey" label="datekey" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="tsepoch" label="tsepoch" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="host" label="host" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricname" label="metricname" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricvalue" label="metricvalue" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metricuom" label="metricuom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="uomlabel" label="uomlabel" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="svc" label="svc" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dom" label="dom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="usr" label="usr" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="shost" label="shost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="dhost" label="dhost" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="node" label="node" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:TestClass">
              <Field name="datekey" label="datekey" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="tsepoch" label="tsepoch" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="host" label="host" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricname" label="metricname" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricvalue" label="metricvalue" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="metricuom" label="metricuom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uomlabel" label="uomlabel" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="svc" label="svc" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dom" label="dom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="usr" label="usr" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="shost" label="shost" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="dhost" label="dhost" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="node" label="node" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model filterModel="form">
              <Filters>
                <Filter field="" op="sleText" arg="" value="" sleText="&quot;${output_doaudit}&quot; = &quot;True&quot; || &quot;${output_doaudit}&quot; = &quot;true&quot;"/>
              </Filters>
            </Model>
        </Node>
        <Node index="4009" uuid="e99c3916-b95e-42d2-8934-2213520a1964" type="outPort" label="Out" x="734" y="51" width="70" height="40">
            <Source name="source" uid="0" outputType="DStream" dataType="String">
              <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="cfde6cfb-7498-4b34-8dfc-62eb71da9bb4">
                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Model>
<Properties>
{}
</Properties>
            </Model>
        </Node>
        <Node index="4010" uuid="c36d7cb3-796a-4b7d-81b3-299bcebd9b6a" type="subflow" label="AuditLog" x="940" y="207" width="130" height="75">
            <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="1191f81c-7709-4100-8afd-2b5d3d3d8c2c">
                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/AuditLog","audit_parquetfolder":"${output_audit_table_folder}","source":"${output_source}"}
</Properties>
              <__subflow__>
              <Flow index="4010" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                <Node index="4010_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="4010_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{"type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="4010_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="AuditLogTable" isClassRef="true">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="4010_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                      <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                    </Model>
                </Node>
                <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_parquetfolder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_ingestion_auditlog","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false}]</Properties>
      <Types>[{"name":"AuditLogTable","schema":[{"name":"date_key","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_start_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_end_tm","type":"long","_isOptional":true,"_isArray":false},{"name":"metric_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_value","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_uom","type":"string","_isOptional":false,"_isArray":false},{"name":"uom_label","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group","type":"string","_isOptional":false,"_isArray":false},{"name":"system_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"process_type","type":"string","_isOptional":false,"_isArray":false},{"name":"aggr_type","type":"string","_isOptional":false,"_isArray":false},{"name":"source_fmt","type":"string","_isOptional":false,"_isArray":false},{"name":"source_tz","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group_prefix","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_key","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_value","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
              </Flow>
</__subflow__>
            </Model>
        </Node>
        <Link srcId="1191f81c-7709-4100-8afd-2b5d3d3d8c2c" srcPort="out:0" tgtId="c36d7cb3-796a-4b7d-81b3-299bcebd9b6a" tgtPort="din:0"/>
        <Link srcId="cfde6cfb-7498-4b34-8dfc-62eb71da9bb4" srcPort="dout:0" tgtId="e99c3916-b95e-42d2-8934-2213520a1964" tgtPort="in:0"/>
        <Link srcId="9327217d-5098-4477-807b-3ee5d8b297d0" srcPort="out:0" tgtId="b4c41092-f31d-4ad0-809f-b82569d544b5" tgtPort="in:0"/>
        <Link srcId="83dcd221-9159-46d5-8fb4-b6c524c69c02" srcPort="out:0" tgtId="9327217d-5098-4477-807b-3ee5d8b297d0" tgtPort="in:0"/>
        <Link srcId="73490184-781b-4acb-8f0e-500cca2f6ad9" srcPort="out:0" tgtId="cfde6cfb-7498-4b34-8dfc-62eb71da9bb4" tgtPort="din:0"/>
        <Link srcId="83dcd221-9159-46d5-8fb4-b6c524c69c02" srcPort="out:0" tgtId="73490184-781b-4acb-8f0e-500cca2f6ad9" tgtPort="in:0"/>
        <Link srcId="b4c41092-f31d-4ad0-809f-b82569d544b5" srcPort="dout:0" tgtId="1191f81c-7709-4100-8afd-2b5d3d3d8c2c" tgtPort="in:0"/>
        <Link srcId="83dcd221-9159-46d5-8fb4-b6c524c69c02" srcPort="out:0" tgtId="a2992e48-a216-41c5-857a-5230e14d64a6" tgtPort="in:0"/>
        <Link srcId="a2992e48-a216-41c5-857a-5230e14d64a6" srcPort="out:0" tgtId="16257540-b127-448a-8891-c8a71a46df04" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"number","*":{"label":"label","desc":"desc"},"name":"output_stopBatchCount","label":"Stop After n Microbatch","type":"integer","hidden":"false","disabled":false,"resolveProperty":false,"value":0,"constraints":{"min":"0","max":"999999","step":"1","places":"","maxLength":""},"runtimeControl":false},{"editorType":"sparkSelect","*":{"label":"label","desc":"desc","options.History":"constraints.args.options.0.label","options.Anomaly":"constraints.args.options.1.label","options.Both":"constraints.args.options.2.label"},"name":"OPERATION_MODE","label":"Operation Mode","desc":"Controls output target routing to History table and/or Anomaly HDFS Target","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Both","constraints":{"type":"sparkSelect","args":{"options":[{"label":"History","value":"History"},{"label":"Anomaly","value":"Anomaly"},{"label":"Both","value":"Both"}],"needPlaceholder":true,"multiple":false,"url":"http://10.101.7.163:18080/vitria-oi/rest/app/spark/space/VIAOps Ingestion/sparkm/VIAOps - Aggregate Output MetricReferenceData Template","_cid":"510cb45b-ed25-4eef-89de-952be285ee4c","name":"value"}},"runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"output_source_group","label":"Source Group","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"output_source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"motimezone","label":"Time Zone","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Etc/GMT","enumSource":"rest:/global/?op=get.timezones","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Target","name":"HISTORY_TABLE_FOLDER","label":"Spark SQL Table URL","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"fieldMultiSelect","*":{"label":"label","desc":"desc"},"group":"group","name":"output_partition_keys","label":"Partition Fields","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"controlValue":"","constraints":{"type":"fieldMultiSelect","args":{"nodeType":"primitive","sourcePrefix":false,"sourceName":"","expandArray":false,"types":["string","boolean","integer","long","double","float","date","time","datetime","array"]}},"sourceSchemaSensitive":true,"runtimeControl":false,"groupLabel":"Target"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Target","name":"history_table_name","label":"Spark SQL Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Target","name":"ANOMALY_TARGET_FILENAME","label":"Anomaly File URL","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"anomalyFileNamePrefix","label":"Anomaly File Name Prefix","type":"string","optional":"true","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false,"group":"group","groupLabel":"Target"},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Audit","name":"output_doaudit","label":"Audit Log","type":"boolean","hidden":"false","disabled":false,"resolveProperty":false,"value":"true","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Audit","name":"output_audit_table_folder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false}]</Properties>
      </Flow>
    </Flows>
  </ModelInfo>
</DataPipeModel>