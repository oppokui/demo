<DataPipeModel description="ADF Parser Model Template for Signal Onboarding" name="VIAOps - Parse Template V2" editBy="flow" is_init="false" useStreaming="auto" durableStreaming="false" streamingAutoStart="false" useHive="auto" batchDuration="P1M" runAsService="false" checkpoint="" batchSampling="true" sparkMasterHost="">
  <HiveConfig>
    <Properties>
      <Property name="hive.warehouse.hdfs.source" value=""/>
      <Property name="hive.metastore.data.source" value=""/>
      <Property name="hive.server2.thrift.port" value=""/>
      <Property name="hive.db.schema" value=""/>
    </Properties>
  </HiveConfig>
  <ModelInfo validated="true">
    <Pipes>
      <Pipe index="1000" uuid="" name="(main)">
      </Pipe>
    </Pipes>
    <Flows>
      <Flow index="1000" uuid="Main" isNested="false" revision="2275" name="Main" showFooter="true">
        <Node index="1001" uuid="2de76d39-43d2-45a3-8e28-06a02e3272a7" type="subflow" label="Source" x="0" y="180" width="157" height="95">
            <Output name="Out" uid="0" outputType="DStream" dataType="String">
              <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Output name="OutFileName" uid="1" outputType="DStream" dataType="(String,String)">
              <Field name="file" label="file" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion.so/FileSource","stopBatchCount":0,"fsource_source_group":"","fsource":"","vtimezone":"Etc/GMT","url":"","filter":".*","skipFirstLine":"false","maxBatchSize":"0","startOffset":"-10","sample":"metaname,TimeStamp,sitename,callattemptstotal","enableAudit":"true","auditUrl":"viaops_audit_parser"}
</Properties>
              <__subflow__>
              <Flow index="1001" uuid="FileSource" isNested="true" revision="5831" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion.so/FileSource" name="FileSource" showFooter="true">
                <Node index="1001_1" uuid="a30c6cac-828b-4812-86c7-7e31ca6c1b02" type="Adhoc" label="Transform" x="492" y="60" width="130" height="75">
                    <Source name="source1" uid="0" outputType="DStream" dataType="(String,String)">
                      <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="29887fd0-bfb2-40c6-8ee2-485810cd70bc">
                        <Field name="file" label="file" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out1" uid="0" outputType="DStream" dataType="String" referenceType="string">
                      <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[val retval = source1.map { case (name, data) =>
            data
        }]]></Script>
                    </Model>
                </Node>
                <Node index="1001_2" uuid="0aabd66a-c275-4691-8a6e-153b22beb785" type="outPort" label="Out" x="733" y="80" width="70" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="String">
                      <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="a30c6cac-828b-4812-86c7-7e31ca6c1b02">
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{}
</Properties>
                    </Model>
                </Node>
                <Node index="1001_3" uuid="9557aa47-7ea3-4193-8cfa-97199d1e4c82" type="Compute" label="Normalize" x="700" y="160" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Metric">
                      <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="2b85201b-32aa-4fed-87e6-bf67fe4c54c9">
                        <Field name="metricName" label="metricName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metricValue" label="metricValue" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metricUom" label="metricUom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uomLabel" label="uomLabel" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${vtimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time()) / 1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metricName" outputType="string" alias="metric_name" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metricValue" outputType="string" alias="metric_value" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metricUom" outputType="string" alias="metric_uom" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="uomLabel" outputType="string" alias="uom_label" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${fsource_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now()) / 1000" outputType="long" alias="system_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="if(${stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${vtimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${fsource_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="1001_4" uuid="2b85201b-32aa-4fed-87e6-bf67fe4c54c9" type="Adhoc" label="Metrics" x="490" y="160" width="130" height="75">
                    <Source name="source1" uid="0" outputType="DStream" dataType="(String,String)" referenceType="FileInfo">
                      <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="29887fd0-bfb2-40c6-8ee2-485810cd70bc">
                        <Field name="file" label="file" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out1" uid="0" outputType="DStream" dataType="class:Metric" referenceType="Metric">
                      <Field name="metricName" label="metricName" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metricValue" label="metricValue" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metricUom" label="metricUom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uomLabel" label="uomLabel" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[import scala.collection.immutable.HashSet
                val retval = source1.transform { rdd =>
                    val seq = if (${enableAudit}) {
                        val (set, cnt) = rdd.map { case(name, data) =>
                            (HashSet(name), 1L)
                        }.fold((HashSet(), 0L)) { (a, b) =>
                            (a._1 ++ b._1, a._2 + b._2)
                        }
                        val files = set.mkString(",")
                        if(cnt > 0) {
                            Seq(
                                Metric("Total Input Lines", cnt.toString, "sum", "Count"),
                                Metric("Files", files, "list", "List")
                            )
                        } else {
                            Seq()
                        }
                    } else {
                        Seq()
                    }
                    rdd.sparkContext.parallelize(seq, 1)
                }            ]]></Script>
                    </Model>
                </Node>
                <Node index="1001_5" uuid="29887fd0-bfb2-40c6-8ee2-485810cd70bc" type="Adhoc" label="File Source" x="220" y="60" width="130" height="75">
                    <Source name="source1" uid="0" outputType="DStream" dataType="String">
                      <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="67d00967-c0b2-4b14-8721-9f003aee65ba">
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out1" uid="0" outputType="DStream" dataType="(String,String)" referenceType="FileInfo">
                      <Field name="file" label="file" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[import org.apache.spark.streaming.dstream.FileSourceSettings
import org.apache.hadoop.fs.Path
import org.apache.hadoop.fs.FileStatus

val settings = new FileSourceSettings
val maxBatchSize =  ${maxBatchSize} * 1024L * 1024

settings.setMaxTotalFileSizePerBatch(maxBatchSize)
settings.setAlwaysStartedFromSpecifiedPosition(false)
settings.setInitialOffset("time")

if(${stopBatchCount} == 0){
    settings.enableState(true)
    settings.setStateFolder("${__flowIndex__}")
    var offset = (${startOffset} * 60 * 1000).toLong
    settings.setStateOffset(offset)
}

settings.put("isSkipFirstLine","${skipFirstLine}")

val sdf = new java.text.SimpleDateFormat("yyyy-MM-dd")

val startTime = if ("${startDate}" == "" || "${startDate}".contains("startDate")) {
    System.currentTimeMillis
} else if("${startDate}".contains("now")) {
    System.currentTimeMillis
} else {
    sdf.parse("${startDate}").getTime
}
settings.setStartTime(startTime)
val endTime = if ("${endDate}" == "" || "${endDate}".contains("endDate")) {
    -1L
} else if("${endDate}".contains("now")) {
    System.currentTimeMillis
} else {
    sdf.parse("${endDate}").getTime
}
settings.setEndTime(endTime)
val urls = "${url}".split(",").toSeq
val retval = TextStreamBuild.textFileStream(ssc, urls,"${filter}", settings, null, enrichFunc = Option((st : Map[String, FileStatus], filename : String) => filename)).filter(line => !line._2.isEmpty())]]></Script>
                      <shellScript><![CDATA[{"global":"","custom_func":"    import com.vitria.spark.streaming.api.scala.source.SourceUtil._\n    import com.vitria.spark.streaming.api.scala.source.NameFilter\n    import org.apache.spark.sql.functions.input_file_name\n    import org.apache.hadoop.fs.{FileSystem, Path}\n    \n    val endMarkerToken__4001: String = \"_VTEND_\"\n    val endMakerRDD__4001 = sc.makeRDD(Array((endMarkerToken__4001, endMarkerToken__4001)), 1)\n    //val accum = sc.accumulator(0, \"End Accumulator\")\n    def _endMarkerFilter__4001(source1: DStream[(String, String)]): DStream[(String, String)] = {\n        val retval = source1.filter { case(file, data) => \n            data.contains(\"_VTEND_\") == false\n        }\n        retval\n    }\n    // Simulate Stream... use full package name for Queue to avoid potential conflict with java.util.Queue\n    var data: Array[String] = Array[String]()\n    var rs: Array[(String, String)] = Array[(String, String)]()\n    var rdd: RDD[(String, String)] = null\n    \n    val urls = \"${url}\".split(\",\")\n    val startDate = \"${startDate}\"\n    val endDate = \"${endDate}\"\n    val filter = \"${filter}\"\n    \n    val sdf = new java.text.SimpleDateFormat(\"yyyy-MM-dd\")\n    \n    val startTime = if (\"${startDate}\" == \"\" || \"${startDate}\".contains(\"startDate\")) {\n        0L\n    } else if(\"${startDate}\".contains(\"now\")) {\n        System.currentTimeMillis\n    } else {\n        sdf.parse(\"${startDate}\").getTime\n    }\n    val endTime = if (\"${endDate}\" == \"\" || \"${endDate}\".contains(\"endDate\")) {\n        -1L\n    } else if(\"${endDate}\".contains(\"now\")) {\n        System.currentTimeMillis\n    } else {\n        sdf.parse(\"${endDate}\").getTime\n    }    \n    \n    val filePattern = filter.r\n    val limit = 1024L * 1024 * 2\n    var size = 0L    \n    rdd = sc.union(urls.map(new Path(_)).flatMap { url =>\n      FileSystem.get(url.toUri, sc.hadoopConfiguration).listStatus(url).filter { status =>\n        if (status.isDirectory)\n          false\n        else if (status.getModificationTime < startTime)\n          false\n        else if (status.getModificationTime > endTime && endTime > 0)\n          false\n        else {\n          val name = status.getPath.getName\n          if (name.startsWith(\".\") || name.startsWith(\"_\"))\n            false\n          else if (filePattern.findFirstIn(name) == None)\n            false\n          else\n            true\n        }\n      }\n    }.sortBy(_.getModificationTime).filter { status =>\n      val before = size\n      size += status.getLen\n      before == 0 || size < limit\n    }.map { status =>\n      val path = status.getPath.toString\n      sc.textFile(path).filter(!_.isEmpty).map((path, _))\n    })\n    rs = rdd.take(10)\n    data = rs.map {case(file, data) => \n        data\n    }\n    if (data.length == 0) {\n        data = \"${sample}\".split(\"\\\\n\").map(_.trim)\n    }\n    \n    if (rs.length == 0) {\n      rs = data.map { x => {\n        val line = x.trim()\n        if (!line.startsWith(\"(\")) {\n          (\"N/A\", x)\n        } else {\n          val tmp = line.substring(line.indexOf(\"(\") + 1, line.indexOf(\")\"))\n          (tmp.substring(0, tmp.indexOf(\",\")), tmp.substring(tmp.indexOf(\",\") + 1))\n        }\n      }\n      }\n    }\n\n    val queue = scala.collection.mutable.Queue(sc.parallelize(rs))\n\n    val textSource = QueueStreamBuild.queueStream(ssc, queue, true, endMakerRDD__4001)\n    textSource.foreachRDD(rdd => {\n      rdd.foreach{ case(file, data) =>\n        if (data == \"_VTEND_\") {\n          accum += 1\n        }\n      }\n    })\n    val retval = _endMarkerFilter__4001(textSource)    "}]]></shellScript>
                    </Model>
                </Node>
                <Node index="1001_6" uuid="e2b231bc-52ff-4d33-8235-8424774dfd0f" type="subflow" label="FileAuditLog" x="920" y="160" width="130" height="75">
                    <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="9557aa47-7ea3-4193-8cfa-97199d1e4c82">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/AuditLog","audit_parquetfolder":"${auditUrl}","source":"${fsource}"}
</Properties>
                      <__subflow__>
                      <Flow index="1001_6" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                        <Node index="1001_6_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1001_6_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Model>
<Properties>
{"type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1001_6_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model _caseClass="AuditLogTable" isClassRef="true">
                              <Computes>
                                <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                              </Computes>
                              <CheckboxStatus isChecked="false"/>
                            </Model>
                        </Node>
                        <Node index="1001_6_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                              <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                            </Model>
                        </Node>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                        <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_parquetfolder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"${auditUrl}","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"${fsource}","enumSource":"","runtimeControl":false}]</Properties>
      <Types>[{"name":"AuditLogTable","schema":[{"name":"date_key","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_start_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_end_tm","type":"long","_isOptional":true,"_isArray":false},{"name":"metric_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_value","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_uom","type":"string","_isOptional":false,"_isArray":false},{"name":"uom_label","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group","type":"string","_isOptional":false,"_isArray":false},{"name":"system_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"process_type","type":"string","_isOptional":false,"_isArray":false},{"name":"aggr_type","type":"string","_isOptional":false,"_isArray":false},{"name":"source_fmt","type":"string","_isOptional":false,"_isArray":false},{"name":"source_tz","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group_prefix","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_key","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_value","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
                      </Flow>
</__subflow__>
                      <__binding__><![CDATA[{"source":""}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1001_7" uuid="67d00967-c0b2-4b14-8721-9f003aee65ba" type="Adhoc" label="Auto Stop" x="31" y="60" width="130" height="75">
                    <Output name="Out1" uid="0" outputType="DStream" dataType="String" referenceType="string">
                      <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[var cnt = 0
        val total = ${stopBatchCount}
        val dummy = new org.apache.spark.streaming.dstream.VTDummyDStream(ssc)
        dummy.foreachRDD{(rdd, time) => 
            if (total > 0 && cnt >= total) {
                logger.warn("Stopping ADF model call started")
                com.vitria.spark.api.scala.SparkAppExceptionHanlders.stopProject()
                logger.warn("Stopping ADF model call finished")
            } else {
                cnt = cnt + 1
            }
        }
        val retval: DStream[String] = null]]></Script>
                      <shellScript><![CDATA[{"custom_func":"    val retval = ssc.queueStream(scala.collection.mutable.Queue(sc.emptyRDD[String]))"}]]></shellScript>
                    </Model>
                </Node>
                <Node index="1001_8" uuid="3851fd83-fa56-4af0-8dfe-d49fbd53f395" type="outPort" label="OutFileName" x="732" y="20" width="100.6875" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="(String,String)">
                      <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="29887fd0-bfb2-40c6-8ee2-485810cd70bc">
                        <Field name="file" label="file" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{}
</Properties>
                    </Model>
                </Node>
                <Link srcId="29887fd0-bfb2-40c6-8ee2-485810cd70bc" srcPort="dout:0" tgtId="2b85201b-32aa-4fed-87e6-bf67fe4c54c9" tgtPort="din:0"/>
                <Link srcId="67d00967-c0b2-4b14-8721-9f003aee65ba" srcPort="dout:0" tgtId="29887fd0-bfb2-40c6-8ee2-485810cd70bc" tgtPort="din:0"/>
                <Link srcId="29887fd0-bfb2-40c6-8ee2-485810cd70bc" srcPort="dout:0" tgtId="3851fd83-fa56-4af0-8dfe-d49fbd53f395" tgtPort="in:0"/>
                <Link srcId="9557aa47-7ea3-4193-8cfa-97199d1e4c82" srcPort="out:0" tgtId="e2b231bc-52ff-4d33-8235-8424774dfd0f" tgtPort="din:0"/>
                <Link srcId="2b85201b-32aa-4fed-87e6-bf67fe4c54c9" srcPort="dout:0" tgtId="9557aa47-7ea3-4193-8cfa-97199d1e4c82" tgtPort="in:0"/>
                <Link srcId="a30c6cac-828b-4812-86c7-7e31ca6c1b02" srcPort="dout:0" tgtId="0aabd66a-c275-4691-8a6e-153b22beb785" tgtPort="in:0"/>
                <Link srcId="29887fd0-bfb2-40c6-8ee2-485810cd70bc" srcPort="dout:0" tgtId="a30c6cac-828b-4812-86c7-7e31ca6c1b02" tgtPort="din:0"/>
      <Codes>
      </Codes>
      <Libraries>
          <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/bin/client/jboss-client.jar"/>
          <Lib scope="system" systemPath="${VTBA_HOME}/spark/library/vitria-spark-library.jar"/>
          <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/com/vitria/vtlibs/main/vtclient.jar"/>
          <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/com/vitria/vtlibs/main/vtfc.jar"/>
          <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/com/vitria/vtlibs/main/vtclusterservice.jar"/>
          <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/system/layers/base/org/hornetq/main/hornetq-core-client-2.4.7.Final.jar"/>
          <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/system/layers/base/org/hornetq/main/hornetq-jms-client-2.4.7.Final.jar"/>
          <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/system/layers/base/org/hornetq/main/hornetq-commons-2.4.7.Final.jar"/>
          <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/com/vitria/thirdparty/xmlbeans/main/xmlbeans-2.3.0.jar"/>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"number","*":{"label":"label","desc":"desc"},"name":"stopBatchCount","label":"Stop After n Microbatch","type":"integer","hidden":"false","disabled":false,"resolveProperty":false,"value":0,"constraints":{"min":"0","max":"999999","step":"1","places":"","maxLength":""},"runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"fsource_source_group","label":"Source Group","desc":"Source Group of Metrics","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"fsource","label":"Source Group Prefix","desc":"The source name","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"vtimezone","label":"Time Zone","desc":"The timezone to calculate date","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Etc/GMT","defaultValueForExisted":"Europe/London","enumSource":"rest:/global/?op=get.timezones","runtimeControl":false},{"*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Source","name":"url","label":"File URL","desc":"The File URL to monitor. It can be directories list delimited by comma","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Source","name":"filter","label":"File Filter","desc":"The file filter regular expression","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":".*","enumSource":"","runtimeControl":false},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group","name":"skipFirstLine","label":"Skip First Line","type":"boolean","hidden":"false","disabled":false,"resolveProperty":false,"value":"false","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Source","name":"maxBatchSize","label":"Max Batch Size (MB)","desc":"The max file size which will be processed in one batch","type":"string","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"value":"0","enumSource":"","runtimeControl":false},{"editorType":"date","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Source","name":"startDate","label":"Start Date","desc":"The start date constraint and empty means starting from oldest","type":"date","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"constraints":{"itemStyle":"width: 200px;","supportNow":true,"supportClear":"true"},"runtimeControl":false},{"editorType":"date","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Source","name":"endDate","label":"End Date","desc":"End date constraint and empty means always process to latest time","type":"date","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"constraints":{"itemStyle":"width: 200px;","supportNow":true,"supportClear":"true"},"runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","name":"startOffset","label":"Start Offset (Minutes)","type":"long","hidden":"false","disabled":false,"resolveProperty":false,"value":-10,"enumSource":"","runtimeControl":false},{"editorType":"sourceSample","*":{"label":"label","desc":"desc"},"name":"sample","label":"Sample Data","type":"string","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","constraints":{"type":"sourceSample","args":{"rows":"4","itemStyle":"height: auto;width: calc(100% - 54px);"},"impactSchema":true},"excluded":true,"runtimeControl":false,"group":"group","groupLabel":"Source","defaultVal":""},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group1","groupLabel":"Audit","name":"enableAudit","label":"Audit Log","desc":"A flag to control whether enable audit log","type":"boolean","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"true","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group1","groupLabel":"Audit","name":"auditUrl","label":"Audit Log Table","desc":"The audit table name","type":"string","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser","enumSource":"","runtimeControl":false}]</Properties>
      <Types>[{"name":"Metric","namespace":"","schema":[{"name":"metricName","type":"string","_isOptional":false,"_isArray":false},{"name":"metricValue","type":"string","_isOptional":false,"_isArray":false},{"name":"metricUom","type":"string","_isOptional":false,"_isArray":false},{"name":"uomLabel","type":"string","_isOptional":false,"_isArray":false}]},{"name":"FileInfo","namespace":"","schema":[{"name":"file","type":"string","_isOptional":false,"_isArray":false},{"name":"data","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"stopBatchCount":"stop_after_batch","fsource_source_group":"source_group","vtimezone":"time_zone","url":"file_url","filter":"file_filter","maxBatchSize":"max_batch_size","startDate":"start_date","endDate":"end_date","enableAudit":"enableAudit","auditUrl":"auditUrl","fsource":"source_group_prefix","skipFirstLine":"isSkipFirstLine"}]]></__binding__>
            </Model>
        </Node>
        <Node index="1002" uuid="e868221a-6f4c-4cb2-8e22-64d2766f9dee" type="Parse" label="Parse CSV" x="293" y="180" width="103" height="95">
            <Source name="source" uid="0" outputType="DStream" dataType="String">
              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="54ceaf9d-aa1d-41dc-8fdc-b802ca15c33f">
                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="Out1" uid="0" outputType="DStream" dataType="class:InputData">
              <Field name="metaname" label="metaname" type="string" isArray="false" isOptional="false"/>
              <Field name="TimeStamp" label="TimeStamp" type="datetime" isArray="false" isOptional="false"/>
              <Field name="sitename" label="sitename" type="string" isArray="false" isOptional="false"/>
              <Field name="callattemptstotal" label="callattemptstotal" type="long" isArray="false" isOptional="true"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Output name="Dropped" uid="1" outputType="DStream" dataType="(String,String)">
              <Field name="___error___" label="error" type="string" isArray="false" isOptional="false"/>
              <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model format="csv" delimiterType="csv" caseClass="InputData" isClassRef="false" fromHeader="true" addable="true" dropEvent="true" header="metaname,TimeStamp,sitename,callattemptstotal" timezone="Etc/UTC" daylight="false">
              <Schema>
                <Field name="metaname" initName="metaname" label="metaname" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" excluded="false"/>
                <Field name="TimeStamp" initName="TimeStamp" label="TimeStamp" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="false" excluded="false"/>
                <Field name="sitename" initName="sitename" label="sitename" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false" excluded="false"/>
                <Field name="callattemptstotal" initName="callattemptstotal" label="callattemptstotal" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="true" excluded="false"/>
              </Schema>
            </Model>
        </Node>
        <Node index="1003" uuid="ca1449c3-e067-4eb8-8456-20fce30eb6ae" type="Adhoc" label="Pivot" x="1080" y="180" width="140" height="75">
            <Source name="source1" uid="0" outputType="DStream" dataType="class:DerivedField">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="ec070983-cbfe-45c9-8914-ed1d5d1f4e7f">
                <Field name="metaname" label="metaname" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="TimeStamp" label="TimeStamp" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="sitename" label="sitename" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="callattemptstotal" label="callattemptstotal" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="field_1" label="field_1" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="PivotOut" uid="0" outputType="DStream" dataType="class:Pivot" referenceType="Pivot">
              <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="metaName" label="metaName" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
              <Script><![CDATA[
// The actual Scala code is set by Model Generator
val retval = source1.vtMap(e => Pivot (
    e.TimeStamp,
    e.metaname,
    e.sitename,
    "call attempts total",
    e.callattemptstotal.getOrElse(0),
    "sum"
))
]]></Script>
            </Model>
        </Node>
        <Node index="1006" uuid="fab3627f-d1c5-4d10-8a96-0a435dd85f0d" type="Compute" label="Normalize" x="1480" y="180" width="104" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:Pivot">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="a036ec9f-3f0d-4b26-84c4-eed72e031dcb">
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:Output">
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="agc_name" label="agc_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="agc_id" label="agc_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="meta_name" label="meta_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="Output" isClassRef="true">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="0" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="0" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="app" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="0" outputType="long" alias="system_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="process_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="0" outputType="double" alias="metric_value" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="agc_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="agc_id" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="location" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="meta_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="0" outputType="long" alias="date_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="1007" uuid="896d579d-efc3-4f59-8046-ba4d83e30a58" type="subflow" label="Target" x="1660" y="180" width="100" height="77">
            <Source name="source1" uid="0" outputType="DStream" dataType="class:Output">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="fab3627f-d1c5-4d10-8a96-0a435dd85f0d">
                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="agc_name" label="agc_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="agc_id" label="agc_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="meta_name" label="meta_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="Out" uid="0" outputType="DStream" dataType="String">
              <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/MetricOutput","output_stopBatchCount":0,"OPERATION_MODE":"Both","output_source_group":"","output_source":"","motimezone":"Etc/GMT","HISTORY_TABLE_FOLDER":"","history_table_name":"","output_partition_keys":["date_key","metric_name"],"ANOMALY_TARGET_FILENAME":"","anomalyFileNamePrefix":"","keys":["metric_name"],"drop_sparksqltable":"viaops_audit_parser_dropped","drop_metric_name":"Total Duplicate Events","output_doaudit":"true","output_audit_table_folder":"viaops_audit_parser"}
</Properties>
              <__subflow__>
              <Flow index="1007" uuid="MetricOutput" isNested="true" revision="4405" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/MetricOutput" name="MetricOutput" showFooter="true">
                <Node index="1007_1" uuid="83dcd221-9159-46d5-8fb4-b6c524c69c02" type="inPort" label="source1" x="90" y="120" width="72.703125" height="40">
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Output" referenceType="viaops.ingestion.MetricCommonFields">
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="agc_name" label="agc_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="agc_id" label="agc_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="meta_name" label="meta_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.MetricCommonFields","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1007_2" uuid="16257540-b127-448a-8891-c8a71a46df04" type="StreamTarget" label="Stream to Anomaly Detection" x="760" y="100" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Output">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="a2992e48-a216-41c5-857a-5230e14d64a6">
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_name" label="agc_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_id" label="agc_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="meta_name" label="meta_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Output">
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="agc_name" label="agc_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="agc_id" label="agc_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="meta_name" label="meta_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="file" url="${ANOMALY_TARGET_FILENAME}" namePrefix="${anomalyFileNamePrefix}" format="json" partitionNum="1" dataSpeed="" dataVolume="">
                      <__binding__><![CDATA[{"fileNamePrefix":""}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1007_3" uuid="cfde6cfb-7498-4b34-8dfc-62eb71da9bb4" type="Adhoc" label="Persist History Table" x="760" y="9" width="130" height="75">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:Output">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="73490184-781b-4acb-8f0e-500cca2f6ad9">
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_name" label="agc_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_id" label="agc_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="meta_name" label="meta_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out1" uid="0" outputType="DStream" dataType="String" referenceType="string">
                      <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[
import org.apache.hadoop.conf.Configuration
import org.apache.hadoop.fs.{FileStatus, FileSystem, Path}
import java.net.URI
import org.apache.hadoop.fs.PathFilter
import java.util.UUID

def copydir(fs: FileSystem, src: Path, dest: Path): Unit = {
    val children = fs.listStatus(src)
    children.foreach(child => {
        val targetPath = new Path(dest, child.getPath.getName)
        if (child.isDirectory()) {
            val result = fs.mkdirs(targetPath)
            copydir(fs, child.getPath, targetPath)
        } else if (!"_SUCCESS".equals(child.getPath.getName)) {
            var realtarget = new Path(dest, "${output_source}-"+child.getPath.getName)
            if (fs.exists(targetPath)) {
                realtarget = new Path(dest, "${output_source}-"+UUID.randomUUID.toString+"-"+child.getPath.getName)
            }
            fs.rename(child.getPath, realtarget)
        }
    })
    fs.delete(src, true)
}

def getKeyValues(fs: FileSystem, folderName: String, key: String) : Array[String] = {
    val statuses: Array[FileStatus] = fs.listStatus(new Path(folderName))
    val keyvalues: Array[String] = statuses.filter(_.isDirectory).map(_.getPath.getName).filter(_.startsWith(key + "="))
    keyvalues
}

def getSubfolder(fs: FileSystem, folderName: String, keys: Array[String]) : Array[String] = {
    if (keys.length == 0) {
        Array[String]()
    } else {
        val currentkey = keys(0)
        val keyvalues = getKeyValues(fs, folderName, currentkey)

        if (keys.length > 1) {
            keyvalues.flatMap(kv => {
                val subkeyvalues = getSubfolder(fs, folderName.concat("/").concat(kv), keys.drop(1)).map(kv.concat(",").concat(_))
                subkeyvalues
            })
        } else {
            keyvalues
        }
    }
}

def folderNotExist(fs: FileSystem, baseName: String, subName: String): Boolean = {
    !fs.exists(new Path(baseName, subName))
}

val basefolder = "${HISTORY_TABLE_FOLDER}"
val tempfolder = java.util.UUID.randomUUID.toString
//   val tempfolder = "${__flowIndex__}"
val partitionkeys = "${output_partition_keys}".replaceAll("\\[|\\]", "").split(',').map(x => x.trim())

//prepare sql
val historyTableName = "${history_table_name}"
val tempSB = new StringBuilder()
val selectSQL = """select distinct concat(""" + partitionkeys.map(k => s"""concat("$k=", $k)""").addString(tempSB, """ , "/" , """) + s""") from tempMetricOutput"""
//println("==================" + selectSQL)
val repairSQL = "MSCK REPAIR TABLE %s".format(historyTableName)
//println("==================" + repairSQL)
val partitionNum: Int = 1

source1.foreachRDD(rdd => {
    val fs = FileSystem.get(URI.create(basefolder), new Configuration)
    
    //println("================= start get partition")
    //val partitions: Array[String] = if (fs.exists(new Path(basefolder))) {getSubfolder(fs, basefolder, partitionkeys)} else {Array[String]()}
    //println("================= end get partition")
    //partitions.foreach(println)
    
    var needrepair: Boolean = false
    
    val src = new Path(basefolder, tempfolder)
    val dest = new Path(basefolder)
    val df = hiveContext.createDataFrame(rdd)
    
    df.createOrReplaceTempView("tempMetricOutput")
    //println("================= start select hive")
    val arrayP = hiveContext.sql(selectSQL).map(_.getString(0)).collect()
    needrepair = arrayP.exists(ps => folderNotExist(fs, basefolder, ps))
    
    //arrayP.foreach(pvalue => {
    //    println("===============" + pvalue)
    //})
    //println("=============== needrepair: " + needrepair)
    //println("================= end select hive")
    
    df.repartition(partitionNum).write.mode("append").partitionBy(partitionkeys:_*).parquet(src.toUri().toString())
    copydir(fs, src, dest)
    
    //repair table
    if (needrepair) {
        //println("================= repair table")
        if(hiveContext.tableNames.contains(historyTableName)) {
            hiveContext.sql(repairSQL)
        }
        //println("================= end repair table")
    }
})

val retval = source1.map(i => "")   ]]></Script>
                    </Model>
                </Node>
                <Node index="1007_4" uuid="b4c41092-f31d-4ad0-809f-b82569d544b5" type="Aggregate" label="Count Output Events" x="760" y="192" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Output">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="9327217d-5098-4477-807b-3ee5d8b297d0">
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_name" label="agc_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_id" label="agc_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="meta_name" label="meta_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="(Long,Long)">
                      <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
                      <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="" isClassRef="false">
                      <Measures>
                        <Measure type="count" field="" asName="count"/>
                        <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
                      </Measures>
                      <Window enable="false" />
                    </Model>
                </Node>
                <Node index="1007_5" uuid="1191f81c-7709-4100-8afd-2b5d3d3d8c2c" type="Compute" label="Conver to metrics (Output Events)" x="953" y="192" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="(Long,Long)">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="b4c41092-f31d-4ad0-809f-b82569d544b5">
                        <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${motimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;Total Output Events&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="count" outputType="string" alias="metric_value" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;sum&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;Count&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${output_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="if(${output_stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${motimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${output_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="1007_6" uuid="73490184-781b-4acb-8f0e-500cca2f6ad9" type="Filter" label="Filter History Target" x="532" y="9" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Output">
                      <DataSource category="#OUTPUT" id="undefined" name="output" nodeId="08a937b8-7c88-42ec-83c3-fbefc3631a78">
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_name" label="agc_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_id" label="agc_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="meta_name" label="meta_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Output">
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="agc_name" label="agc_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="agc_id" label="agc_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="meta_name" label="meta_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model filterModel="form">
                      <Filters>
                        <Filter field="" op="sleText" arg="" value="" sleText="&quot;${OPERATION_MODE}&quot; = &quot;History&quot; || &quot;${OPERATION_MODE}&quot; = &quot;Both&quot;"/>
                      </Filters>
                    </Model>
                </Node>
                <Node index="1007_7" uuid="a2992e48-a216-41c5-857a-5230e14d64a6" type="Filter" label="Filter Anomaly HDFS Target" x="532" y="100" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Output">
                      <DataSource category="#OUTPUT" id="undefined" name="output" nodeId="08a937b8-7c88-42ec-83c3-fbefc3631a78">
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_name" label="agc_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_id" label="agc_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="meta_name" label="meta_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Output">
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="agc_name" label="agc_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="agc_id" label="agc_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="meta_name" label="meta_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model filterModel="form">
                      <Filters>
                        <Filter field="" op="sleText" arg="" value="" sleText="&quot;${OPERATION_MODE}&quot; = &quot;Anomaly&quot; || &quot;${OPERATION_MODE}&quot; = &quot;Both&quot;"/>
                      </Filters>
                    </Model>
                </Node>
                <Node index="1007_8" uuid="9327217d-5098-4477-807b-3ee5d8b297d0" type="Filter" label="Enable Audit Log" x="528" y="192" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Output">
                      <DataSource category="#OUTPUT" id="undefined" name="output" nodeId="08a937b8-7c88-42ec-83c3-fbefc3631a78">
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_name" label="agc_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_id" label="agc_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="meta_name" label="meta_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Output">
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="agc_name" label="agc_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="agc_id" label="agc_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="meta_name" label="meta_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model filterModel="form">
                      <Filters>
                        <Filter field="" op="sleText" arg="" value="" sleText="&quot;${output_doaudit}&quot; = &quot;True&quot; || &quot;${output_doaudit}&quot; = &quot;true&quot;"/>
                      </Filters>
                    </Model>
                </Node>
                <Node index="1007_9" uuid="e99c3916-b95e-42d2-8934-2213520a1964" type="outPort" label="Out" x="960" y="29" width="70" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="String">
                      <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="cfde6cfb-7498-4b34-8dfc-62eb71da9bb4">
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{}
</Properties>
                    </Model>
                </Node>
                <Node index="1007_10" uuid="c36d7cb3-796a-4b7d-81b3-299bcebd9b6a" type="subflow" label="AuditLog" x="1140" y="192" width="130" height="75">
                    <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="1191f81c-7709-4100-8afd-2b5d3d3d8c2c">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/AuditLog","audit_parquetfolder":"${output_audit_table_folder}","source":"${output_source}"}
</Properties>
                      <__subflow__>
                      <Flow index="1007_10" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                        <Node index="1007_10_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1007_10_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Model>
<Properties>
{"type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1007_10_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model _caseClass="AuditLogTable" isClassRef="true">
                              <Computes>
                                <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                              </Computes>
                              <CheckboxStatus isChecked="false"/>
                            </Model>
                        </Node>
                        <Node index="1007_10_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                              <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                            </Model>
                        </Node>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                        <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_parquetfolder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"${output_audit_table_folder}","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"${output_source}","enumSource":"","runtimeControl":false}]</Properties>
      <Types>[{"name":"AuditLogTable","schema":[{"name":"date_key","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_start_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_end_tm","type":"long","_isOptional":true,"_isArray":false},{"name":"metric_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_value","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_uom","type":"string","_isOptional":false,"_isArray":false},{"name":"uom_label","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group","type":"string","_isOptional":false,"_isArray":false},{"name":"system_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"process_type","type":"string","_isOptional":false,"_isArray":false},{"name":"aggr_type","type":"string","_isOptional":false,"_isArray":false},{"name":"source_fmt","type":"string","_isOptional":false,"_isArray":false},{"name":"source_tz","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group_prefix","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_key","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_value","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
                      </Flow>
</__subflow__>
                    </Model>
                </Node>
                <Node index="1007_11" uuid="08a937b8-7c88-42ec-83c3-fbefc3631a78" type="removeDuplicateMetrics" label="Remove Duplicate Metrics" x="232" y="100" width="130" height="95">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Output">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="83dcd221-9159-46d5-8fb4-b6c524c69c02">
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_name" label="agc_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="agc_id" label="agc_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="meta_name" label="meta_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="output" uid="0" outputType="DStream" dataType="class:Output">
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="agc_name" label="agc_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="agc_id" label="agc_id" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="meta_name" label="meta_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="dropped" uid="1" outputType="DStream" dataType="(String, String)">
                      <Field name="error" label="error" type="string" isArray="false" isOptional="false"/>
                      <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"keys":["metric_name"],"value":"aggr_start_tm","enable":"${output_stopBatchCount} == 0"}
</Properties>
                      <__binding__><![CDATA[{"keys":"keys"}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1007_12" uuid="527a713d-a02e-42b4-81c8-1f6799192af1" type="subflow" label="Log Duplicate Metrics" x="527" y="300" width="130" height="75">
                    <Source name="In" uid="0" outputType="DStream" dataType="(String, String)">
                      <DataSource category="#OUTPUT" id="undefined" name="dropped" nodeId="08a937b8-7c88-42ec-83c3-fbefc3631a78">
                        <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/DroppedEvents","stopBatchCount":0,"drop_source_group":"","drop_source":"","vtimezone":"Etc/GMT","drop_sparksqltable":"","drop_metric_name":"Total Duplicate Events","enableAudit":"false","auditTable":"viaops_audit_parser"}
</Properties>
                      <__subflow__>
                      <Flow index="1007_12" uuid="DroppedEvents" isNested="true" revision="809" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/DroppedEvents" name="DroppedEvents" showFooter="true">
                        <Node index="1007_12_1" uuid="cd64c670-6c5f-440e-8b66-441c760166d8" type="inPort" label="In" x="240" y="30" width="70" height="40">
                            <Output name="Out" uid="0" outputType="DStream" dataType="(String, String)" referenceType="viaops.ingestion.DroppedEvents">
                              <Field name="error" label="error" type="string" isArray="false" isOptional="false"/>
                              <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.DroppedEvents","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1007_12_2" uuid="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" type="Compute" label="to Dropped Events" x="366" y="10" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="(String, String)">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="cd64c670-6c5f-440e-8b66-441c760166d8">
                                <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model _caseClass="toDroppedEvents_Class" isClassRef="false" udfs="generate_datekey">
                              <Computes>
                                <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${vtimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${drop_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${drop_source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="error" outputType="string" alias="error" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="data" outputType="string" alias="event" wordWarp="true"/>
                              </Computes>
                              <CheckboxStatus isChecked="mixed"/>
                            </Model>
                        </Node>
                        <Node index="1007_12_3" uuid="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" type="StreamTarget" label="write to Hive" x="560" y="9" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="event" label="event" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model type="hiveTable" tableName="${drop_sparksqltable}" partitionType="eventField" partitionSize="" partitionColumn="date_key" partitionIndex="0" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                            </Model>
                        </Node>
                        <Node index="1007_12_4" uuid="dd779a23-bc63-4200-8e22-05639b978a68" type="outPort" label="Out" x="746" y="29" width="70" height="40">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="event" label="event" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Model>
<Properties>
{"type":{"name":"viaops.ingestion.DroppedEvents","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1007_12_5" uuid="4efed069-fbe4-42b4-84f5-418fa5488257" type="Compute" label="Conver to metrics (Dropped Events)" x="760" y="120" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="Long">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="328fbd82-fdae-41c6-8c16-c241c5f6da38">
                                <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                              <Computes>
                                <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${vtimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${drop_metric_name}&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="cast(count, &quot;string&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;sum&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;Count&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${drop_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="if(${stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${vtimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${drop_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                              </Computes>
                              <CheckboxStatus isChecked="false"/>
                            </Model>
                        </Node>
                        <Node index="1007_12_6" uuid="328fbd82-fdae-41c6-8c16-c241c5f6da38" type="Aggregate" label="Count Dropped Events" x="560" y="120" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="(String, String)">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9">
                                <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="Long">
                              <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model _caseClass="" isClassRef="false">
                              <Measures>
                                <Measure type="count" field="" asName="count"/>
                              </Measures>
                              <Window enable="false" />
                            </Model>
                        </Node>
                        <Node index="1007_12_7" uuid="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" type="Filter" label="Do Audit Log" x="367" y="120" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="(String, String)">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="cd64c670-6c5f-440e-8b66-441c760166d8">
                                <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="(String, String)">
                              <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model filterModel="form">
                              <Filters>
                                <Filter field="" op="sleText" arg="" value="" sleText="&quot;${enableAudit}&quot; = &quot;True&quot; || &quot;${enableAudit}&quot; = &quot;true&quot;"/>
                              </Filters>
                            </Model>
                        </Node>
                        <Node index="1007_12_8" uuid="9685d7b8-be25-4b6a-87c3-c7be75074079" type="subflow" label="Log Dropped Event Metric" x="970" y="120" width="130" height="75">
                            <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="4efed069-fbe4-42b4-84f5-418fa5488257">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/AuditLog","audit_parquetfolder":"${auditTable}","source":"${drop_source}"}
</Properties>
                              <__subflow__>
                              <Flow index="1007_12_8" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                                <Node index="1007_12_8_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                                    </Output>
                                    <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                                    </Model>
                                </Node>
                                <Node index="1007_12_8_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                      </DataSource>
                                    </Source>
                                    <Model>
<Properties>
{"type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                                    </Model>
                                </Node>
                                <Node index="1007_12_8_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                      </DataSource>
                                    </Source>
                                    <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                                    </Output>
                                    <Model _caseClass="AuditLogTable" isClassRef="true">
                                      <Computes>
                                        <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                                      </Computes>
                                      <CheckboxStatus isChecked="false"/>
                                    </Model>
                                </Node>
                                <Node index="1007_12_8_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                                    <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                      </DataSource>
                                    </Source>
                                    <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                                    </Output>
                                    <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                                      <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                                    </Model>
                                </Node>
                                <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                                <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                                <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_parquetfolder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"${auditTable}","enumSource":"","runtimeControl":false,"defaultVal":"viaops_ingestion_auditlog"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"${drop_source}","enumSource":"","runtimeControl":false,"defaultVal":""}]</Properties>
      <Types>[{"name":"AuditLogTable","schema":[{"name":"date_key","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_start_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_end_tm","type":"long","_isOptional":true,"_isArray":false},{"name":"metric_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_value","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_uom","type":"string","_isOptional":false,"_isArray":false},{"name":"uom_label","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group","type":"string","_isOptional":false,"_isArray":false},{"name":"system_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"process_type","type":"string","_isOptional":false,"_isArray":false},{"name":"aggr_type","type":"string","_isOptional":false,"_isArray":false},{"name":"source_fmt","type":"string","_isOptional":false,"_isArray":false},{"name":"source_tz","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group_prefix","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_key","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_value","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
                              </Flow>
</__subflow__>
                              <__binding__><![CDATA[{"audit_parquetfolder":"","source":""}]]></__binding__>
                            </Model>
                        </Node>
                        <Link srcId="4efed069-fbe4-42b4-84f5-418fa5488257" srcPort="out:0" tgtId="9685d7b8-be25-4b6a-87c3-c7be75074079" tgtPort="din:0"/>
                        <Link srcId="cd64c670-6c5f-440e-8b66-441c760166d8" srcPort="out:0" tgtId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" tgtPort="in:0"/>
                        <Link srcId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" srcPort="out:0" tgtId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" tgtPort="in:0"/>
                        <Link srcId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" srcPort="out:0" tgtId="dd779a23-bc63-4200-8e22-05639b978a68" tgtPort="in:0"/>
                        <Link srcId="cd64c670-6c5f-440e-8b66-441c760166d8" srcPort="out:0" tgtId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" tgtPort="in:0"/>
                        <Link srcId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" srcPort="out:0" tgtId="328fbd82-fdae-41c6-8c16-c241c5f6da38" tgtPort="in:0"/>
                        <Link srcId="328fbd82-fdae-41c6-8c16-c241c5f6da38" srcPort="dout:0" tgtId="4efed069-fbe4-42b4-84f5-418fa5488257" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"number","*":{"label":"label","desc":"desc"},"group":"common","name":"stopBatchCount","label":"Stop After n Microbatch","type":"integer","hidden":"false","disabled":false,"resolveProperty":false,"value":0,"constraints":{"min":"0","max":"999999","step":"1","places":"","maxLength":""},"runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"drop_source_group","label":"Source Group","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"drop_source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"vtimezone","label":"Time Zone","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Etc/GMT","defaultValueForExisted":"Europe/London","enumSource":"rest:/global/?op=get.timezones","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","name":"drop_sparksqltable","label":"Dropped Events Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser_dropped","enumSource":"","runtimeControl":false,"groupLabel":"Audit"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","name":"drop_metric_name","label":"Dropped Events Metric Name","desc":"The metric name which is used to do the audit log","type":"string","hidden":"false","disabled":true,"resolveProperty":false,"value":"Total Duplicate Events","enumSource":"","runtimeControl":false},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group","name":"enableAudit","label":"Audit Log","type":"boolean","hidden":"false","disabled":false,"resolveProperty":false,"value":"false","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","name":"auditTable","label":"Audit Log Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser","enumSource":"","runtimeControl":false}]</Properties>
                      </Flow>
</__subflow__>
                      <__binding__><![CDATA[{"drop_source_group":"output_source_group","drop_source":"output_source","vtimezone":"motimezone","drop_sparksqltable":"drop_sparksqltable","stopBatchCount":"output_stopBatchCount","enableAudit":"output_doaudit","auditTable":"output_audit_table_folder","drop_metric_name":"drop_metric_name"}]]></__binding__>
                    </Model>
                </Node>
                <Link srcId="08a937b8-7c88-42ec-83c3-fbefc3631a78" srcPort="dout:1" tgtId="527a713d-a02e-42b4-81c8-1f6799192af1" tgtPort="din:0"/>
                <Link srcId="1191f81c-7709-4100-8afd-2b5d3d3d8c2c" srcPort="out:0" tgtId="c36d7cb3-796a-4b7d-81b3-299bcebd9b6a" tgtPort="din:0"/>
                <Link srcId="cfde6cfb-7498-4b34-8dfc-62eb71da9bb4" srcPort="dout:0" tgtId="e99c3916-b95e-42d2-8934-2213520a1964" tgtPort="in:0"/>
                <Link srcId="9327217d-5098-4477-807b-3ee5d8b297d0" srcPort="out:0" tgtId="b4c41092-f31d-4ad0-809f-b82569d544b5" tgtPort="in:0"/>
                <Link srcId="73490184-781b-4acb-8f0e-500cca2f6ad9" srcPort="out:0" tgtId="cfde6cfb-7498-4b34-8dfc-62eb71da9bb4" tgtPort="din:0"/>
                <Link srcId="b4c41092-f31d-4ad0-809f-b82569d544b5" srcPort="dout:0" tgtId="1191f81c-7709-4100-8afd-2b5d3d3d8c2c" tgtPort="in:0"/>
                <Link srcId="a2992e48-a216-41c5-857a-5230e14d64a6" srcPort="out:0" tgtId="16257540-b127-448a-8891-c8a71a46df04" tgtPort="in:0"/>
                <Link srcId="83dcd221-9159-46d5-8fb4-b6c524c69c02" srcPort="out:0" tgtId="08a937b8-7c88-42ec-83c3-fbefc3631a78" tgtPort="in:0"/>
                <Link srcId="08a937b8-7c88-42ec-83c3-fbefc3631a78" srcPort="dout:0" tgtId="73490184-781b-4acb-8f0e-500cca2f6ad9" tgtPort="in:0"/>
                <Link srcId="08a937b8-7c88-42ec-83c3-fbefc3631a78" srcPort="dout:0" tgtId="a2992e48-a216-41c5-857a-5230e14d64a6" tgtPort="in:0"/>
                <Link srcId="08a937b8-7c88-42ec-83c3-fbefc3631a78" srcPort="dout:0" tgtId="9327217d-5098-4477-807b-3ee5d8b297d0" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"number","*":{"label":"label","desc":"desc"},"name":"output_stopBatchCount","label":"Stop After n Microbatch","type":"integer","hidden":"false","disabled":false,"resolveProperty":false,"value":0,"constraints":{"min":"0","max":"999999","step":"1","places":"","maxLength":"","args":{}},"runtimeControl":false},{"editorType":"sparkSelect","*":{"label":"label","desc":"desc","options.History":"constraints.args.options.0.label","options.Anomaly":"constraints.args.options.1.label","options.Both":"constraints.args.options.2.label"},"name":"OPERATION_MODE","label":"Operation Mode","desc":"Controls output target routing to History table and/or Anomaly HDFS Target","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Both","constraints":{"type":"sparkSelect","args":{"options":[{"label":"History","value":"History"},{"label":"Anomaly","value":"Anomaly"},{"label":"Both","value":"Both"}],"needPlaceholder":true,"multiple":false,"url":"http://10.101.7.163:18080/vitria-oi/rest/app/spark/space/VIAOps Ingestion/sparkm/VIAOps - Aggregate Output MetricReferenceData Template","_cid":"510cb45b-ed25-4eef-89de-952be285ee4c","name":"value"}},"runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"output_source_group","label":"Source Group","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"output_source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"motimezone","label":"Time Zone","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Etc/GMT","enumSource":"rest:/global/?op=get.timezones","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Target","name":"HISTORY_TABLE_FOLDER","label":"Spark SQL Table URL","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Target","name":"history_table_name","label":"Spark SQL Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"fieldMultiSelect","*":{"label":"label","desc":"desc"},"group":"group","name":"output_partition_keys","label":"Partition Fields","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"controlValue":"","constraints":{"type":"fieldMultiSelect","args":{"nodeType":"primitive","sourcePrefix":false,"sourceName":"","expandArray":false,"types":["string","boolean","integer","long","double","float","date","time","datetime","array"]}},"sourceSchemaSensitive":true,"runtimeControl":false,"groupLabel":"Target"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Target","name":"ANOMALY_TARGET_FILENAME","label":"Anomaly File URL","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"anomalyFileNamePrefix","label":"Anomaly File Name Prefix","type":"string","optional":"true","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false,"group":"group","groupLabel":"Target"},{"editorType":"fieldMultiSelect","*":{"label":"label","desc":"desc"},"group":"group","name":"keys","label":"State Key Columns","desc":"the key columns to remove duplicate","type":"string","hidden":"false","disabled":false,"impactSchema":"false","escapeValue":false,"resolveProperty":false,"constraints":{"type":"fieldMultiSelect","args":{"nodeType":"primitive","sourcePrefix":false,"sourceName":"","expandArray":false,"types":["string","boolean","integer","long","double","float","date","time","datetime","array"]}},"sourceSchemaSensitive":true,"value":["metric_name"],"groupLabel":"Target","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group2","name":"drop_sparksqltable","label":"Dropped Events Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser_dropped","enumSource":"","runtimeControl":false,"groupLabel":"Audit"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group2","name":"drop_metric_name","label":"Dropped Events Metric Name","desc":"The metric name which is used to do the audit log","type":"string","hidden":"false","disabled":true,"resolveProperty":false,"value":"Total Duplicate Events","enumSource":"","runtimeControl":false,"groupLabel":"Audit"},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Audit","name":"output_doaudit","label":"Audit Log","type":"boolean","hidden":"false","disabled":false,"resolveProperty":false,"value":"true","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Audit","name":"output_audit_table_folder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser","enumSource":"","runtimeControl":false}]</Properties>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"output_stopBatchCount":"stop_after_batch","OPERATION_MODE":"target","output_source_group":"source_group","output_source":"source_group_prefix","motimezone":"time_zone","HISTORY_TABLE_FOLDER":"spark_sql_table_url","history_table_name":"spark_sql_table","ANOMALY_TARGET_FILENAME":"anomaly_file_url","anomalyFileNamePrefix":"anomaly_file_name_prefix","output_doaudit":"enableAudit","output_audit_table_folder":"auditUrl","drop_sparksqltable":"agg_dropped_events"}]]></__binding__>
            </Model>
        </Node>
        <Node index="1008" uuid="73faa65b-1254-4aa6-8e8b-fa5e1c03be81" type="subflow" label="Dropped Events" x="630" y="340" width="105" height="75">
            <Source name="In" uid="0" outputType="DStream" dataType="(String,String)">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="e53a2705-e3f4-4bd5-8bd2-be7ac945ee22">
                <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="Out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/DroppedEvents","stopBatchCount":0,"drop_source_group":"","drop_source":"","vtimezone":"Etc/GMT","drop_sparksqltable":"","drop_metric_name":"Total Bad Events","enableAudit":"true","auditTable":""}
</Properties>
              <__subflow__>
              <Flow index="1008" uuid="DroppedEvents" isNested="true" revision="809" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/DroppedEvents" name="DroppedEvents" showFooter="true">
                <Node index="1008_1" uuid="cd64c670-6c5f-440e-8b66-441c760166d8" type="inPort" label="In" x="240" y="30" width="70" height="40">
                    <Output name="Out" uid="0" outputType="DStream" dataType="(String,String)" referenceType="viaops.ingestion.DroppedEvents">
                      <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.DroppedEvents","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1008_2" uuid="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" type="Compute" label="to Dropped Events" x="366" y="10" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="(String,String)">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="cd64c670-6c5f-440e-8b66-441c760166d8">
                        <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="toDroppedEvents_Class" isClassRef="false" udfs="generate_datekey">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${vtimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${drop_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${drop_source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="error" outputType="string" alias="error" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="data" outputType="string" alias="event" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="mixed"/>
                    </Model>
                </Node>
                <Node index="1008_3" uuid="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" type="StreamTarget" label="write to Hive" x="560" y="9" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="event" label="event" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="hiveTable" tableName="${drop_sparksqltable}" partitionType="eventField" partitionSize="" partitionColumn="date_key" partitionIndex="0" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                    </Model>
                </Node>
                <Node index="1008_4" uuid="dd779a23-bc63-4200-8e22-05639b978a68" type="outPort" label="Out" x="746" y="29" width="70" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="event" label="event" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{"type":{"name":"viaops.ingestion.DroppedEvents","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1008_5" uuid="4efed069-fbe4-42b4-84f5-418fa5488257" type="Compute" label="Conver to metrics (Dropped Events)" x="760" y="120" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="Long">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="328fbd82-fdae-41c6-8c16-c241c5f6da38">
                        <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${vtimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${drop_metric_name}&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="cast(count, &quot;string&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;sum&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;Count&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${drop_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="if(${stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${vtimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${drop_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="1008_6" uuid="328fbd82-fdae-41c6-8c16-c241c5f6da38" type="Aggregate" label="Count Dropped Events" x="560" y="120" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="(String,String)">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9">
                        <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="Long">
                      <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="" isClassRef="false">
                      <Measures>
                        <Measure type="count" field="" asName="count"/>
                      </Measures>
                      <Window enable="false" />
                    </Model>
                </Node>
                <Node index="1008_7" uuid="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" type="Filter" label="Do Audit Log" x="367" y="120" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="(String,String)">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="cd64c670-6c5f-440e-8b66-441c760166d8">
                        <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="(String,String)">
                      <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model filterModel="form">
                      <Filters>
                        <Filter field="" op="sleText" arg="" value="" sleText="&quot;${enableAudit}&quot; = &quot;True&quot; || &quot;${enableAudit}&quot; = &quot;true&quot;"/>
                      </Filters>
                    </Model>
                </Node>
                <Node index="1008_8" uuid="9685d7b8-be25-4b6a-87c3-c7be75074079" type="subflow" label="Log Dropped Event Metric" x="970" y="120" width="130" height="75">
                    <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="4efed069-fbe4-42b4-84f5-418fa5488257">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/AuditLog","audit_parquetfolder":"${auditTable}","source":"${drop_source}"}
</Properties>
                      <__subflow__>
                      <Flow index="1008_8" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                        <Node index="1008_8_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1008_8_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Model>
<Properties>
{"type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1008_8_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model _caseClass="AuditLogTable" isClassRef="true">
                              <Computes>
                                <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                              </Computes>
                              <CheckboxStatus isChecked="false"/>
                            </Model>
                        </Node>
                        <Node index="1008_8_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                              <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                            </Model>
                        </Node>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                        <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_parquetfolder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"${auditTable}","enumSource":"","runtimeControl":false,"defaultVal":"viaops_ingestion_auditlog"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"${drop_source}","enumSource":"","runtimeControl":false,"defaultVal":""}]</Properties>
      <Types>[{"name":"AuditLogTable","schema":[{"name":"date_key","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_start_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_end_tm","type":"long","_isOptional":true,"_isArray":false},{"name":"metric_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_value","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_uom","type":"string","_isOptional":false,"_isArray":false},{"name":"uom_label","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group","type":"string","_isOptional":false,"_isArray":false},{"name":"system_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"process_type","type":"string","_isOptional":false,"_isArray":false},{"name":"aggr_type","type":"string","_isOptional":false,"_isArray":false},{"name":"source_fmt","type":"string","_isOptional":false,"_isArray":false},{"name":"source_tz","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group_prefix","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_key","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_value","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
                      </Flow>
</__subflow__>
                      <__binding__><![CDATA[{"audit_parquetfolder":"","source":""}]]></__binding__>
                    </Model>
                </Node>
                <Link srcId="4efed069-fbe4-42b4-84f5-418fa5488257" srcPort="out:0" tgtId="9685d7b8-be25-4b6a-87c3-c7be75074079" tgtPort="din:0"/>
                <Link srcId="cd64c670-6c5f-440e-8b66-441c760166d8" srcPort="out:0" tgtId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" tgtPort="in:0"/>
                <Link srcId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" srcPort="out:0" tgtId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" tgtPort="in:0"/>
                <Link srcId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" srcPort="out:0" tgtId="dd779a23-bc63-4200-8e22-05639b978a68" tgtPort="in:0"/>
                <Link srcId="cd64c670-6c5f-440e-8b66-441c760166d8" srcPort="out:0" tgtId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" tgtPort="in:0"/>
                <Link srcId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" srcPort="out:0" tgtId="328fbd82-fdae-41c6-8c16-c241c5f6da38" tgtPort="in:0"/>
                <Link srcId="328fbd82-fdae-41c6-8c16-c241c5f6da38" srcPort="dout:0" tgtId="4efed069-fbe4-42b4-84f5-418fa5488257" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"number","*":{"label":"label","desc":"desc"},"group":"common","name":"stopBatchCount","label":"Stop After n Microbatch","type":"integer","hidden":"false","disabled":false,"resolveProperty":false,"value":0,"constraints":{"min":"0","max":"999999","step":"1","places":"","maxLength":""},"runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"drop_source_group","label":"Source Group","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"drop_source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"vtimezone","label":"Time Zone","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Etc/GMT","defaultValueForExisted":"Europe/London","enumSource":"rest:/global/?op=get.timezones","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","name":"drop_sparksqltable","label":"Dropped Events Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser_dropped","enumSource":"","runtimeControl":false,"groupLabel":"Audit"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","name":"drop_metric_name","label":"Dropped Events Metric Name","desc":"The metric name which is used to do the audit log","type":"string","hidden":"false","disabled":true,"resolveProperty":false,"value":"Total Bad Events","enumSource":"","runtimeControl":false},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group","name":"enableAudit","label":"Audit Log","type":"boolean","hidden":"false","disabled":false,"resolveProperty":false,"value":"true","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","name":"auditTable","label":"Audit Log Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser","enumSource":"","runtimeControl":false,"defaultVal":"viaops_audit_parser"}]</Properties>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"drop_source_group":"source_group","drop_sparksqltable":"agg_dropped_events","vtimezone":"time_zone","drop_source":"source_group_prefix","stopBatchCount":"stop_after_batch","enableAudit":"enableAudit","auditTable":"auditUrl"}]]></__binding__>
            </Model>
        </Node>
        <Node index="1009" uuid="54ceaf9d-aa1d-41dc-8fdc-b802ca15c33f" type="Adhoc" label="Pre Process" x="131" y="320" width="109" height="95">
            <Source name="source1" uid="0" outputType="DStream" dataType="String">
              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="2de76d39-43d2-45a3-8e28-06a02e3272a7">
                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="Out" uid="0" outputType="DStream" dataType="String" referenceType="string">
              <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Output name="Dropped" uid="1" outputType="DStream" dataType="String" referenceType="string">
              <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
              <Script><![CDATA[
// The actual Scala code is set by Model Generator
val retval = (source1, source1)
]]></Script>
            </Model>
        </Node>
        <Node index="1019" uuid="77967f4f-e847-462a-8d3d-34e5669b3ac7" type="Compute" label="Failed" x="291" y="340" width="104" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="String">
              <DataSource category="#OUTPUT" id="undefined" name="Dropped" nodeId="54ceaf9d-aa1d-41dc-8fdc-b802ca15c33f">
                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="(String,String)">
              <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model isClassRef="false">
              <Computes>
                <Compute op="sleText" field="" arg="" value="&quot;Pre Process Failure&quot;" outputType="string" alias="error" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="data" outputType="string" alias="data" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="true"/>
            </Model>
        </Node>
        <Node index="1020" uuid="e53a2705-e3f4-4bd5-8bd2-be7ac945ee22" type="Compute" label="Invalid" x="466" y="267" width="104" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="(String,String)">
              <DataSource category="#OUTPUT" id="undefined" name="Dropped" nodeId="e868221a-6f4c-4cb2-8e22-64d2766f9dee">
                <Field name="___error___" label="error" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="(String,String)">
              <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model isClassRef="false">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="error" outputType="string" alias="error" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="data" outputType="string" alias="data" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="mixed"/>
            </Model>
        </Node>
        <Node index="1021" uuid="668e879b-8c68-4b16-8f9a-1e0a1e9faefa" type="subflow" label="Aggregate" x="1300" y="320" width="160" height="75">
            <Source name="source1" uid="0" outputType="DStream" dataType="class:Pivot">
              <DataSource category="#OUTPUT" id="undefined" name="PivotOut" nodeId="ca1449c3-e067-4eb8-8456-20fce30eb6ae">
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="ToNormalize" uid="0" outputType="DStream" dataType="(Long,String,String,String,String,Long,Option[Long],Option[Long],Option[Long],Option[Double],Long)">
              <Field name="_vt_time" label="_vt_time" type="long" isArray="false" isOptional="false"/>
              <Field name="metaName" label="metaName" type="string" isArray="false" isOptional="false"/>
              <Field name="location" label="location" type="string" isArray="false" isOptional="false"/>
              <Field name="metric_name" label="metric_name" type="string" isArray="false" isOptional="false"/>
              <Field name="aggr_func" label="aggr_func" type="string" isArray="false" isOptional="false"/>
              <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
              <Field name="sum_metric_value" label="sum_metric_value" type="long" isArray="false" isOptional="true"/>
              <Field name="max_metric_value" label="max_metric_value" type="long" isArray="false" isOptional="true"/>
              <Field name="min_metric_value" label="min_metric_value" type="long" isArray="false" isOptional="true"/>
              <Field name="avg_metric_value" label="avg_metric_value" type="double" isArray="false" isOptional="true"/>
              <Field name="window_start_time" label="window_start_time" type="long" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/Aggregate","agg_stopBatchCount":0,"agg_source_group":"","agg_source":"","atimezone":"Etc/GMT","timeSetting":{"timeSettingValue":{"timeType":"event","eventField":"ts","hbChecked":false,"oooChecked":false,"hbDelay":"30/S","oooDelay":"30/S"}},"windowSetting":{"windowSize":"5/N","windowInterval":"5/N","windowPolicy":"time"},"dimensions":["metaName","location","metric_name","aggr_func"],"measures":[{"type":"count","field":"","asName":"count"},{"field":"metric_value","type":"sum","asName":"sum_metric_value"},{"field":"metric_value","type":"max","asName":"max_metric_value"},{"field":"metric_value","type":"min","asName":"min_metric_value"},{"field":"metric_value","type":"avg","asName":"avg_metric_value"},{"field":"","type":"window_start_time","asName":"window_start_time"}],"agg_dropped_events":"viaops_audit_parser_dropped","drop_metric_name":"Total Dropped Events","agg_doaudit":"true","agg_audit_table_folder":"viaops_audit_parser"}
</Properties>
              <__subflow__>
              <Flow index="1021" uuid="Aggregate" isNested="true" revision="1849" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/Aggregate" name="Aggregate" showFooter="true">
                <Node index="1021_1" uuid="e83941c2-c6d7-4806-8336-691f792d1fde" type="inPort" label="source1" x="100" y="70" width="72.703125" height="40">
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Pivot">
                      <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metaName" label="metaName" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"*"}
</Properties>
                    </Model>
                </Node>
                <Node index="1021_2" uuid="6783797e-0f4f-49c2-81b7-50906d504046" type="Aggregate" label="Count 5 minutes" x="232" y="50" width="130" height="95">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Pivot">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="e83941c2-c6d7-4806-8336-691f792d1fde">
                        <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out" uid="0" outputType="DStream" dataType="(Long,String,String,String,String,Long,Option[Long],Option[Long],Option[Long],Option[Double],Long)">
                      <Field name="_vt_time" label="_vt_time" type="long" isArray="false" isOptional="false"/>
                      <Field name="metaName" label="metaName" type="string" isArray="false" isOptional="false"/>
                      <Field name="location" label="location" type="string" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" isArray="false" isOptional="false"/>
                      <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
                      <Field name="sum_metric_value" label="sum_metric_value" type="long" isArray="false" isOptional="true"/>
                      <Field name="max_metric_value" label="max_metric_value" type="long" isArray="false" isOptional="true"/>
                      <Field name="min_metric_value" label="min_metric_value" type="long" isArray="false" isOptional="true"/>
                      <Field name="avg_metric_value" label="avg_metric_value" type="double" isArray="false" isOptional="true"/>
                      <Field name="window_start_time" label="window_start_time" type="long" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Output name="Dropped" uid="1" outputType="DStream" dataType="class:Pivot">
                      <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metaName" label="metaName" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="" isClassRef="false">
                      <Dimensions>
                        <Dimension field="metaName"/>
                        <Dimension field="location"/>
                        <Dimension field="metric_name"/>
                        <Dimension field="aggr_func"/>
                      </Dimensions>
                      <Measures>
                        <Measure type="count" field="" asName="count"/>
                        <Measure type="sum" field="metric_value" asName="sum_metric_value"/>
                        <Measure type="max" field="metric_value" asName="max_metric_value"/>
                        <Measure type="min" field="metric_value" asName="min_metric_value"/>
                        <Measure type="avg" field="metric_value" asName="avg_metric_value"/>
                        <Measure type="window_start_time" field="" asName="window_start_time"/>
                      </Measures>
                      <Window enable="true" size="5/N"  step="5/N" timeMode="event" outputCondition="changes">
                        <EventTime field="ts"/>
                      </Window>
                      <__binding__><![CDATA[{"windowSetting":"windowSetting","timeSetting":"timeSetting","dimensions":"dimensions","measures":"measures"}]]></__binding__>
                      <__binding__><![CDATA[{"windowSetting":"windowSetting","timeSetting":"timeSetting","dimensions":"dimensions","measures":"measures"}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1021_3" uuid="77779a47-2c4b-4aed-8f85-cf080f562555" type="Aggregate" label="Get earliest event time" x="427" y="200" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Pivot">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="e83941c2-c6d7-4806-8336-691f792d1fde">
                        <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
                      <Field name="min_ts" label="min_ts" type="datetime" isArray="false" isOptional="true"/>
                      <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="" isClassRef="false">
                      <Measures>
                        <Measure type="min" field="ts" asName="min_ts"/>
                        <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
                      </Measures>
                      <Window enable="false" />
                      <__binding__><![CDATA[{"measures":""}]]></__binding__>
                      <__binding__><![CDATA[{"measures":""}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1021_4" uuid="2348b56b-9a33-4b0e-8a3e-1f8460ca4a4c" type="outPort" label="ToNormalize" x="472" y="40" width="96.6875" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="(Long,String,String,String,String,Long,Option[Long],Option[Long],Option[Long],Option[Double],Long)">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="6783797e-0f4f-49c2-81b7-50906d504046">
                        <Field name="_vt_time" label="_vt_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                        <Field name="sum_metric_value" label="sum_metric_value" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                        <Field name="max_metric_value" label="max_metric_value" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                        <Field name="min_metric_value" label="min_metric_value" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                        <Field name="avg_metric_value" label="avg_metric_value" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                        <Field name="window_start_time" label="window_start_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{}
</Properties>
                    </Model>
                </Node>
                <Node index="1021_5" uuid="6d89e7d0-9df0-4c7f-8f9a-4a61a4dc2072" type="Aggregate" label="Get latest event time" x="427" y="308" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Pivot">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="e83941c2-c6d7-4806-8336-691f792d1fde">
                        <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
                      <Field name="max_ts" label="max_ts" type="datetime" isArray="false" isOptional="true"/>
                      <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="" isClassRef="false">
                      <Measures>
                        <Measure type="max" field="ts" asName="max_ts"/>
                        <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
                      </Measures>
                      <Window enable="false" />
                      <__binding__><![CDATA[{"measures":""}]]></__binding__>
                      <__binding__><![CDATA[{"measures":""}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1021_6" uuid="60d1ab54-b1e5-466d-886a-d566772cdc1b" type="subflow" label="CharterTemplateAuditlog" x="1012" y="194" width="130" height="75">
                    <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/AuditLog","audit_parquetfolder":"${agg_audit_table_folder}","source":"${agg_source}"}
</Properties>
                      <__subflow__>
                      <Flow index="1021_6" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                        <Node index="1021_6_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1021_6_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Model>
<Properties>
{"type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1021_6_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model _caseClass="AuditLogTable" isClassRef="true">
                              <Computes>
                                <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                              </Computes>
                              <CheckboxStatus isChecked="false"/>
                            </Model>
                        </Node>
                        <Node index="1021_6_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                              <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                            </Model>
                        </Node>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                        <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_parquetfolder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"${agg_audit_table_folder}","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"${agg_source}","enumSource":"","runtimeControl":false}]</Properties>
      <Types>[{"name":"AuditLogTable","schema":[{"name":"date_key","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_start_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_end_tm","type":"long","_isOptional":true,"_isArray":false},{"name":"metric_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_value","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_uom","type":"string","_isOptional":false,"_isArray":false},{"name":"uom_label","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group","type":"string","_isOptional":false,"_isArray":false},{"name":"system_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"process_type","type":"string","_isOptional":false,"_isArray":false},{"name":"aggr_type","type":"string","_isOptional":false,"_isArray":false},{"name":"source_fmt","type":"string","_isOptional":false,"_isArray":false},{"name":"source_tz","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group_prefix","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_key","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_value","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
                      </Flow>
</__subflow__>
                      <__binding__><![CDATA[{"audit_parquetfolder":"","source":""}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1021_7" uuid="c8abb6dc-3518-41c5-88a5-7e016006e3f4" type="Compute" label="Convert to metrics (Earliest Event Time)" x="610" y="200" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="77779a47-2c4b-4aed-8f85-cf080f562555">
                        <Field name="min_ts" label="min_ts" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                        <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${atimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;Earliest Event Time&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="to_nonoption(cast(min_ts, &quot;string&quot;), &quot;null&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;ealiest&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;Earliest&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="if(${agg_stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${atimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="1021_8" uuid="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" type="Filter" label="Do Audit Log" x="820" y="200" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="c8abb6dc-3518-41c5-88a5-7e016006e3f4">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model filterModel="form">
                      <Filters>
                        <Filter field="" op="sleText" arg="" value="" sleText="&quot;${agg_doaudit}&quot; = &quot;True&quot; || &quot;${agg_doaudit}&quot; = &quot;true&quot;"/>
                      </Filters>
                    </Model>
                </Node>
                <Node index="1021_9" uuid="62838e97-64f5-4e62-872f-16d5e1dabdc2" type="subflow" label="CharterTemplateDroppedEvents" x="972" y="47" width="130" height="75">
                    <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="04ac791e-25cd-4c05-88e3-f093d50eb330">
                        <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/DroppedEvents","stopBatchCount":0,"drop_source_group":"","drop_source":"${agg_source}","vtimezone":"Etc/GMT","drop_sparksqltable":"${agg_dropped_events}","drop_metric_name":"Total Dropped Events","enableAudit":"true","auditTable":"viaops_audit_parser"}
</Properties>
                      <__subflow__>
                      <Flow index="1021_9" uuid="DroppedEvents" isNested="true" revision="809" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/DroppedEvents" name="DroppedEvents" showFooter="true">
                        <Node index="1021_9_1" uuid="cd64c670-6c5f-440e-8b66-441c760166d8" type="inPort" label="In" x="240" y="30" width="70" height="40">
                            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents" referenceType="viaops.ingestion.DroppedEvents">
                              <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.DroppedEvents","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1021_9_2" uuid="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" type="Compute" label="to Dropped Events" x="366" y="10" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="cd64c670-6c5f-440e-8b66-441c760166d8">
                                <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model _caseClass="toDroppedEvents_Class" isClassRef="false" udfs="generate_datekey">
                              <Computes>
                                <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${vtimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${drop_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${drop_source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="error" outputType="string" alias="error" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="data" outputType="string" alias="event" wordWarp="true"/>
                              </Computes>
                              <CheckboxStatus isChecked="mixed"/>
                            </Model>
                        </Node>
                        <Node index="1021_9_3" uuid="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" type="StreamTarget" label="write to Hive" x="560" y="9" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="event" label="event" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="event" label="event" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model type="hiveTable" tableName="${drop_sparksqltable}" partitionType="eventField" partitionSize="" partitionColumn="date_key" partitionIndex="0" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                            </Model>
                        </Node>
                        <Node index="1021_9_4" uuid="dd779a23-bc63-4200-8e22-05639b978a68" type="outPort" label="Out" x="746" y="29" width="70" height="40">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:toDroppedEvents_Class">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="event" label="event" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Model>
<Properties>
{"type":{"name":"viaops.ingestion.DroppedEvents","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1021_9_5" uuid="4efed069-fbe4-42b4-84f5-418fa5488257" type="Compute" label="Conver to metrics (Dropped Events)" x="760" y="120" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="Long">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="328fbd82-fdae-41c6-8c16-c241c5f6da38">
                                <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                              <Computes>
                                <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${vtimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${drop_metric_name}&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="cast(count, &quot;string&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;sum&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;Count&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${drop_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="if(${stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${vtimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${drop_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                              </Computes>
                              <CheckboxStatus isChecked="false"/>
                            </Model>
                        </Node>
                        <Node index="1021_9_6" uuid="328fbd82-fdae-41c6-8c16-c241c5f6da38" type="Aggregate" label="Count Dropped Events" x="560" y="120" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9">
                                <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="Long">
                              <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model _caseClass="" isClassRef="false">
                              <Measures>
                                <Measure type="count" field="" asName="count"/>
                              </Measures>
                              <Window enable="false" />
                            </Model>
                        </Node>
                        <Node index="1021_9_7" uuid="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" type="Filter" label="Do Audit Log" x="367" y="120" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="cd64c670-6c5f-440e-8b66-441c760166d8">
                                <Field name="error" label="error" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents">
                              <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model filterModel="form">
                              <Filters>
                                <Filter field="" op="sleText" arg="" value="" sleText="&quot;${enableAudit}&quot; = &quot;True&quot; || &quot;${enableAudit}&quot; = &quot;true&quot;"/>
                              </Filters>
                            </Model>
                        </Node>
                        <Node index="1021_9_8" uuid="9685d7b8-be25-4b6a-87c3-c7be75074079" type="subflow" label="Log Dropped Event Metric" x="970" y="120" width="130" height="75">
                            <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="4efed069-fbe4-42b4-84f5-418fa5488257">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/AuditLog","audit_parquetfolder":"${auditTable}","source":"${drop_source}"}
</Properties>
                              <__subflow__>
                              <Flow index="1021_9_8" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                                <Node index="1021_9_8_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                                    </Output>
                                    <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                                    </Model>
                                </Node>
                                <Node index="1021_9_8_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                      </DataSource>
                                    </Source>
                                    <Model>
<Properties>
{"type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                                    </Model>
                                </Node>
                                <Node index="1021_9_8_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                      </DataSource>
                                    </Source>
                                    <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                                    </Output>
                                    <Model _caseClass="AuditLogTable" isClassRef="true">
                                      <Computes>
                                        <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                                        <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                                      </Computes>
                                      <CheckboxStatus isChecked="false"/>
                                    </Model>
                                </Node>
                                <Node index="1021_9_8_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                                    <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                      </DataSource>
                                    </Source>
                                    <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                                    </Output>
                                    <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                                      <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                                    </Model>
                                </Node>
                                <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                                <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                                <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_parquetfolder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"${auditTable}","enumSource":"","runtimeControl":false,"defaultVal":"viaops_ingestion_auditlog"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"${drop_source}","enumSource":"","runtimeControl":false,"defaultVal":""}]</Properties>
      <Types>[{"name":"AuditLogTable","schema":[{"name":"date_key","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_start_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_end_tm","type":"long","_isOptional":true,"_isArray":false},{"name":"metric_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_value","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_uom","type":"string","_isOptional":false,"_isArray":false},{"name":"uom_label","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group","type":"string","_isOptional":false,"_isArray":false},{"name":"system_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"process_type","type":"string","_isOptional":false,"_isArray":false},{"name":"aggr_type","type":"string","_isOptional":false,"_isArray":false},{"name":"source_fmt","type":"string","_isOptional":false,"_isArray":false},{"name":"source_tz","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group_prefix","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_key","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_value","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
                              </Flow>
</__subflow__>
                              <__binding__><![CDATA[{"audit_parquetfolder":"","source":""}]]></__binding__>
                            </Model>
                        </Node>
                        <Link srcId="4efed069-fbe4-42b4-84f5-418fa5488257" srcPort="out:0" tgtId="9685d7b8-be25-4b6a-87c3-c7be75074079" tgtPort="din:0"/>
                        <Link srcId="cd64c670-6c5f-440e-8b66-441c760166d8" srcPort="out:0" tgtId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" tgtPort="in:0"/>
                        <Link srcId="41a6a5ab-b013-4059-854b-b4d7a89ef9a0" srcPort="out:0" tgtId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" tgtPort="in:0"/>
                        <Link srcId="7f77a1d4-f96e-4a1e-86f8-d91ec481a0a3" srcPort="out:0" tgtId="dd779a23-bc63-4200-8e22-05639b978a68" tgtPort="in:0"/>
                        <Link srcId="cd64c670-6c5f-440e-8b66-441c760166d8" srcPort="out:0" tgtId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" tgtPort="in:0"/>
                        <Link srcId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" srcPort="out:0" tgtId="328fbd82-fdae-41c6-8c16-c241c5f6da38" tgtPort="in:0"/>
                        <Link srcId="328fbd82-fdae-41c6-8c16-c241c5f6da38" srcPort="dout:0" tgtId="4efed069-fbe4-42b4-84f5-418fa5488257" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"number","*":{"label":"label","desc":"desc"},"group":"common","name":"stopBatchCount","label":"Stop After n Microbatch","type":"integer","hidden":"false","disabled":false,"resolveProperty":false,"value":0,"constraints":{"min":"0","max":"999999","step":"1","places":"","maxLength":""},"runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"drop_source_group","label":"Source Group","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"drop_source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"${agg_source}","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"vtimezone","label":"Time Zone","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Etc/GMT","defaultValueForExisted":"Europe/London","enumSource":"rest:/global/?op=get.timezones","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","name":"drop_sparksqltable","label":"Dropped Events Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"${agg_dropped_events}","enumSource":"","runtimeControl":false,"groupLabel":"Audit"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","name":"drop_metric_name","label":"Dropped Events Metric Name","desc":"The metric name which is used to do the audit log","type":"string","hidden":"false","disabled":true,"resolveProperty":false,"value":"Total Dropped Events","enumSource":"","runtimeControl":false},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group","name":"enableAudit","label":"Audit Log","type":"boolean","hidden":"false","disabled":false,"resolveProperty":false,"value":"true","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","name":"auditTable","label":"Audit Log Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser","enumSource":"","runtimeControl":false}]</Properties>
                      </Flow>
</__subflow__>
                      <__binding__><![CDATA[{"drop_service":"","drop_app":"","drop_sparksqltable":"","drop_source":"","vtimezone":"atimezone","daylight":"","drop_source_group":"agg_source_group","stopBatchCount":"agg_stopBatchCount","enableAudit":"agg_doaudit","auditTable":"agg_audit_table_folder","drop_metric_name":"drop_metric_name"}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1021_10" uuid="5f5f2582-13cd-46eb-8b21-b7894c459c28" type="Compute" label="Conver to metrics (Latest Event Time)" x="610" y="308" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="6d89e7d0-9df0-4c7f-8f9a-4a61a4dc2072">
                        <Field name="max_ts" label="max_ts" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                        <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${atimezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;Latest Event Time&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="to_nonoption(cast(max_ts, &quot;string&quot;), &quot;null&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;latest&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;Latest&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="if(${agg_stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${atimezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${agg_source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="1021_11" uuid="85e06d15-61e0-444b-8a0a-d90fbc877d83" type="Adhoc" label="to Json String" x="600" y="46" width="130" height="75">
                    <Source name="source1" uid="0" outputType="DStream" dataType="class:Pivot">
                      <DataSource category="#OUTPUT" id="undefined" name="Dropped" nodeId="6783797e-0f4f-49c2-81b7-50906d504046">
                        <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out1" uid="0" outputType="DStream" dataType="String" referenceType="string">
                      <Field name="data" label="data" type="string" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
                      <Script><![CDATA[import com.fasterxml.jackson.databind.ObjectMapper
        import com.fasterxml.jackson.module.scala.DefaultScalaModule
        import com.fasterxml.jackson.module.scala.experimental.ScalaObjectMapper
        
        def toJson[T: Manifest](mapper: ScalaObjectMapper, value: T): String = {
            mapper.writerFor[T].writeValueAsString(value)
        }
        
        val retval = source1.mapPartitions { itr => {
                val mapper = new ObjectMapper() with ScalaObjectMapper
                mapper.registerModule(DefaultScalaModule)
                itr.map(data => toJson(mapper, data))
            }
        }
        ]]></Script>
                    </Model>
                </Node>
                <Node index="1021_12" uuid="04ac791e-25cd-4c05-88e3-f093d50eb330" type="Compute" label="Tag Error" x="789" y="46" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="String">
                      <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="85e06d15-61e0-444b-8a0a-d90fbc877d83">
                        <Field name="data" label="data" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.DroppedEvents">
                      <Field name="error" label="error" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="data" label="data" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="viaops.ingestion.DroppedEvents" isClassRef="true">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="&quot;out-of-order&quot;" outputType="string" alias="error" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="data" outputType="string" alias="data" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Link srcId="85e06d15-61e0-444b-8a0a-d90fbc877d83" srcPort="dout:0" tgtId="04ac791e-25cd-4c05-88e3-f093d50eb330" tgtPort="in:0"/>
                <Link srcId="6783797e-0f4f-49c2-81b7-50906d504046" srcPort="dout:1" tgtId="85e06d15-61e0-444b-8a0a-d90fbc877d83" tgtPort="din:0"/>
                <Link srcId="c8abb6dc-3518-41c5-88a5-7e016006e3f4" srcPort="out:0" tgtId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" tgtPort="in:0"/>
                <Link srcId="77779a47-2c4b-4aed-8f85-cf080f562555" srcPort="dout:0" tgtId="c8abb6dc-3518-41c5-88a5-7e016006e3f4" tgtPort="in:0"/>
                <Link srcId="e83941c2-c6d7-4806-8336-691f792d1fde" srcPort="out:0" tgtId="77779a47-2c4b-4aed-8f85-cf080f562555" tgtPort="in:0"/>
                <Link srcId="e83941c2-c6d7-4806-8336-691f792d1fde" srcPort="out:0" tgtId="6783797e-0f4f-49c2-81b7-50906d504046" tgtPort="in:0"/>
                <Link srcId="6783797e-0f4f-49c2-81b7-50906d504046" srcPort="dout:0" tgtId="2348b56b-9a33-4b0e-8a3e-1f8460ca4a4c" tgtPort="in:0"/>
                <Link srcId="e83941c2-c6d7-4806-8336-691f792d1fde" srcPort="out:0" tgtId="6d89e7d0-9df0-4c7f-8f9a-4a61a4dc2072" tgtPort="in:0"/>
                <Link srcId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" srcPort="out:0" tgtId="60d1ab54-b1e5-466d-886a-d566772cdc1b" tgtPort="din:0"/>
                <Link srcId="6d89e7d0-9df0-4c7f-8f9a-4a61a4dc2072" srcPort="dout:0" tgtId="5f5f2582-13cd-46eb-8b21-b7894c459c28" tgtPort="in:0"/>
                <Link srcId="5f5f2582-13cd-46eb-8b21-b7894c459c28" srcPort="out:0" tgtId="3e6cf41d-6500-4dde-8d2b-228ccd5f9fa9" tgtPort="in:0"/>
                <Link srcId="04ac791e-25cd-4c05-88e3-f093d50eb330" srcPort="out:0" tgtId="62838e97-64f5-4e62-872f-16d5e1dabdc2" tgtPort="din:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"number","*":{"label":"label","desc":"desc"},"name":"agg_stopBatchCount","label":"Stop After n Microbatch","type":"integer","hidden":"false","disabled":false,"resolveProperty":false,"value":0,"constraints":{"min":"0","max":"999999","step":"1","places":"","maxLength":"","args":{}},"runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"agg_source_group","label":"Source Group","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"agg_source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"atimezone","label":"Time Zone","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Etc/GMT","enumSource":"rest:/global/?op=get.timezones","runtimeControl":false},{"editorType":"timeSetting","*":{"label":"label","desc":"desc"},"name":"timeSetting","label":"Time Setting","type":"object","hidden":"false","disabled":false,"resolveProperty":false,"value":{"timeSettingValue":{"timeType":"event","eventField":"ts","hbChecked":false,"oooChecked":false,"hbDelay":"30/S","oooDelay":"30/S"}},"constraints":{"type":"timeSetting","args":{}},"enumSource":"","runtimeControl":false,"group":"group","groupLabel":"Window"},{"editorType":"windowSetting","*":{"label":"label","desc":"desc"},"name":"windowSetting","label":"Window Setting","type":"object","hidden":"false","disabled":false,"resolveProperty":false,"value":{"windowSize":"5/N","windowInterval":"5/N","windowPolicy":"time"},"constraints":{"type":"windowSetting","args":{}},"enumSource":"","runtimeControl":false,"group":"group","groupLabel":"Window"},{"name":"dimensions","label":"Dimension fields","type":"string","editorType":"fieldMultiSelect","editorID":"_dimension","constraints":{"type":"fieldMultiSelect","args":{"nodeType":"all"}},"sourceSchemaSensitive":true,"value":[],"runtimeControl":false,"group":"group1","groupLabel":"Aggregate","defaultVal":[]},{"editorType":"measureSetting","*":{"label":"label","desc":"desc"},"group":"group1","groupLabel":"Aggregate","name":"measures","label":"Measure Fields","type":"object","hidden":"false","disabled":false,"resolveProperty":false,"value":[{"type":"count","field":"","asName":"count"},{"type":"window_end_time","field":"","asName":"aggr_end_tm"}],"constraints":{"type":"measureSetting","args":{}},"enumSource":"","runtimeControl":false,"defaultVal":[{"type":"count","field":"","asName":"count"},{"type":"window_end_time","field":"","asName":"aggr_end_tm"}]},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Audit","name":"agg_dropped_events","label":"Dropped Events Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser_dropped","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group2","name":"drop_metric_name","label":"Dropped Events Metric Name","desc":"The metric name which is used to do the audit log","type":"string","hidden":"false","disabled":true,"resolveProperty":false,"value":"Total Dropped Events","enumSource":"","runtimeControl":false,"groupLabel":"Audit"},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Audit","name":"agg_doaudit","label":"Audit Log","type":"boolean","hidden":"false","disabled":false,"resolveProperty":false,"value":"true","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Audit","name":"agg_audit_table_folder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser","enumSource":"","runtimeControl":false}]</Properties>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"agg_stopBatchCount":"stop_after_batch","agg_source_group":"source_group","atimezone":"time_zone","agg_doaudit":"enableAudit","agg_audit_table_folder":"auditUrl","agg_source":"source_group_prefix","agg_dropped_events":"agg_dropped_events"}]]></__binding__>
            </Model>
        </Node>
        <Node index="1022" uuid="bd747ef5-0bfc-495c-86d7-4dc0397bfec8" type="Compute" label="Choose Aggregation" x="1480" y="320" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="(Long,String,String,String,String,Long,Option[Long],Option[Long],Option[Long],Option[Double],Long)">
              <DataSource category="#OUTPUT" id="undefined" name="ToNormalize" nodeId="668e879b-8c68-4b16-8f9a-1e0a1e9faefa">
                <Field name="_vt_time" label="_vt_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="sum_metric_value" label="sum_metric_value" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                <Field name="max_metric_value" label="max_metric_value" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                <Field name="min_metric_value" label="min_metric_value" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                <Field name="avg_metric_value" label="avg_metric_value" type="double" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                <Field name="window_start_time" label="window_start_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:Pivot">
              <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="metaName" label="metaName" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="Pivot" isClassRef="true">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="from_unixtime_millisec(window_start_time)" outputType="datetime" alias="ts" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="metaName" outputType="string" alias="metaName" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="location" outputType="string" alias="location" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="if(metric_name=&quot;Sum Metric&quot;, sum_metric_value, if(metric_name=&quot;Max Metric&quot;, max_metric_value, if(metric_name=&quot;Min Metric&quot;, min_metric_value, if(metric_name=&quot;Count Metric&quot;, count, cast(avg_metric_value, &quot;long&quot;)))))" outputType="long" alias="metric_value" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="aggr_func" outputType="string" alias="aggr_func" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="1004" uuid="f9b07660-11db-45fd-8493-727947e50d05" type="JDBCStream" label="Reference" x="460" y="113" width="112" height="75">
            <Output name="out" uid="0" outputType="DStream" dataType="class:Reference_Class">
              <Field name="sequence_id" label="sequence_id" type="long" isArray="false" isOptional="false" column="sequence_id" wrapName="sequence_id"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model type="jdbcStream" sourceType="jdbc" caseClass="Reference_Class" isClassRef="false" dataSpeed="" dataVolume="" dataSource="/vitria/m3o/datasource/DefaultDomain/defaultds">
              <__binding__><![CDATA[{"dataSource":"enrich_datasource","databaseList":"","tableList":"tableList"}]]></__binding__>
              <Schema>
                <Field name="sequence_id" label="sequence_id" type="long" clazz="" isArray="false" isOptional="false" wrapName="sequence_id"/>
              </Schema>
              <datasource name="/vitria/m3o/datasource/DefaultDomain/defaultds"></datasource>
              <query>
              <table schema='via_dev' defaultSchema='via_dev' info='{"catalog":"via_dev","name":"vt_sequence","type":"TABLE"}'>vt_sequence</table>
              <columns>
                <column>sequence_id</column>
              </columns>
              <growColumns>
              </growColumns>
              <filter/>
              <incremental>false</incremental>
              </query>
              <pollRate every='1/m' value='60'/>
            </Model>
        </Node>
        <Node index="1005" uuid="03c44f21-d07e-4528-8720-d589ca82a81b" type="Join" label="Enrich" x="627" y="40" width="100" height="95">
            <Source name="source1" uid="0" outputType="DStream" dataType="class:InputData">
              <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="e868221a-6f4c-4cb2-8e22-64d2766f9dee">
                <Field name="metaname" label="metaname" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="TimeStamp" label="TimeStamp" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="sitename" label="sitename" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="callattemptstotal" label="callattemptstotal" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
              </DataSource>
            </Source>
            <Source name="source2" uid="1" outputType="DStream" dataType="class:Reference_Class">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="f9b07660-11db-45fd-8493-727947e50d05">
                <Field name="sequence_id" label="sequence_id" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false" column="sequence_id" wrapName="sequence_id"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:Enrich_Class">
              <Field name="metaname" label="metaname" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="TimeStamp" label="TimeStamp" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="sitename" label="sitename" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="callattemptstotal" label="callattemptstotal" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="sequence_id" label="sequence_id" type="long" clazz="" isArray="false" isOptional="true" column="sequence_id" wrapName="sequence_id"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model joinType="LeftOuterJoin" _caseClass="Enrich_Class" isClassRef="false" joinAlgorithms="broadcast">
              <Predicates sleText="true = true"/>
              <ProjectionsEditor>
                <ProjectionInfo source="source1.metaname" name="metaname" level="1" exclude="false"/>
                <ProjectionInfo source="source1.TimeStamp" name="TimeStamp" level="1" exclude="false"/>
                <ProjectionInfo source="source1.sitename" name="sitename" level="1" exclude="false"/>
                <ProjectionInfo source="source1.callattemptstotal" name="callattemptstotal" level="1" exclude="false"/>
                <ProjectionInfo source="source2.sequence_id" name="sequence_id" level="1" exclude="false"/>
              </ProjectionsEditor>
              <Projections>
                <Projection source="source1.metaname" name="metaname" label="metaname"/>
                <Projection source="source1.TimeStamp" name="TimeStamp" label="TimeStamp"/>
                <Projection source="source1.sitename" name="sitename" label="sitename"/>
                <Projection source="source1.callattemptstotal" name="callattemptstotal" label="callattemptstotal"/>
                <Projection source="source2.sequence_id" name="sequence_id" label="sequence_id"/>
              </Projections>
            </Model>
        </Node>
        <Node index="1010" uuid="12641d91-9007-48ec-8882-cab52f05c2cf" type="Compute" label="PrepareDeriveEnrich" x="749" y="40" width="131" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:Enrich_Class">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="03c44f21-d07e-4528-8720-d589ca82a81b">
                <Field name="metaname" label="metaname" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="TimeStamp" label="TimeStamp" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="sitename" label="sitename" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="callattemptstotal" label="callattemptstotal" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="sequence_id" label="sequence_id" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true" column="sequence_id" wrapName="sequence_id"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:Enrichment">
              <Field name="metaname" label="metaname" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="TimeStamp" label="TimeStamp" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="sitename" label="sitename" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="callattemptstotal" label="callattemptstotal" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="sequence_id" label="sequence_id" type="long" clazz="" isArray="false" isOptional="true"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="Enrichment" isClassRef="true">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="metaname" outputType="string" alias="metaname" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="TimeStamp" outputType="datetime" alias="TimeStamp" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="sitename" outputType="string" alias="sitename" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="callattemptstotal" outputType="long" alias="callattemptstotal" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="sequence_id" outputType="long" alias="sequence_id" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="1011" uuid="16e08357-2e9a-401c-8758-0d7ee33f5c95" type="Compute" label="PrepareDerive" x="751" y="180" width="130" height="77">
            <Source name="source" uid="0" outputType="DStream" dataType="class:InputData">
              <DataSource category="#OUTPUT" id="undefined" name="Out1" nodeId="e868221a-6f4c-4cb2-8e22-64d2766f9dee">
                <Field name="metaname" label="metaname" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="TimeStamp" label="TimeStamp" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="sitename" label="sitename" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="callattemptstotal" label="callattemptstotal" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:Enrichment">
              <Field name="metaname" label="metaname" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="TimeStamp" label="TimeStamp" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="sitename" label="sitename" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="callattemptstotal" label="callattemptstotal" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="sequence_id" label="sequence_id" type="long" clazz="" isArray="false" isOptional="true"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="Enrichment" isClassRef="true">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="metaname" outputType="string" alias="metaname" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="TimeStamp" outputType="datetime" alias="TimeStamp" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="sitename" outputType="string" alias="sitename" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="callattemptstotal" outputType="long" alias="callattemptstotal" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="0" outputType="long" alias="sequence_id" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="1012" uuid="ec070983-cbfe-45c9-8914-ed1d5d1f4e7f" type="Compute" label="DerivedFields" x="932" y="180" width="117" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:Enrichment">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="16e08357-2e9a-401c-8758-0d7ee33f5c95">
                <Field name="metaname" label="metaname" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="TimeStamp" label="TimeStamp" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="sitename" label="sitename" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="callattemptstotal" label="callattemptstotal" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="sequence_id" label="sequence_id" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:DerivedField">
              <Field name="metaname" label="metaname" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="TimeStamp" label="TimeStamp" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="sitename" label="sitename" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="callattemptstotal" label="callattemptstotal" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="field_1" label="field_1" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="DerivedField" isClassRef="true">
              <Variables>
                <Variable alias="var_1" outputType="string" value="metaname"/>
              </Variables>
              <Computes>
                <Compute op="sleText" field="*" arg="" value="metaname" outputType="string" alias="metaname" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="TimeStamp" outputType="datetime" alias="TimeStamp" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="sitename" outputType="string" alias="sitename" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="callattemptstotal" outputType="long" alias="callattemptstotal" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="var_1" outputType="string" alias="field_1" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="1013" uuid="a036ec9f-3f0d-4b26-84c4-eed72e031dcb" type="subflow" label="MaxMinEventTime" x="1300" y="180" width="130" height="75">
            <Source name="source1" uid="0" outputType="DStream" dataType="class:Pivot">
              <DataSource category="#OUTPUT" id="undefined" name="PivotOut" nodeId="ca1449c3-e067-4eb8-8456-20fce30eb6ae">
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:Pivot">
              <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="metaName" label="metaName" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"local://MaxMinEventTime","audit":"true","audit_table":"viaops_audit_parser","source_group":"SOB Group","source_group_prefix":"SOB","timezone":"Etc/UTC","stopBatchCount":"0"}
</Properties>
              <__subflow__>
              <Flow index="1013" uuid="MaxMinEventTime" isNested="true" revision="119" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="local://MaxMinEventTime" name="MaxMinEventTime" showFooter="true">
                <Node index="1013_1" uuid="da763743-6806-476a-8aca-69f14b47a4d3" type="inPort" label="source1" x="100" y="70" width="72.703125" height="40">
                    <Output name="out" uid="0" outputType="DStream" dataType="class:Pivot">
                      <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metaName" label="metaName" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
                    </Output>
                    <Model>
<Properties>
{"portType":"*"}
</Properties>
                    </Model>
                </Node>
                <Node index="1013_3" uuid="2711e953-d0e2-426d-8f36-fff1a99292ec" type="Aggregate" label="Get earliest event time" x="269" y="120" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Pivot">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="da763743-6806-476a-8aca-69f14b47a4d3">
                        <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
                      <Field name="min_ts" label="min_ts" type="datetime" isArray="false" isOptional="true"/>
                      <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="" isClassRef="false">
                      <Measures>
                        <Measure type="min" field="ts" asName="min_ts"/>
                        <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
                      </Measures>
                      <Window enable="false" />
                      <__binding__><![CDATA[{"measures":""}]]></__binding__>
                      <__binding__><![CDATA[{"measures":""}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1013_4" uuid="d8dd9afc-a42c-47aa-8a17-67ad20d7445d" type="Aggregate" label="Get latest event time" x="271" y="208" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Pivot">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="da763743-6806-476a-8aca-69f14b47a4d3">
                        <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
                      <Field name="max_ts" label="max_ts" type="datetime" isArray="false" isOptional="true"/>
                      <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="" isClassRef="false">
                      <Measures>
                        <Measure type="max" field="ts" asName="max_ts"/>
                        <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
                      </Measures>
                      <Window enable="false" />
                      <__binding__><![CDATA[{"measures":""}]]></__binding__>
                      <__binding__><![CDATA[{"measures":""}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1013_5" uuid="629d4fd0-ef8c-455b-8e18-c6262ccf72ba" type="Compute" label="Convert to metrics (Earliest Event Time)" x="440" y="120" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="2711e953-d0e2-426d-8f36-fff1a99292ec">
                        <Field name="min_ts" label="min_ts" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                        <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${timezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;Earliest Event Time&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="to_nonoption(cast(min_ts, &quot;string&quot;), &quot;null&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;ealiest&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;Earliest&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="if(${stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${timezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="1013_6" uuid="71313f87-22dc-48fe-8303-8921a3b64c84" type="Compute" label="Conver to metrics (Latest Event Time)" x="440" y="208" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="d8dd9afc-a42c-47aa-8a17-67ad20d7445d">
                        <Field name="max_ts" label="max_ts" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                        <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${timezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;Latest Event Time&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="to_nonoption(cast(max_ts, &quot;string&quot;), &quot;null&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;latest&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;Latest&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="if(${stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${timezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="1013_7" uuid="b15ee3a3-0f31-4e3b-82d8-58594a030daf" type="subflow" label="Auditlog" x="640" y="160" width="130" height="75">
                    <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="71313f87-22dc-48fe-8303-8921a3b64c84">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/AuditLog","audit_parquetfolder":"viaops_audit_parser","source":"SOB"}
</Properties>
                      <__subflow__>
                      <Flow index="1013_7" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                        <Node index="1013_7_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1013_7_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Model>
<Properties>
{"type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                            </Model>
                        </Node>
                        <Node index="1013_7_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                              <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model _caseClass="AuditLogTable" isClassRef="true">
                              <Computes>
                                <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                                <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                              </Computes>
                              <CheckboxStatus isChecked="false"/>
                            </Model>
                        </Node>
                        <Node index="1013_7_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                            <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                              </DataSource>
                            </Source>
                            <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                            </Output>
                            <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                              <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                            </Model>
                        </Node>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                        <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                        <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_parquetfolder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser","enumSource":"","runtimeControl":false,"defaultVal":"${agg_audit_table_folder}"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"SOB","enumSource":"","runtimeControl":false,"defaultVal":"${agg_source}"}]</Properties>
      <Types>[{"name":"AuditLogTable","schema":[{"name":"date_key","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_start_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_end_tm","type":"long","_isOptional":true,"_isArray":false},{"name":"metric_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_value","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_uom","type":"string","_isOptional":false,"_isArray":false},{"name":"uom_label","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group","type":"string","_isOptional":false,"_isArray":false},{"name":"system_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"process_type","type":"string","_isOptional":false,"_isArray":false},{"name":"aggr_type","type":"string","_isOptional":false,"_isArray":false},{"name":"source_fmt","type":"string","_isOptional":false,"_isArray":false},{"name":"source_tz","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group_prefix","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_key","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_value","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
                      </Flow>
</__subflow__>
                      <__binding__><![CDATA[{"audit_parquetfolder":"audit_table","source":"source_group_prefix"}]]></__binding__>
                    </Model>
                </Node>
                <Node index="1013_8" uuid="bacf0694-29af-40a5-8b6a-1df0faf67d70" type="outPort" label="out" x="271" y="70" width="70" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:Pivot">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="da763743-6806-476a-8aca-69f14b47a4d3">
                        <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{}
</Properties>
                    </Model>
                </Node>
                <Link srcId="da763743-6806-476a-8aca-69f14b47a4d3" srcPort="out:0" tgtId="bacf0694-29af-40a5-8b6a-1df0faf67d70" tgtPort="in:0"/>
                <Link srcId="d8dd9afc-a42c-47aa-8a17-67ad20d7445d" srcPort="dout:0" tgtId="71313f87-22dc-48fe-8303-8921a3b64c84" tgtPort="in:0"/>
                <Link srcId="2711e953-d0e2-426d-8f36-fff1a99292ec" srcPort="dout:0" tgtId="629d4fd0-ef8c-455b-8e18-c6262ccf72ba" tgtPort="in:0"/>
                <Link srcId="629d4fd0-ef8c-455b-8e18-c6262ccf72ba" srcPort="out:0" tgtId="b15ee3a3-0f31-4e3b-82d8-58594a030daf" tgtPort="din:0"/>
                <Link srcId="71313f87-22dc-48fe-8303-8921a3b64c84" srcPort="out:0" tgtId="b15ee3a3-0f31-4e3b-82d8-58594a030daf" tgtPort="din:0"/>
                <Link srcId="da763743-6806-476a-8aca-69f14b47a4d3" srcPort="out:0" tgtId="d8dd9afc-a42c-47aa-8a17-67ad20d7445d" tgtPort="in:0">
                    <Properties>{"label":"Audit Log","isControlFlow":"data","type":"If","expr":{"script":"  return \"true\" == properties.audit"},"codeGenPolicy":"conditional"}</Properties>
                </Link>
                <Link srcId="da763743-6806-476a-8aca-69f14b47a4d3" srcPort="out:0" tgtId="2711e953-d0e2-426d-8f36-fff1a99292ec" tgtPort="in:0">
                    <Properties>{"label":"Audit Log","isControlFlow":"data","type":"If","expr":{"script":"  return \"true\" == properties.audit"},"codeGenPolicy":"conditional"}</Properties>
                </Link>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"common","name":"audit","label":"Audit Log","type":"boolean","hidden":"false","disabled":false,"resolveProperty":false,"value":"true","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_table","label":"Audit Log Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source_group","label":"Source Group","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"SOB Group","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source_group_prefix","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"SOB","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"timezone","label":"Time Zone","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Etc/UTC","defaultValueForExisted":"Etc/UTC","enumSource":"rest:/global/?op=get.timezones","runtimeControl":false},{"editorType":"number","*":{"label":"label","desc":"desc"},"group":"common","name":"stopBatchCount","label":"Stop After n Microbatch","type":"integer","hidden":"false","disabled":false,"resolveProperty":false,"value":"0","constraints":{"min":"0","max":"999999","step":"1","places":"","maxLength":""},"runtimeControl":false}]</Properties>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"audit_table":"auditUrl","source_group_prefix":"source_group_prefix","audit":"enableAudit","source_group":"source_group","timezone":"time_zone","stopBatchCount":"stop_after_batch"}]]></__binding__>
            </Model>
        </Node>
        <Node index="1014" uuid="fb12deb1-db0d-44f6-84d2-b549a9619ded" type="StreamTarget" label="InMemoryTable" x="1660" y="40" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:Output">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="fab3627f-d1c5-4d10-8a96-0a435dd85f0d">
                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="agc_name" label="agc_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="agc_id" label="agc_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="meta_name" label="meta_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:Output">
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="double" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="agc_name" label="agc_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="agc_id" label="agc_id" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="location" label="location" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="meta_name" label="meta_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model type="tempTable" tempTableName="temp_metric_table" cache="" dataSpeed="" dataVolume="">
            </Model>
        </Node>
        <Node index="1015" uuid="74e4f9fe-2b3e-429c-8c85-0bc6a9fac07c" type="Aggregate" label="CountByMetricName" x="1820" y="40" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:Output">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="fb12deb1-db0d-44f6-84d2-b549a9619ded">
                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="double" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="agc_name" label="agc_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="agc_id" label="agc_id" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="location" label="location" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="meta_name" label="meta_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:CountByMetricName_Class">
              <Field name="metric_name" label="metric_name" type="string" isArray="false" isOptional="false"/>
              <Field name="count" label="count" type="long" isArray="false" isOptional="false"/>
              <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="CountByMetricName_Class" isClassRef="false">
              <Dimensions>
                <Dimension field="metric_name"/>
              </Dimensions>
              <Measures>
                <Measure type="count" field="" asName="count"/>
                <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
              </Measures>
              <Window enable="false" />
            </Model>
        </Node>
        <Node index="1016" uuid="6de7e7ad-8c9a-46ff-84fc-3b8b13ce7177" type="Compute" label="Conver to metrics (Output Events)" x="1993" y="40" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:CountByMetricName_Class">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="74e4f9fe-2b3e-429c-8c85-0bc6a9fac07c">
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="count" label="count" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
                <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
              <Variables>
                <Variable alias="count_str" outputType="string" value="count"/>
              </Variables>
              <Computes>
                <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${time_zone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Output Events By Metric&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="concat(metric_name, &quot;:&quot;, count_str)" outputType="string" alias="metric_value" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;sum&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Count&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="if(${stop_after_batch} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${time_zone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;metric_name&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="ts_value" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="1017" uuid="9cbf27ff-c595-42d7-80e1-4f13fb3419dc" type="subflow" label="AuditLog" x="2173" y="40" width="130" height="75">
            <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="6de7e7ad-8c9a-46ff-84fc-3b8b13ce7177">
                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/AuditLog","audit_parquetfolder":"","source":""}
</Properties>
              <__subflow__>
              <Flow index="1017" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                <Node index="1017_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1017_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{"type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="1017_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="AuditLogTable" isClassRef="true">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="1017_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                      <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                    </Model>
                </Node>
                <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_parquetfolder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"${output_audit_table_folder}","enumSource":"","runtimeControl":false,"defaultVal":"${output_audit_table_folder}"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"${output_source}","enumSource":"","runtimeControl":false,"defaultVal":"${output_source}"}]</Properties>
      <Types>[{"name":"AuditLogTable","schema":[{"name":"date_key","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_start_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_end_tm","type":"long","_isOptional":true,"_isArray":false},{"name":"metric_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_value","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_uom","type":"string","_isOptional":false,"_isArray":false},{"name":"uom_label","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group","type":"string","_isOptional":false,"_isArray":false},{"name":"system_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"process_type","type":"string","_isOptional":false,"_isArray":false},{"name":"aggr_type","type":"string","_isOptional":false,"_isArray":false},{"name":"source_fmt","type":"string","_isOptional":false,"_isArray":false},{"name":"source_tz","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group_prefix","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_key","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_value","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"audit_parquetfolder":"auditUrl","source":"source_group_prefix"}]]></__binding__>
            </Model>
        </Node>
        <Link srcId="a036ec9f-3f0d-4b26-84c4-eed72e031dcb" srcPort="dout:0" tgtId="fab3627f-d1c5-4d10-8a96-0a435dd85f0d" tgtPort="in:0"/>
        <Link srcId="ca1449c3-e067-4eb8-8456-20fce30eb6ae" srcPort="dout:0" tgtId="a036ec9f-3f0d-4b26-84c4-eed72e031dcb" tgtPort="din:0">
            <Properties>{"label":"Else","isControlFlow":"data","type":"Otherwise","expr":"","codeGenPolicy":"conditional"}</Properties>
        </Link>
        <Link srcId="16e08357-2e9a-401c-8758-0d7ee33f5c95" srcPort="out:0" tgtId="ec070983-cbfe-45c9-8914-ed1d5d1f4e7f" tgtPort="in:0"/>
        <Link srcId="12641d91-9007-48ec-8882-cab52f05c2cf" srcPort="out:0" tgtId="ec070983-cbfe-45c9-8914-ed1d5d1f4e7f" tgtPort="in:0"/>
        <Link srcId="e868221a-6f4c-4cb2-8e22-64d2766f9dee" srcPort="dout:0" tgtId="16e08357-2e9a-401c-8758-0d7ee33f5c95" tgtPort="in:0">
            <Properties>{"label":"Else","isControlFlow":"data","type":"Otherwise","expr":"","codeGenPolicy":"conditional"}</Properties>
        </Link>
        <Link srcId="03c44f21-d07e-4528-8720-d589ca82a81b" srcPort="out:0" tgtId="12641d91-9007-48ec-8882-cab52f05c2cf" tgtPort="in:0"/>
        <Link srcId="f9b07660-11db-45fd-8493-727947e50d05" srcPort="out:0" tgtId="03c44f21-d07e-4528-8720-d589ca82a81b" tgtPort="din:1">
            <Properties>{"label":"Enrich","isControlFlow":"data","type":"If","expr":{"script":" return \"true\" == properties.enrich"},"codeGenPolicy":"conditional"}</Properties>
        </Link>
        <Link srcId="e868221a-6f4c-4cb2-8e22-64d2766f9dee" srcPort="dout:0" tgtId="03c44f21-d07e-4528-8720-d589ca82a81b" tgtPort="din:0">
            <Properties>{"label":"Enrich","isControlFlow":"data","type":"If","expr":{"script":"  return \"true\" == properties.enrich"},"codeGenPolicy":"conditional"}</Properties>
        </Link>
        <Link srcId="668e879b-8c68-4b16-8f9a-1e0a1e9faefa" srcPort="dout:0" tgtId="bd747ef5-0bfc-495c-86d7-4dc0397bfec8" tgtPort="in:0"/>
        <Link srcId="77967f4f-e847-462a-8d3d-34e5669b3ac7" srcPort="out:0" tgtId="73faa65b-1254-4aa6-8e8b-fa5e1c03be81" tgtPort="din:0"/>
        <Link srcId="fab3627f-d1c5-4d10-8a96-0a435dd85f0d" srcPort="out:0" tgtId="896d579d-efc3-4f59-8046-ba4d83e30a58" tgtPort="din:0">
            <Properties>{"label":"Else","isControlFlow":"data","type":"Otherwise","expr":"","codeGenPolicy":"conditional"}</Properties>
        </Link>
        <Link srcId="2de76d39-43d2-45a3-8e28-06a02e3272a7" srcPort="dout:0" tgtId="54ceaf9d-aa1d-41dc-8fdc-b802ca15c33f" tgtPort="din:0">
            <Properties>{"label":"Pre Process","isControlFlow":"data","type":"If","expr":{"script":"  return \"true\" == properties.pre_process"},"codeGenPolicy":"conditional"}</Properties>
        </Link>
        <Link srcId="54ceaf9d-aa1d-41dc-8fdc-b802ca15c33f" srcPort="dout:1" tgtId="77967f4f-e847-462a-8d3d-34e5669b3ac7" tgtPort="in:0"/>
        <Link srcId="e868221a-6f4c-4cb2-8e22-64d2766f9dee" srcPort="dout:1" tgtId="e53a2705-e3f4-4bd5-8bd2-be7ac945ee22" tgtPort="in:0"/>
        <Link srcId="e53a2705-e3f4-4bd5-8bd2-be7ac945ee22" srcPort="out:0" tgtId="73faa65b-1254-4aa6-8e8b-fa5e1c03be81" tgtPort="din:0"/>
        <Link srcId="ca1449c3-e067-4eb8-8456-20fce30eb6ae" srcPort="dout:0" tgtId="668e879b-8c68-4b16-8f9a-1e0a1e9faefa" tgtPort="din:0">
            <Properties>{"label":"Aggregation","isControlFlow":"data","type":"If","expr":{"script":"  return \"true\" == properties.aggregation"},"codeGenPolicy":"conditional"}</Properties>
        </Link>
        <Link srcId="2de76d39-43d2-45a3-8e28-06a02e3272a7" srcPort="dout:0" tgtId="e868221a-6f4c-4cb2-8e22-64d2766f9dee" tgtPort="in:0">
            <Properties>{"label":"Else","isControlFlow":"data","type":"Otherwise","expr":"","codeGenPolicy":"conditional"}</Properties>
        </Link>
        <Link srcId="54ceaf9d-aa1d-41dc-8fdc-b802ca15c33f" srcPort="dout:0" tgtId="e868221a-6f4c-4cb2-8e22-64d2766f9dee" tgtPort="in:0"/>
        <Link srcId="bd747ef5-0bfc-495c-86d7-4dc0397bfec8" srcPort="out:0" tgtId="fab3627f-d1c5-4d10-8a96-0a435dd85f0d" tgtPort="in:0"/>
        <Link srcId="ec070983-cbfe-45c9-8914-ed1d5d1f4e7f" srcPort="out:0" tgtId="ca1449c3-e067-4eb8-8456-20fce30eb6ae" tgtPort="din:0"/>
        <Link srcId="fb12deb1-db0d-44f6-84d2-b549a9619ded" srcPort="out:0" tgtId="74e4f9fe-2b3e-429c-8c85-0bc6a9fac07c" tgtPort="in:0"/>
        <Link srcId="6de7e7ad-8c9a-46ff-84fc-3b8b13ce7177" srcPort="out:0" tgtId="9cbf27ff-c595-42d7-80e1-4f13fb3419dc" tgtPort="din:0"/>
        <Link srcId="74e4f9fe-2b3e-429c-8c85-0bc6a9fac07c" srcPort="dout:0" tgtId="6de7e7ad-8c9a-46ff-84fc-3b8b13ce7177" tgtPort="in:0"/>
        <Link srcId="fab3627f-d1c5-4d10-8a96-0a435dd85f0d" srcPort="out:0" tgtId="fb12deb1-db0d-44f6-84d2-b549a9619ded" tgtPort="in:0">
            <Properties>{"label":"Test","isControlFlow":"data","type":"If","expr":{"script":"  return \"true\" == properties.test"},"codeGenPolicy":"conditional"}</Properties>
        </Link>
      <Codes>
      </Codes>
      <Libraries>
          <Lib scope="system" systemPath="${VTBA_HOME}/wildfly/modules/com/vitria/driver/main/*.jar"/>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"number","*":{"label":"label","desc":"desc"},"name":"stop_after_batch","label":"Stop After n Microbatch","type":"integer","hidden":"false","disabled":false,"resolveProperty":false,"value":0,"runtimeControl":false,"constraints":{"min":"0","max":"999999","step":"1","places":"","maxLength":"","args":{}}},{"editorType":"sparkSelect","*":{"label":"label","desc":"desc","options.History":"constraints.args.options.0.label","options.Anomaly":"constraints.args.options.1.label","options.Both":"constraints.args.options.2.label"},"name":"target","label":"Target","desc":"Controls output target routing to History table and/or Anomaly HDFS Target","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Both","runtimeControl":false,"constraints":{"type":"sparkSelect","args":{"options":[{"label":"Metric Table","value":"History"},{"label":"Anomaly Detection","value":"Anomaly"},{"label":"Both","value":"Both"}],"needPlaceholder":true,"multiple":false,"url":"http://54.84.45.75:8080/vitria-oi/rest/app/spark/user/hwang/sparkm/VIAOps - Parse Template V2","_cid":"5d7528f3-0ffa-423c-881c-fab5b8710b7f","name":"defaultValueForExisted"}}},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"source_group","label":"Source Group","desc":"Source Group of Metrics","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"myservice","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"source_group_prefix","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"mysource","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"time_zone","label":"Time Zone","desc":"The timezone to calculate date","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Etc/UTC","defaultValueForExisted":"Europe/London","enumSource":"rest:/global/?op=get.timezones","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group2","name":"file_url","label":"File URL","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"hdfs://master/myservice/mysource","enumSource":"","runtimeControl":false,"groupLabel":"Source"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Source","name":"file_filter","label":"File Filter","desc":"The file filter regular expression","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":".*","enumSource":"","runtimeControl":false},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group2","name":"isSkipFirstLine","label":"Skip First Line","type":"boolean","hidden":"false","disabled":false,"resolveProperty":false,"value":"false","runtimeControl":false,"groupLabel":"Source"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Source","name":"max_batch_size","label":"Max Batch Size (MB)","desc":"The max file size which will be processed in one batch","type":"string","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"value":"0","enumSource":"","runtimeControl":false},{"editorType":"date","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Source","name":"start_date","label":"Start Date","desc":"The start date constraint and empty means starting from oldest","type":"date","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"value":"","runtimeControl":false,"constraints":{"itemStyle":"width: 200px;","supportNow":true,"supportClear":"true","args":{}}},{"editorType":"date","*":{"label":"label","desc":"desc"},"group":"group2","groupLabel":"Source","name":"end_date","label":"End Date","desc":"End date constraint and empty means always process to latest time","type":"date","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"runtimeControl":false,"constraints":{"itemStyle":"width: 200px;","supportNow":true,"supportClear":"true","args":{}}},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Target","name":"spark_sql_table_url","label":"Spark SQL Table URL","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"hdfs://master/warehouse/myservice_metric_table","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Target","name":"spark_sql_table","label":"Spark SQL Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"myservice_metric_table","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Target","name":"anomaly_file_url","label":"Anomaly File URL","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"hdfs://master/anomaly/myservice","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group","groupLabel":"Target","name":"anomaly_file_name_prefix","label":"Anomaly File Name Prefix","type":"string","optional":"true","hidden":"false","disabled":false,"resolveProperty":false,"value":"mysource","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group1","groupLabel":"Audit","name":"agg_dropped_events","label":"Dropped Events Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"myservice_audit_dropped","enumSource":"","runtimeControl":false},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group1","groupLabel":"Audit","name":"enableAudit","label":"Audit Log","desc":"A flag to control whether enable audit log","type":"boolean","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"true","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"group1","groupLabel":"Audit","name":"auditUrl","label":"Audit Log Table","desc":"The audit table name","type":"string","optional":true,"hidden":"false","disabled":false,"resolveProperty":false,"value":"myservice_audit","enumSource":"","runtimeControl":false},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group4","groupLabel":"NSModelGen","name":"pre_process","label":"Pre-Process","type":"boolean","hidden":true,"disabled":false,"resolveProperty":false,"value":"true","runtimeControl":false},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group4","name":"aggregation","label":"Aggregation","type":"boolean","hidden":"false","disabled":false,"resolveProperty":false,"value":"false","runtimeControl":false,"groupLabel":"NSModelGen"},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group4","name":"enrich","label":"Enrichment","type":"boolean","hidden":true,"disabled":false,"resolveProperty":false,"value":"false","runtimeControl":false,"groupLabel":"NSModelGen"},{"editorType":"_dataSourceSelector","*":{"label":"label","desc":"desc"},"name":"enrich_datasource","label":"Enrichment Datasource","type":"object","hidden":"false","disabled":false,"resolveProperty":false,"value":{"dataSource":"/vitria/m3o/datasource/DefaultDomain/defaultds","databaseURL":"jdbc:mysql://master:3306/via_dev?useSSL=false","userName":"root","password":"&lt;WuxhIPxWuVYXo0fDmzHu!VYC03pJ!wiF&gt;","driverType":"com.mysql.jdbc.Driver"},"enumSource":"","group":"group4","groupLabel":"NSModelGen","runtimeControl":false,"constraints":{"type":"dataSource","args":{}}},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"name":"tableList","label":"Enrichment Database Table","type":"string","optional":"true","hidden":"false","disabled":false,"resolveProperty":false,"value":"vt_sequence","enumSource":"","group":"group4","groupLabel":"NSModelGen","runtimeControl":false},{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"group4","groupLabel":"NSModelGen","name":"test","label":"Test and Debug","desc":"If true, only ingest to an in-memory table","type":"boolean","hidden":true,"disabled":false,"resolveProperty":false,"value":"false","runtimeControl":false}]</Properties>
      <Types>[{"name":"Output","namespace":"","schema":[{"name":"aggr_start_tm","label":"aggr_start_tm","type":"long","clazz":"","_isArray":false,"_isOptional":false},{"name":"aggr_end_tm","label":"aggr_end_tm","type":"long","clazz":"","_isArray":false,"_isOptional":false},{"name":"app","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_key","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_value","type":"string","_isOptional":false,"_isArray":false},{"name":"system_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"process_type","label":"process_type","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"aggr_type","label":"aggr_type","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"source_fmt","label":"source_fmt","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"source_tz","label":"source_tz","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"metric_value","label":"metric_value","type":"double","clazz":"","_isArray":false,"_isOptional":false},{"name":"metric_uom","type":"string","_isOptional":false,"_isArray":false},{"name":"agc_name","label":"device","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"agc_id","type":"string","_isOptional":false,"_isArray":false},{"name":"location","type":"string","_isOptional":false,"_isArray":false},{"name":"meta_name","type":"string","_isOptional":false,"_isArray":false},{"name":"date_key","label":"date_key","type":"long","clazz":"","_isArray":false,"_isOptional":false},{"name":"metric_name","label":"metric_name","type":"string","clazz":"","_isArray":false,"_isOptional":false}]},{"name":"Pivot","namespace":"","schema":[{"name":"ts","type":"datetime","_isOptional":false,"_isArray":false},{"name":"metaName","type":"string","_isOptional":false,"_isArray":false},{"name":"location","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_value","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_func","type":"string","_isOptional":false,"_isArray":false}]},{"name":"DerivedField","namespace":"","schema":[{"name":"metaname","label":"metaname","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"TimeStamp","label":"TimeStamp","type":"datetime","clazz":"","_isArray":false,"_isOptional":false},{"name":"sitename","label":"sitename","type":"string","clazz":"","_isArray":false,"_isOptional":false},{"name":"callattemptstotal","label":"callattemptstotal","type":"long","clazz":"","_isArray":false,"_isOptional":true},{"name":"field_1","label":"field_1","type":"string","clazz":"","_isArray":false,"_isOptional":false}]},{"name":"Enrichment","namespace":"","schema":[{"name":"metaname","label":"metaname","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"TimeStamp","label":"TimeStamp","type":"datetime","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"sitename","label":"sitename","type":"string","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":false},{"name":"callattemptstotal","label":"callattemptstotal","type":"long","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":true},{"name":"sequence_id","label":"sequence_id","type":"long","_isDimension":false,"_isMeasure":false,"clazz":"","_isArray":false,"_isOptional":true}]}]</Types>
      </Flow>
      <Flow index="2000" uuid="MaxMinEventTime" isNested="true" revision="119" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="local://MaxMinEventTime" name="MaxMinEventTime" showFooter="true">
        <Node index="2001" uuid="da763743-6806-476a-8aca-69f14b47a4d3" type="inPort" label="source1" x="100" y="70" width="72.703125" height="40">
            <Output name="out" uid="0" outputType="DStream" dataType="class:Pivot">
              <Field name="ts" label="ts" type="datetime" clazz="" isArray="false" isOptional="false"/>
              <Field name="metaName" label="metaName" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="app" label="app" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_func" label="aggr_func" type="string" clazz="" isArray="false" isOptional="false"/>
            </Output>
            <Model>
<Properties>
{"portType":"*"}
</Properties>
            </Model>
        </Node>
        <Node index="2003" uuid="2711e953-d0e2-426d-8f36-fff1a99292ec" type="Aggregate" label="Get earliest event time" x="269" y="120" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:Pivot">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="da763743-6806-476a-8aca-69f14b47a4d3">
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
              <Field name="min_ts" label="min_ts" type="datetime" isArray="false" isOptional="true"/>
              <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="" isClassRef="false">
              <Measures>
                <Measure type="min" field="ts" asName="min_ts"/>
                <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
              </Measures>
              <Window enable="false" />
              <__binding__><![CDATA[{"measures":""}]]></__binding__>
              <__binding__><![CDATA[{"measures":""}]]></__binding__>
            </Model>
        </Node>
        <Node index="2004" uuid="d8dd9afc-a42c-47aa-8a17-67ad20d7445d" type="Aggregate" label="Get latest event time" x="271" y="208" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="class:Pivot">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="da763743-6806-476a-8aca-69f14b47a4d3">
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
              <Field name="max_ts" label="max_ts" type="datetime" isArray="false" isOptional="true"/>
              <Field name="micro_batch_time" label="micro_batch_time" type="long" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="" isClassRef="false">
              <Measures>
                <Measure type="max" field="ts" asName="max_ts"/>
                <Measure type="micro_batch_time" field="" asName="micro_batch_time"/>
              </Measures>
              <Window enable="false" />
              <__binding__><![CDATA[{"measures":""}]]></__binding__>
              <__binding__><![CDATA[{"measures":""}]]></__binding__>
            </Model>
        </Node>
        <Node index="2005" uuid="629d4fd0-ef8c-455b-8e18-c6262ccf72ba" type="Compute" label="Convert to metrics (Earliest Event Time)" x="440" y="120" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="2711e953-d0e2-426d-8f36-fff1a99292ec">
                <Field name="min_ts" label="min_ts" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${timezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Earliest Event Time&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="to_nonoption(cast(min_ts, &quot;string&quot;), &quot;null&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;ealiest&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Earliest&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="if(${stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${timezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="2006" uuid="71313f87-22dc-48fe-8303-8921a3b64c84" type="Compute" label="Conver to metrics (Latest Event Time)" x="440" y="208" width="130" height="75">
            <Source name="source" uid="0" outputType="DStream" dataType="(Option[java.sql.Timestamp],Long)">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="d8dd9afc-a42c-47aa-8a17-67ad20d7445d">
                <Field name="max_ts" label="max_ts" type="datetime" isDimension="false" isMeasure="false" isArray="false" isOptional="true"/>
                <Field name="micro_batch_time" label="micro_batch_time" type="long" isDimension="false" isMeasure="false" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model _caseClass="viaops.ingestion.AuditLog" isClassRef="true" udfs="generate_datekey">
              <Computes>
                <Compute op="sleText" field="*" arg="" value="generate_datekey(microbatch_time(), &quot;${timezone}&quot;)" outputType="long" alias="date_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(microbatch_time())/1000" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="to_option(-1)" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Latest Event Time&quot;" outputType="string" alias="metric_name" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="to_nonoption(cast(max_ts, &quot;string&quot;), &quot;null&quot;)" outputType="string" alias="metric_value" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;latest&quot;" outputType="string" alias="metric_uom" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;Latest&quot;" outputType="string" alias="uom_label" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${source_group}&quot;" outputType="string" alias="source_group" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="unix_timestamp_millisec(now())/1000" outputType="long" alias="system_tm" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="if(${stopBatchCount} &gt; 0, &quot;Ad-Hoc&quot;, &quot;Realtime&quot;)" outputType="string" alias="process_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source&quot;" outputType="string" alias="aggr_type" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;others&quot;" outputType="string" alias="source_fmt" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${timezone}&quot;" outputType="string" alias="source_tz" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;source_group&quot;" outputType="string" alias="ts_key" wordWarp="true"/>
                <Compute op="sleText" field="*" arg="" value="&quot;${source_group}&quot;" outputType="string" alias="ts_value" wordWarp="true"/>
              </Computes>
              <CheckboxStatus isChecked="false"/>
            </Model>
        </Node>
        <Node index="2007" uuid="b15ee3a3-0f31-4e3b-82d8-58594a030daf" type="subflow" label="Auditlog" x="640" y="160" width="130" height="75">
            <Source name="In" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="71313f87-22dc-48fe-8303-8921a3b64c84">
                <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
              <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
              <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
              <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
              <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
            </Output>
            <Model>
<Properties>
{"subFlow":"remote:///viaops.ingestion/AuditLog","audit_parquetfolder":"","source":""}
</Properties>
              <__subflow__>
              <Flow index="2007" uuid="AuditLog" isNested="true" revision="800" acceptedSourceTypes="RDD,DStream,DataFrame" referenceURI="remote:///viaops.ingestion/AuditLog" name="AuditLog" showFooter="true">
                <Node index="2007_1" uuid="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" type="inPort" label="In" x="20" y="34" width="70" height="40">
                    <Output name="Out" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog" referenceType="viaops.ingestion.AuditLog">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model>
<Properties>
{"portType":"DStream","type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="2007_2" uuid="2a748b73-8ff7-4d04-8666-9123dfba32f3" type="outPort" label="Out" x="440" y="34" width="70" height="40">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Model>
<Properties>
{"type":{"name":"viaops.ingestion.AuditLog","kind":"caseclass"}}
</Properties>
                    </Model>
                </Node>
                <Node index="2007_3" uuid="322e4e59-dd18-4247-8532-ecf44de32e0b" type="Compute" label="Normalize" x="140" y="110" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:viaops.ingestion.AuditLog">
                      <DataSource category="#OUTPUT" id="undefined" name="Out" nodeId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model _caseClass="AuditLogTable" isClassRef="true">
                      <Computes>
                        <Compute op="sleText" field="*" arg="" value="date_key" outputType="long" alias="date_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_start_tm" outputType="long" alias="aggr_start_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_end_tm" outputType="long" alias="aggr_end_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_name" outputType="string" alias="metric_name" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_value" outputType="string" alias="metric_value" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="metric_uom" outputType="string" alias="metric_uom" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="uom_label" outputType="string" alias="uom_label" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="source_group" outputType="string" alias="source_group" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="system_tm" outputType="long" alias="system_tm" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="process_type" outputType="string" alias="process_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="aggr_type" outputType="string" alias="aggr_type" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="source_fmt" outputType="string" alias="source_fmt" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="source_tz" outputType="string" alias="source_tz" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="&quot;${source}&quot;" outputType="string" alias="source_group_prefix" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="ts_key" outputType="string" alias="ts_key" wordWarp="true"/>
                        <Compute op="sleText" field="*" arg="" value="ts_value" outputType="string" alias="ts_value" wordWarp="true"/>
                      </Computes>
                      <CheckboxStatus isChecked="false"/>
                    </Model>
                </Node>
                <Node index="2007_4" uuid="15ea36d5-561f-4969-8443-62afe82d4154" type="StreamTarget" label="Step 1" x="340" y="110" width="130" height="75">
                    <Source name="source" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                      <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="322e4e59-dd18-4247-8532-ecf44de32e0b">
                        <Field name="date_key" label="date_key" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_start_tm" label="aggr_start_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_end_tm" label="aggr_end_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="true"/>
                        <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_value" label="metric_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="metric_uom" label="metric_uom" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="uom_label" label="uom_label" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group" label="source_group" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="system_tm" label="system_tm" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="process_type" label="process_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="aggr_type" label="aggr_type" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_fmt" label="source_fmt" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_tz" label="source_tz" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="source_group_prefix" label="source_group_prefix" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_key" label="ts_key" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                        <Field name="ts_value" label="ts_value" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                      </DataSource>
                    </Source>
                    <Output name="out" uid="0" outputType="DStream" dataType="class:AuditLogTable">
                      <Field name="date_key" label="date_key" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_start_tm" label="aggr_start_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_end_tm" label="aggr_end_tm" type="long" clazz="" isArray="false" isOptional="true"/>
                      <Field name="metric_name" label="metric_name" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_value" label="metric_value" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="metric_uom" label="metric_uom" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="uom_label" label="uom_label" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group" label="source_group" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="system_tm" label="system_tm" type="long" clazz="" isArray="false" isOptional="false"/>
                      <Field name="process_type" label="process_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="aggr_type" label="aggr_type" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_fmt" label="source_fmt" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_tz" label="source_tz" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="source_group_prefix" label="source_group_prefix" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_key" label="ts_key" type="string" clazz="" isArray="false" isOptional="false"/>
                      <Field name="ts_value" label="ts_value" type="string" clazz="" isArray="false" isOptional="false"/>
                        <ExploreConfig>{&quot;_index&quot;:&quot;Default&quot;,&quot;items&quot;:[{&quot;name&quot;:&quot;Default&quot;}]}</ExploreConfig>
                    </Output>
                    <Model type="hiveTable" tableName="${audit_parquetfolder}" partitionType="eventField" partitionSize="" partitionColumn="date_key,source_group" partitionIndex="0,7" timeColumn="" overwrite="false" partitionNum="1" dataSpeed="" dataVolume="">
                      <__binding__><![CDATA[{"snapshotTableName":""}]]></__binding__>
                    </Model>
                </Node>
                <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="322e4e59-dd18-4247-8532-ecf44de32e0b" tgtPort="in:0"/>
                <Link srcId="224f8fb5-0fe9-4c00-8c04-2395c68c02d3" srcPort="out:0" tgtId="2a748b73-8ff7-4d04-8666-9123dfba32f3" tgtPort="in:0"/>
                <Link srcId="322e4e59-dd18-4247-8532-ecf44de32e0b" srcPort="out:0" tgtId="15ea36d5-561f-4969-8443-62afe82d4154" tgtPort="in:0"/>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_parquetfolder","label":"Audit Log Table","type":"string","optional":false,"hidden":"false","disabled":false,"resolveProperty":false,"value":"${audit_table}","enumSource":"","runtimeControl":false,"defaultVal":"${agg_audit_table_folder}"},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"${agg_source}","enumSource":"","runtimeControl":false,"defaultVal":"${agg_source}"}]</Properties>
      <Types>[{"name":"AuditLogTable","schema":[{"name":"date_key","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_start_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"aggr_end_tm","type":"long","_isOptional":true,"_isArray":false},{"name":"metric_name","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_value","type":"string","_isOptional":false,"_isArray":false},{"name":"metric_uom","type":"string","_isOptional":false,"_isArray":false},{"name":"uom_label","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group","type":"string","_isOptional":false,"_isArray":false},{"name":"system_tm","type":"long","_isOptional":false,"_isArray":false},{"name":"process_type","type":"string","_isOptional":false,"_isArray":false},{"name":"aggr_type","type":"string","_isOptional":false,"_isArray":false},{"name":"source_fmt","type":"string","_isOptional":false,"_isArray":false},{"name":"source_tz","type":"string","_isOptional":false,"_isArray":false},{"name":"source_group_prefix","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_key","type":"string","_isOptional":false,"_isArray":false},{"name":"ts_value","type":"string","_isOptional":false,"_isArray":false}]}]</Types>
              </Flow>
</__subflow__>
              <__binding__><![CDATA[{"audit_parquetfolder":"audit_table","source":"source_group_prefix"}]]></__binding__>
            </Model>
        </Node>
        <Node index="2002" uuid="bacf0694-29af-40a5-8b6a-1df0faf67d70" type="outPort" label="out" x="271" y="70" width="70" height="40">
            <Source name="source" uid="0" outputType="DStream" dataType="class:Pivot">
              <DataSource category="#OUTPUT" id="undefined" name="out" nodeId="da763743-6806-476a-8aca-69f14b47a4d3">
                <Field name="ts" label="ts" type="datetime" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metaName" label="metaName" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="app" label="app" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_name" label="metric_name" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="metric_value" label="metric_value" type="long" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
                <Field name="aggr_func" label="aggr_func" type="string" isDimension="false" isMeasure="false" clazz="" isArray="false" isOptional="false"/>
              </DataSource>
            </Source>
            <Model>
<Properties>
{}
</Properties>
            </Model>
        </Node>
        <Link srcId="da763743-6806-476a-8aca-69f14b47a4d3" srcPort="out:0" tgtId="bacf0694-29af-40a5-8b6a-1df0faf67d70" tgtPort="in:0"/>
        <Link srcId="d8dd9afc-a42c-47aa-8a17-67ad20d7445d" srcPort="dout:0" tgtId="71313f87-22dc-48fe-8303-8921a3b64c84" tgtPort="in:0"/>
        <Link srcId="2711e953-d0e2-426d-8f36-fff1a99292ec" srcPort="dout:0" tgtId="629d4fd0-ef8c-455b-8e18-c6262ccf72ba" tgtPort="in:0"/>
        <Link srcId="629d4fd0-ef8c-455b-8e18-c6262ccf72ba" srcPort="out:0" tgtId="b15ee3a3-0f31-4e3b-82d8-58594a030daf" tgtPort="din:0"/>
        <Link srcId="71313f87-22dc-48fe-8303-8921a3b64c84" srcPort="out:0" tgtId="b15ee3a3-0f31-4e3b-82d8-58594a030daf" tgtPort="din:0"/>
        <Link srcId="da763743-6806-476a-8aca-69f14b47a4d3" srcPort="out:0" tgtId="d8dd9afc-a42c-47aa-8a17-67ad20d7445d" tgtPort="in:0">
            <Properties>{"label":"Audit Log","isControlFlow":"data","type":"If","expr":{"script":"  return \"true\" == properties.audit"},"codeGenPolicy":"conditional"}</Properties>
        </Link>
        <Link srcId="da763743-6806-476a-8aca-69f14b47a4d3" srcPort="out:0" tgtId="2711e953-d0e2-426d-8f36-fff1a99292ec" tgtPort="in:0">
            <Properties>{"label":"Audit Log","isControlFlow":"data","type":"If","expr":{"script":"  return \"true\" == properties.audit"},"codeGenPolicy":"conditional"}</Properties>
        </Link>
      <Codes>
      </Codes>
      <Libraries>
      </Libraries>
      <Resources>
      </Resources>
      <Properties>[{"editorType":"boolean","*":{"label":"label","desc":"desc"},"group":"common","name":"audit","label":"Audit Log","type":"boolean","hidden":"false","disabled":false,"resolveProperty":false,"value":"true","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"audit_table","label":"Audit Log Table","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"viaops_audit_parser","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source_group","label":"Source Group","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"SOB Group","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"source_group_prefix","label":"Source Group Prefix","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"SOB","enumSource":"","runtimeControl":false},{"editorType":"textInput","*":{"label":"label","desc":"desc"},"group":"common","name":"timezone","label":"Time Zone","type":"string","hidden":"false","disabled":false,"resolveProperty":false,"value":"Etc/UTC","defaultValueForExisted":"Etc/UTC","enumSource":"rest:/global/?op=get.timezones","runtimeControl":false},{"editorType":"number","*":{"label":"label","desc":"desc"},"group":"common","name":"stopBatchCount","label":"Stop After n Microbatch","type":"integer","hidden":"false","disabled":false,"resolveProperty":false,"value":"0","constraints":{"min":"0","max":"999999","step":"1","places":"","maxLength":""},"runtimeControl":false}]</Properties>
      </Flow>
    </Flows>
  </ModelInfo>
</DataPipeModel>